<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Rydia">
<meta name="dcterms.date" content="2024-05-13">

<title>Visual Analytics - Take Home Exercise 3</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>

<link href="../../site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">

<script src="../../site_libs/datatables-binding-0.31/datatables.js"></script>

<script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>

<link href="../../site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">

<link href="../../site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">

<script src="../../site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>

<link href="../../site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">

<script src="../../site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>

<script src="../../site_libs/plotly-binding-4.10.4/plotly.js"></script>

<script src="../../site_libs/typedarray-0.1/typedarray.min.js"></script>

<link href="../../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">

<script src="../../site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>

<meta name="viewport" content="width=device-width, initial-scale=1">

<link href="../../site_libs/bootstrap-grid-3.4.1/bootstrap-grid.min.css" rel="stylesheet">



<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Visual Analytics</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Hands-on Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercise">    
        <li>
    <a class="dropdown-item" href="../../Hands-on Exercise/Hands-on_Ex01/Hands-on_Ex01.html">
 <span class="dropdown-text">Hands-on Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on Exercise/Hands-on_Ex02/Hands-on_Ex02.html">
 <span class="dropdown-text">Hands-on Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on Exercise/Hands-on_Ex03/Hands-on_Ex03.html">
 <span class="dropdown-text">Hands-on Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on Exercise/Hands-on_Ex04/Hands-on_Ex04.html">
 <span class="dropdown-text">Hands-on Exercise 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on Exercise/Hands-on_Ex05/Hands-on_Ex05.html">
 <span class="dropdown-text">Hands-on Exercise 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on Exercise/Hands-on_Ex06/Hands-on_Ex06.html">
 <span class="dropdown-text">Hands-on Exercise 6</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on Exercise/Hands-on_Ex07/Hands-on_Ex07.html">
 <span class="dropdown-text">Hands-on Exercise 7</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on Exercise/Hands-on_Ex08a/Hands-on_Ex08a.html">
 <span class="dropdown-text">Hands-on Exercise 8a</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on Exercise/Hands-on_Ex08b/Hands-on_Ex08b.html">
 <span class="dropdown-text">Hands-on Exercise 8b</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on Exercise/Hands-on_Ex08c/Hands-on_Ex08c.html">
 <span class="dropdown-text">Hands-on Exercise 8c</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on Exercise/Hands-on_Ex09/Hands-on_Ex09.qmd">
 <span class="dropdown-text">Hands-on Exercise 9</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on Exercise/Hands-on_Ex10/Hands-on_Ex10.qmd">
 <span class="dropdown-text">Hands-on Exercise 10</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">In-class Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercise">    
        <li>
    <a class="dropdown-item" href="../../In-class Exercise/In-class_Ex01/In-class_Ex01.html">
 <span class="dropdown-text">In-class Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class Exercise/In-class_Ex02/In-class_Ex02.html">
 <span class="dropdown-text">In-class Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class Exercise/In-class_Ex03/In-class_Ex03.qmd">
 <span class="dropdown-text">In-class Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class Exercise/In-class_Ex04/In-class_Ex04.html">
 <span class="dropdown-text">In-class Exercise 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class Exercise/In-class_Ex05/In-class_Ex05.html">
 <span class="dropdown-text">In-class Exercise 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class Exercise/In-class_Ex06/In-class_Ex06.html">
 <span class="dropdown-text">In-class Exercise 6</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class Exercise/In-class_Ex07/In-class_Ex07.qmd">
 <span class="dropdown-text">In-class Exercise 7</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class Exercise/In-class_Ex08/In-class_Ex08.html">
 <span class="dropdown-text">In-class Exercise 8</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class Exercise/In-class_Ex09/In-class_Ex09.qmd">
 <span class="dropdown-text">In-class Exercise 9</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class Exercise/In-class_Ex10/In-class_Ex10.qmd">
 <span class="dropdown-text">In-class Exercise 10</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Take-home Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercise">    
        <li>
    <a class="dropdown-item" href="../../Take-home Exercise/Take-home_Ex01/Take-home_Ex01.html">
 <span class="dropdown-text">Take-home Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-home Exercise/Take-home_Ex02/Take-home_Ex02.html">
 <span class="dropdown-text">Take-home Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-home Exercise/Take-home_Ex03/Take-home_Ex03.html">
 <span class="dropdown-text">Take-home Exercise 3</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-self-practice" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Self Practice</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-self-practice">    
        <li>
    <a class="dropdown-item" href="../../Self-Practice/Self-Practice_01/Self-Practice_01.html">
 <span class="dropdown-text">Self Practice 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Self-Practice/Self-Practice_02/Self-Practice_02.html">
 <span class="dropdown-text">Self Practice 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Self-Practice/Self-Practice_03/Self-Practice_03.html">
 <span class="dropdown-text">Self Practice 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Self-Practice/Self-Practice_04/Self-Practice_04.html">
 <span class="dropdown-text">Self Practice 4</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#vast-2024-mini-challenge-2" id="toc-vast-2024-mini-challenge-2" class="nav-link active" data-scroll-target="#vast-2024-mini-challenge-2">VAST 2024 Mini Challenge 2</a>
  <ul class="collapse">
  <li><a href="#mini-challenge-2-creating-signatures-for-geo-temporal-patterns" id="toc-mini-challenge-2-creating-signatures-for-geo-temporal-patterns" class="nav-link" data-scroll-target="#mini-challenge-2-creating-signatures-for-geo-temporal-patterns">Mini-Challenge 2: Creating Signatures for Geo-Temporal Patterns</a></li>
  <li><a href="#foreword-by-the-author" id="toc-foreword-by-the-author" class="nav-link" data-scroll-target="#foreword-by-the-author">Foreword by the Author</a></li>
  </ul></li>
  <li><a href="#data-preparation" id="toc-data-preparation" class="nav-link" data-scroll-target="#data-preparation">1.0 Data Preparation</a>
  <ul class="collapse">
  <li><a href="#loading-r-packages" id="toc-loading-r-packages" class="nav-link" data-scroll-target="#loading-r-packages">1.1 Loading R Packages</a></li>
  <li><a href="#loading-the-data" id="toc-loading-the-data" class="nav-link" data-scroll-target="#loading-the-data">1.2 Loading the Data</a>
  <ul class="collapse">
  <li><a href="#loading-the-geographical-data" id="toc-loading-the-geographical-data" class="nav-link" data-scroll-target="#loading-the-geographical-data">1.2.1 Loading the Geographical Data</a></li>
  <li><a href="#wrangling-of-geographical-data" id="toc-wrangling-of-geographical-data" class="nav-link" data-scroll-target="#wrangling-of-geographical-data">1.2.2 Wrangling of Geographical Data</a></li>
  </ul></li>
  <li><a href="#wrangling-and-tidying-edges" id="toc-wrangling-and-tidying-edges" class="nav-link" data-scroll-target="#wrangling-and-tidying-edges">1.3 <strong>Wrangling and tidying edges</strong></a>
  <ul class="collapse">
  <li><a href="#extracting-edges" id="toc-extracting-edges" class="nav-link" data-scroll-target="#extracting-edges">1.3.1 Extracting edges</a></li>
  <li><a href="#correcting-the-date-data-type-with-lubridate" id="toc-correcting-the-date-data-type-with-lubridate" class="nav-link" data-scroll-target="#correcting-the-date-data-type-with-lubridate">1.3.2 Correcting the date data type with <code>lubridate()</code></a></li>
  <li><a href="#changing-field-name" id="toc-changing-field-name" class="nav-link" data-scroll-target="#changing-field-name">1.3.3 Changing field name</a></li>
  <li><a href="#splitting-words-in-type-column" id="toc-splitting-words-in-type-column" class="nav-link" data-scroll-target="#splitting-words-in-type-column">1.3.4 Splitting words in <code>type</code> column</a></li>
  </ul></li>
  <li><a href="#wrangling-and-tidying-nodes" id="toc-wrangling-and-tidying-nodes" class="nav-link" data-scroll-target="#wrangling-and-tidying-nodes">1.4 <strong>Wrangling and tidying nodes</strong></a>
  <ul class="collapse">
  <li><a href="#extracting-nodes" id="toc-extracting-nodes" class="nav-link" data-scroll-target="#extracting-nodes">1.4.1 Extracting nodes</a></li>
  <li><a href="#correcting-the-date-data-type-with-lubridate-1" id="toc-correcting-the-date-data-type-with-lubridate-1" class="nav-link" data-scroll-target="#correcting-the-date-data-type-with-lubridate-1">1.4.2 Correcting the date data type with <code>lubridate()</code></a></li>
  <li><a href="#changing-field-name-1" id="toc-changing-field-name-1" class="nav-link" data-scroll-target="#changing-field-name-1">1.4.3 Changing field name</a></li>
  <li><a href="#splitting-words-in-type-column-1" id="toc-splitting-words-in-type-column-1" class="nav-link" data-scroll-target="#splitting-words-in-type-column-1">1.4.4 Splitting words in <code>type</code> column</a></li>
  <li><a href="#tidying-text-field" id="toc-tidying-text-field" class="nav-link" data-scroll-target="#tidying-text-field">1.4.5 Tidying text field</a></li>
  </ul></li>
  <li><a href="#processing-nodes-and-edges-data" id="toc-processing-nodes-and-edges-data" class="nav-link" data-scroll-target="#processing-nodes-and-edges-data">1.5 Processing nodes and edges data</a>
  <ul class="collapse">
  <li><a href="#understanding-the-nodes-and-edges-data" id="toc-understanding-the-nodes-and-edges-data" class="nav-link" data-scroll-target="#understanding-the-nodes-and-edges-data">1.5.1 Understanding the nodes and edges data</a></li>
  <li><a href="#extracting-relevant-information-for-each-nodes-data" id="toc-extracting-relevant-information-for-each-nodes-data" class="nav-link" data-scroll-target="#extracting-relevant-information-for-each-nodes-data">1.5.2 Extracting Relevant Information for each nodes data</a></li>
  <li><a href="#consolidating-relevant-information-in-the-edges-data" id="toc-consolidating-relevant-information-in-the-edges-data" class="nav-link" data-scroll-target="#consolidating-relevant-information-in-the-edges-data">1.5.3 Consolidating relevant information in the edges data</a></li>
  </ul></li>
  <li><a href="#exploratory-data-analysis" id="toc-exploratory-data-analysis" class="nav-link" data-scroll-target="#exploratory-data-analysis">1.6 Exploratory Data Analysis</a>
  <ul class="collapse">
  <li><a href="#understanding-the-fish-species-in-each-region" id="toc-understanding-the-fish-species-in-each-region" class="nav-link" data-scroll-target="#understanding-the-fish-species-in-each-region">1.6.1 Understanding the Fish Species in each Region</a></li>
  <li><a href="#understanding-the-qty_tons-of-each-fish-species-by-city" id="toc-understanding-the-qty_tons-of-each-fish-species-by-city" class="nav-link" data-scroll-target="#understanding-the-qty_tons-of-each-fish-species-by-city">1.6.2 Understanding the qty_tons of each Fish Species by City</a></li>
  <li><a href="#understanding-the-number-of-cargoes-of-each-fish-species-by-city" id="toc-understanding-the-number-of-cargoes-of-each-fish-species-by-city" class="nav-link" data-scroll-target="#understanding-the-number-of-cargoes-of-each-fish-species-by-city">1.6.3 Understanding the number of cargoes of each Fish Species by City</a></li>
  <li><a href="#understanding-the-activities-by-locations" id="toc-understanding-the-activities-by-locations" class="nav-link" data-scroll-target="#understanding-the-activities-by-locations">1.6.4 Understanding the Activities by Locations</a></li>
  <li><a href="#understanding-the-harbor-report-by-locations" id="toc-understanding-the-harbor-report-by-locations" class="nav-link" data-scroll-target="#understanding-the-harbor-report-by-locations">1.6.5 Understanding the Harbor Report by Locations</a></li>
  <li><a href="#understanding-the-cargoes" id="toc-understanding-the-cargoes" class="nav-link" data-scroll-target="#understanding-the-cargoes">1.6.6 Understanding the Cargoes</a></li>
  <li><a href="#understanding-the-vessels" id="toc-understanding-the-vessels" class="nav-link" data-scroll-target="#understanding-the-vessels">1.6.7 Understanding the Vessels</a></li>
  <li><a href="#understanding-the-vessel-movements" id="toc-understanding-the-vessel-movements" class="nav-link" data-scroll-target="#understanding-the-vessel-movements">1.6.8 Understanding the vessel movements</a></li>
  </ul></li>
  <li><a href="#task-1-flow-of-commercially-caught-fish" id="toc-task-1-flow-of-commercially-caught-fish" class="nav-link" data-scroll-target="#task-1-flow-of-commercially-caught-fish">2.0 Task 1: Flow of Commercially Caught Fish</a></li>
  <li><a href="#associating-the-vessels-with-their-probable-cargoes" id="toc-associating-the-vessels-with-their-probable-cargoes" class="nav-link" data-scroll-target="#associating-the-vessels-with-their-probable-cargoes">2.1 Associating the vessels with their probable cargoes</a></li>
  <li><a href="#examine-the-seasonal-trends-and-anomalies-in-the-port-exit-records" id="toc-examine-the-seasonal-trends-and-anomalies-in-the-port-exit-records" class="nav-link" data-scroll-target="#examine-the-seasonal-trends-and-anomalies-in-the-port-exit-records">2.3 Examine the seasonal trends and anomalies in the port exit records</a>
  <ul class="collapse">
  <li><a href="#seasonal-trends-in-port-exit-records" id="toc-seasonal-trends-in-port-exit-records" class="nav-link" data-scroll-target="#seasonal-trends-in-port-exit-records">2.3.1 Seasonal trends in port exit records</a></li>
  </ul></li>
  <li><a href="#understanding-the-types-of-fish-that-should-not-be-in-the-market" id="toc-understanding-the-types-of-fish-that-should-not-be-in-the-market" class="nav-link" data-scroll-target="#understanding-the-types-of-fish-that-should-not-be-in-the-market">2.3.1 <strong>Understanding the types of fish that should not be in the market</strong></a></li>
  <li><a href="#task-2" id="toc-task-2" class="nav-link" data-scroll-target="#task-2">3.0 Task 2</a></li>
  <li><a href="#illegal-fishing-by-southseafood-express-corp" id="toc-illegal-fishing-by-southseafood-express-corp" class="nav-link" data-scroll-target="#illegal-fishing-by-southseafood-express-corp">3.1 Illegal fishing by SouthSeafood Express Corp</a>
  <ul class="collapse">
  <li><a href="#when-and-where-did-southseafood-express-corp-vessels-perform-their-illegal-fishing" id="toc-when-and-where-did-southseafood-express-corp-vessels-perform-their-illegal-fishing" class="nav-link" data-scroll-target="#when-and-where-did-southseafood-express-corp-vessels-perform-their-illegal-fishing">3.1.1 When and where did SouthSeafood Express Corp vessels perform their illegal fishing?</a></li>
  <li><a href="#visualising-vessel-trajectory" id="toc-visualising-vessel-trajectory" class="nav-link" data-scroll-target="#visualising-vessel-trajectory">3.1.2 Visualising Vessel Trajectory</a></li>
  </ul></li>
  <li><a href="#task-4" id="toc-task-4" class="nav-link" data-scroll-target="#task-4">4.0 Task 4</a></li>
  <li><a href="#changes-in-commercial-fishing" id="toc-changes-in-commercial-fishing" class="nav-link" data-scroll-target="#changes-in-commercial-fishing">4.1 Changes in Commercial Fishing</a>
  <ul class="collapse">
  <li><a href="#what-new-behaviors-in-the-oceanus-commercial-fishing-community-are-most-suspicious-and-why" id="toc-what-new-behaviors-in-the-oceanus-commercial-fishing-community-are-most-suspicious-and-why" class="nav-link" data-scroll-target="#what-new-behaviors-in-the-oceanus-commercial-fishing-community-are-most-suspicious-and-why">4.2 What new behaviors in the Oceanus commercial fishing community are most suspicious and why?</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Take Home Exercise 3</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Rydia </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">May 13, 2024</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">June 7, 2024</p>
    </div>
  </div>
    
  </div>
  


</header>


<section id="vast-2024-mini-challenge-2" class="level1">
<h1>VAST 2024 Mini Challenge 2</h1>
<section id="mini-challenge-2-creating-signatures-for-geo-temporal-patterns" class="level2">
<h2 class="anchored" data-anchor-id="mini-challenge-2-creating-signatures-for-geo-temporal-patterns">Mini-Challenge 2: Creating Signatures for Geo-Temporal Patterns</h2>
<p>Mini-challenge 2 focuses on analyzing ship movements and shipping records to understand illegal fishing practices. FishEye analysts need help creating visualizations to show patterns of ship movements and identify suspicious behaviors. They also want to understand how the commercial fishing community changed after a company was caught fishing illegally.</p>
<p>The details of the mini challenge can be found <a href="https://vast-challenge.github.io/2024/MC2.html">here</a>.</p>
</section>
<section id="foreword-by-the-author" class="level2">
<h2 class="anchored" data-anchor-id="foreword-by-the-author">Foreword by the Author</h2>
<p>This visualisation project is created for the fulfillment of <a href="https://isss608-ay2023-24apr.netlify.app/take-home_ex/th_ex03">take home exercise 3</a> as part of the course assessment for the (Visual Analytics)[https://isss608-ay2023-24apr.netlify.app/] module taught by (Prof.&nbsp;T.S. Kam)[https://faculty.smu.edu.sg/profile/kam-tin-seong-486].</p>
<p>Jump straight to final product for this (Take Home Exercise 3 - Mini Challenge 2: Task 4)[https://vaa-ry.netlify.app/take-home%20exercise/take-home_ex03/take-home_ex03#task-4] here. Only Task 4 is considered as a complete set of write up. The rest of the Task 1 and 2 are still work in progress by the author at the point of submission on 9 Jun 2024.</p>
</section>
</section>
<section id="data-preparation" class="level1">
<h1>1.0 Data Preparation</h1>
<p>Reference for Data Preparations:</p>
<ol type="1">
<li><p><a href="https://isss608-ay2023-24apr.netlify.app/vast/kickstarter2">Kickstarter 2</a> by Prof T.S. Kam</p></li>
<li><p><a href="https://isss608-ay2023-24apr.netlify.app/vast/kickstarter3">Kickstarter 3</a> by Prof T.S. Kam</p></li>
</ol>
<section id="loading-r-packages" class="level2">
<h2 class="anchored" data-anchor-id="loading-r-packages">1.1 Loading R Packages</h2>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, jsonlite, DT, lubridate,</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>               igraph, tidygraph, ggraph, </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>               visNetwork, sf,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>               patchwork, CGPfunctions,</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>               ggHoriPlot, plotly,ggridges,</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>               ggdist, ggiraph)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="loading-the-data" class="level2">
<h2 class="anchored" data-anchor-id="loading-the-data">1.2 Loading the Data</h2>
<p>Loading the .json data using <code>jsonlite</code> package.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>mc2_data <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(<span class="st">"data/MC2/mc2.json"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>mc2 is a directed multigraph, consists of nodes dataframe and links dataframe.</p>
<section id="loading-the-geographical-data" class="level3">
<h3 class="anchored" data-anchor-id="loading-the-geographical-data">1.2.1 Loading the Geographical Data</h3>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>oceanus_geography <span class="ot">=</span> <span class="fu">st_read</span>(<span class="st">"data/MC2/Oceanus Information/Oceanus Geography.geojson"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">4326</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `Oceanus Geography' from data source 
  `C:\rydialiang\ISSS608\Take-home Exercise\Take-home_Ex03\data\MC2\Oceanus Information\Oceanus Geography.geojson' 
  using driver `GeoJSON'
Simple feature collection with 29 features and 7 fields
Geometry type: GEOMETRY
Dimension:     XY
Bounding box:  xmin: -167.0654 ymin: 38.07452 xmax: -163.2723 ymax: 40.67775
Geodetic CRS:  WGS 84</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(oceanus_geography)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 29
Columns: 8
$ Name                 &lt;chr&gt; "Suna Island", "Thalassa Retreat", "Makara Shoal"…
$ Description          &lt;chr&gt; "Large island of Oceanus", "Smaller island of Oce…
$ X.note               &lt;chr&gt; "Suna is 'sand' or 'gritty' in Japanese", "Thalas…
$ type                 &lt;chr&gt; "Entity.Location.Region", "Entity.Location.Region…
$ X.Kind               &lt;chr&gt; "Island", "Island", "Island", "Island", "Fishing …
$ Activities           &lt;list&gt; "Residential", "Residential", "Recreation", &lt;"To…
$ fish_species_present &lt;list&gt; &lt;&gt;, &lt;&gt;, &lt;&gt;, &lt;&gt;, &lt;"Cod/Gadus n.specificatae", "Bi…
$ geometry             &lt;GEOMETRY [°]&gt; MULTIPOLYGON (((-166.0111 3..., MULTIPOL…</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(oceanus_geography, </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"data/rds/oceanus_geography.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>Importing Geographical Data in ESRI shapefile format</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>oceanus_locations <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/MC2/shp"</span>,</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">layer =</span> <span class="st">"Oceanus Geography"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `Oceanus Geography' from data source 
  `C:\rydialiang\ISSS608\Take-home Exercise\Take-home_Ex03\data\MC2\shp' 
  using driver `ESRI Shapefile'
Simple feature collection with 27 features and 7 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: -167.0654 ymin: 38.07452 xmax: -163.2723 ymax: 40.67775
Geodetic CRS:  WGS 84</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(oceanus_locations)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 27
Columns: 8
$ Name       &lt;chr&gt; "Haacklee", "Port Grove", "Lomark", "Himark", "Paackland", …
$ Descriptio &lt;chr&gt; NA, NA, NA, NA, NA, "Adimistrative seat of Oceanus", NA, NA…
$ X.note     &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…
$ Activities &lt;chr&gt; "Tourism,Local shipping", "Tourism,Research", "Deep sea fis…
$ type       &lt;chr&gt; "Entity.Location.City", "Entity.Location.City", "Entity.Loc…
$ X.Kind     &lt;chr&gt; "city", "city", "city", "city", "city", "city", "city", "bu…
$ fish_speci &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…
$ geometry   &lt;POINT [°]&gt; POINT (-165.6908 39.03215), POINT (-165.8855 39.10005…</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> oceanus_locations) <span class="sc">+</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(oceanus_locations, </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"data/rds/oceanus_locations.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="wrangling-of-geographical-data" class="level3">
<h3 class="anchored" data-anchor-id="wrangling-of-geographical-data">1.2.2 Wrangling of Geographical Data</h3>
<p>In the code chunk below, st_coordinate() of sf package is used to extract coordinates from oceanus_locations sf data.frame.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>coords <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(oceanus_locations)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Next, code chunk below is used to drop the geometry column of oceanus_locations of sf data.frame by using st_drop_geometry() of sf package and save the output into a new data.frame called oceanus_locations_df.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>oceanus_locations_df <span class="ot">&lt;-</span> oceanus_locations <span class="sc">%&gt;%</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_drop_geometry</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Then, the code chunk below is to append the x- and y-coodinate values from coords list into the XCOORD and YCOORD columns of oceanus_locations_df respectively.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>oceanus_locations_df<span class="sc">$</span>XCOORD <span class="ot">&lt;-</span> coords[, <span class="st">"X"</span>]</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>oceanus_locations_df<span class="sc">$</span>YCOORD <span class="ot">&lt;-</span> coords[, <span class="st">"Y"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Lastly, the code chunk below is used to tidy OceanusLocations_df by selecting the necessary columns only and at the same time, rename X.Kind to Loc_Type.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>oceanus_locations_df <span class="ot">&lt;-</span> oceanus_locations_df <span class="sc">%&gt;%</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Name, X.Kind, XCOORD, YCOORD) <span class="sc">%&gt;%</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">loc_type =</span> X.Kind, <span class="at">loc_short =</span> Name)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="wrangling-and-tidying-edges" class="level2">
<h2 class="anchored" data-anchor-id="wrangling-and-tidying-edges">1.3 <strong>Wrangling and tidying edges</strong></h2>
<section id="extracting-edges" class="level3">
<h3 class="anchored" data-anchor-id="extracting-edges">1.3.1 Extracting edges</h3>
<p>First, we extract only distinct edges from the tibble <em>links</em> data.frame of <em>mc2_data</em> and save it as a tibble data.frame called&nbsp;<em>mc2_edges</em>.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>mc2_edges <span class="ot">&lt;-</span> mc2_data<span class="sc">$</span>links <span class="sc">%&gt;%</span> </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Next,&nbsp;<code>glimpse()</code>&nbsp;of dplyr will be used to reveal the structure of&nbsp;<em>mc2_edges</em>&nbsp;tibble data.table.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(mc2_edges)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 271,643
Columns: 17
$ type                &lt;chr&gt; "Event.TransportEvent.TransponderPing", "Event.Tra…
$ time                &lt;chr&gt; "2035-09-16T04:06:48.185987", "2035-09-20T05:21:33…
$ dwell               &lt;dbl&gt; 115074.79, 412706.32, 286092.88, 327623.95, 243225…
$ `_last_edited_by`   &lt;chr&gt; "Olokun Daramola", "Melinda Manning", "Olokun Dara…
$ `_date_added`       &lt;chr&gt; "2035-09-16T00:59:46.300100", "2035-09-22T02:37:37…
$ `_last_edited_date` &lt;chr&gt; "2035-09-16T00:59:46.300100", "2035-09-22T02:37:37…
$ `_raw_source`       &lt;chr&gt; "Oceanus Vessel Locator System", "Oceanus Vessel L…
$ `_algorithm`        &lt;chr&gt; "OVLS-Catch&amp;Hook", "OVLS-Catch&amp;Hook", "OVLS-Catch&amp;…
$ source              &lt;chr&gt; "City of Haacklee", "City of Haacklee", "City of H…
$ target              &lt;chr&gt; "perchplundererbc0", "perchplundererbc0", "perchpl…
$ key                 &lt;int&gt; 0, 1, 2, 3, 4, 5, 6, 7, 8, 0, 1, 2, 3, 4, 5, 6, 7,…
$ date                &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ data_author         &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ aphorism            &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ holiday_greeting    &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ wisdom              &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ `saying of the sea` &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…</code></pre>
</div>
</div>
<p>From the table above, we can identify some issues with the data:</p>
<ol type="1">
<li><p>The columns with date data type are all in character format.</p></li>
<li><p>Some columns have names that starts with “_”. These need to be rename to avoid coding issues.</p></li>
</ol>
</section>
<section id="correcting-the-date-data-type-with-lubridate" class="level3">
<h3 class="anchored" data-anchor-id="correcting-the-date-data-type-with-lubridate">1.3.2 Correcting the date data type with <code>lubridate()</code></h3>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>mc2_edges<span class="sc">$</span>time <span class="ot">&lt;-</span> <span class="fu">as_datetime</span>(mc2_edges<span class="sc">$</span>time)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>mc2_edges<span class="sc">$</span><span class="st">`</span><span class="at">_last_edited_date</span><span class="st">`</span> <span class="ot">&lt;-</span> <span class="fu">as_datetime</span>(mc2_edges<span class="sc">$</span><span class="st">`</span><span class="at">_last_edited_date</span><span class="st">`</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>mc2_edges<span class="sc">$</span><span class="st">`</span><span class="at">_date_added</span><span class="st">`</span> <span class="ot">&lt;-</span> <span class="fu">as_datetime</span>(mc2_edges<span class="sc">$</span><span class="st">`</span><span class="at">_date_added</span><span class="st">`</span>)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>mc2_edges<span class="sc">$</span>date <span class="ot">&lt;-</span> <span class="fu">as_datetime</span>(mc2_edges<span class="sc">$</span>date)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Next, glimpse() will be used to confirm if the process have been performed correctly.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(mc2_edges)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 271,643
Columns: 17
$ type                &lt;chr&gt; "Event.TransportEvent.TransponderPing", "Event.Tra…
$ time                &lt;dttm&gt; 2035-09-16 04:06:48, 2035-09-20 05:21:33, 2035-09…
$ dwell               &lt;dbl&gt; 115074.79, 412706.32, 286092.88, 327623.95, 243225…
$ `_last_edited_by`   &lt;chr&gt; "Olokun Daramola", "Melinda Manning", "Olokun Dara…
$ `_date_added`       &lt;dttm&gt; 2035-09-16 00:59:46, 2035-09-22 02:37:37, 2035-09…
$ `_last_edited_date` &lt;dttm&gt; 2035-09-16 00:59:46, 2035-09-22 02:37:37, 2035-10…
$ `_raw_source`       &lt;chr&gt; "Oceanus Vessel Locator System", "Oceanus Vessel L…
$ `_algorithm`        &lt;chr&gt; "OVLS-Catch&amp;Hook", "OVLS-Catch&amp;Hook", "OVLS-Catch&amp;…
$ source              &lt;chr&gt; "City of Haacklee", "City of Haacklee", "City of H…
$ target              &lt;chr&gt; "perchplundererbc0", "perchplundererbc0", "perchpl…
$ key                 &lt;int&gt; 0, 1, 2, 3, 4, 5, 6, 7, 8, 0, 1, 2, 3, 4, 5, 6, 7,…
$ date                &lt;dttm&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ data_author         &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ aphorism            &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ holiday_greeting    &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ wisdom              &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ `saying of the sea` &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…</code></pre>
</div>
</div>
</section>
<section id="changing-field-name" class="level3">
<h3 class="anchored" data-anchor-id="changing-field-name">1.3.3 Changing field name</h3>
<p>In the code chunk below, rename() of dplyr package is used to change the following fields.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>mc2_edges <span class="ot">&lt;-</span> mc2_edges <span class="sc">%&gt;%</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"last_edited_by"</span> <span class="ot">=</span> <span class="st">"_last_edited_by"</span>,</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>         <span class="st">"date_added"</span> <span class="ot">=</span> <span class="st">"_date_added"</span>,</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>         <span class="st">"last_edited_date"</span> <span class="ot">=</span> <span class="st">"_last_edited_date"</span>,</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>         <span class="st">"raw_source"</span> <span class="ot">=</span> <span class="st">"_raw_source"</span>,</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>         <span class="st">"algorithm"</span> <span class="ot">=</span> <span class="st">"_algorithm"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="splitting-words-in-type-column" class="level3">
<h3 class="anchored" data-anchor-id="splitting-words-in-type-column">1.3.4 Splitting words in <code>type</code> column</h3>
<p>The code chunk below combined the following steps:</p>
<ol type="1">
<li><p>Splitting the words by “.” - after observing that the format for type is as such: “Event.TransportEvent.TransponderPing”</p></li>
<li><p>The <code>max(lengths(word_list))</code> will be used to find the maximum number of elements in any split.</p></li>
<li><p>Apply function(x) to pad shorter splits with NA values to make them all the same length.</p></li>
<li><p>Create word_df and changing column names to event1 etc.</p></li>
<li><p>Convert word_df from matrix into tibble data.frame, and checks its class.</p></li>
<li><p>Append word_df to mc2_edges tibble data.frame.</p></li>
<li><p>Saving mc2_edges into R <strong>rds</strong> format as a physical file, so that there is no need to repeat the following code chunk to access a tidy mc2_edges tibble data frame.</p></li>
</ol>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>word_list <span class="ot">&lt;-</span> <span class="fu">strsplit</span>(mc2_edges<span class="sc">$</span>type, <span class="st">"</span><span class="sc">\\</span><span class="st">."</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>max_elements <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">lengths</span>(word_list))</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>word_list_padded <span class="ot">&lt;-</span> <span class="fu">lapply</span>(word_list, </span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span>(x) <span class="fu">c</span>(x, <span class="fu">rep</span>(<span class="cn">NA</span>, max_elements <span class="sc">-</span> <span class="fu">length</span>(x))))</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>word_df <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, word_list_padded)</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(word_df) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"event"</span>, <span class="dv">1</span><span class="sc">:</span>max_elements)</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>word_df <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(word_df) <span class="sc">%&gt;%</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(event2, event3)</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(word_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "tbl_df"     "tbl"        "data.frame"</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>mc2_edges <span class="ot">&lt;-</span> mc2_edges <span class="sc">%&gt;%</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(word_df)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co"># prior to running this code, create an rds folder in data folder to ensure files are saved in the correct directory</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(mc2_edges, <span class="st">"data/rds/mc2_edges.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="wrangling-and-tidying-nodes" class="level2">
<h2 class="anchored" data-anchor-id="wrangling-and-tidying-nodes">1.4 <strong>Wrangling and tidying nodes</strong></h2>
<section id="extracting-nodes" class="level3">
<h3 class="anchored" data-anchor-id="extracting-nodes">1.4.1 Extracting nodes</h3>
<p>The code chunk below will be used to extract the nodes data.frame of mc2_data and parses it as a tibble data.frame called mc2_nodes.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>mc2_nodes <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(mc2_data<span class="sc">$</span>nodes) <span class="sc">%&gt;%</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Next, take a <code>glimpse()</code> to understand the data structure.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(mc2_nodes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 5,637
Columns: 20
$ type                 &lt;chr&gt; "Entity.Commodity.Fish", "Entity.Commodity.Fish",…
$ `_last_edited_by`    &lt;chr&gt; "Clepper Jessen", "Clepper Jessen", "Haenyeo Hyun…
$ `_date_added`        &lt;chr&gt; "2033-09-04T00:00:00", "2034-01-21T00:00:00", "20…
$ `_last_edited_date`  &lt;chr&gt; "2035-01-25T00:00:00", "2035-01-04T00:00:00", "20…
$ `_raw_source`        &lt;chr&gt; "", "", "", "", "", "", "", "", "", "", "Oceanus:…
$ `_algorithm`         &lt;chr&gt; "", "", "", "", "", "", "", "", "", "", "", "", "…
$ name                 &lt;chr&gt; "Cod/Gadus n.specificatae", "Birdseye/Pisces frig…
$ id                   &lt;chr&gt; "gadusnspecificatae4ba", "piscesfrigus900", "pisc…
$ Name                 &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, "Haacklee…
$ Description          &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ Activities           &lt;list&gt; &lt;NULL&gt;, &lt;NULL&gt;, &lt;NULL&gt;, &lt;NULL&gt;, &lt;NULL&gt;, &lt;NULL&gt;, …
$ kind                 &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, "city", "…
$ qty_tons             &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ date                 &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ flag_country         &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ company              &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ tonnage              &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ length_overall       &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ style                &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ fish_species_present &lt;list&gt; &lt;NULL&gt;, &lt;NULL&gt;, &lt;NULL&gt;, &lt;NULL&gt;, &lt;NULL&gt;, &lt;NULL&gt;, …</code></pre>
</div>
</div>
<p>From the table above, beside the date data type, inappropriate field name, and treatment for <code>type</code> column issues we discussed earlier, two additional data issues can be observed. They are:</p>
<ul>
<li><p>The values in Activities and fish_species_present fields are in <strong>list</strong> data type, which will affect the ability to process and to analyse the data.</p></li>
<li><p>Some values in the Activities field are not ready to be analyse without further tidying (i.e.&nbsp;removing c(““)).</p></li>
</ul>
<p>We will first repeat the steps similar steps to wrangling the mc2_edges, before proceeding to tackle the issues for Activities and fish_species_present field.</p>
</section>
<section id="correcting-the-date-data-type-with-lubridate-1" class="level3">
<h3 class="anchored" data-anchor-id="correcting-the-date-data-type-with-lubridate-1">1.4.2 Correcting the date data type with <code>lubridate()</code></h3>
<p>Correct the date data type and take a <code>glimpse()</code> to confirm changes.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>mc2_nodes<span class="sc">$</span><span class="st">`</span><span class="at">_last_edited_date</span><span class="st">`</span> <span class="ot">&lt;-</span> <span class="fu">as_datetime</span>(mc2_nodes<span class="sc">$</span><span class="st">`</span><span class="at">_last_edited_date</span><span class="st">`</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>mc2_nodes<span class="sc">$</span><span class="st">`</span><span class="at">_date_added</span><span class="st">`</span> <span class="ot">&lt;-</span> <span class="fu">as_datetime</span>(mc2_nodes<span class="sc">$</span><span class="st">`</span><span class="at">_date_added</span><span class="st">`</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>mc2_nodes<span class="sc">$</span>date <span class="ot">&lt;-</span> <span class="fu">as_datetime</span>(mc2_nodes<span class="sc">$</span>date)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(mc2_nodes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 5,637
Columns: 20
$ type                 &lt;chr&gt; "Entity.Commodity.Fish", "Entity.Commodity.Fish",…
$ `_last_edited_by`    &lt;chr&gt; "Clepper Jessen", "Clepper Jessen", "Haenyeo Hyun…
$ `_date_added`        &lt;dttm&gt; 2033-09-04, 2034-01-21, 2033-06-22, 2033-11-24, …
$ `_last_edited_date`  &lt;dttm&gt; 2035-01-25, 2035-01-04, 2035-01-14, 2035-01-14, …
$ `_raw_source`        &lt;chr&gt; "", "", "", "", "", "", "", "", "", "", "Oceanus:…
$ `_algorithm`         &lt;chr&gt; "", "", "", "", "", "", "", "", "", "", "", "", "…
$ name                 &lt;chr&gt; "Cod/Gadus n.specificatae", "Birdseye/Pisces frig…
$ id                   &lt;chr&gt; "gadusnspecificatae4ba", "piscesfrigus900", "pisc…
$ Name                 &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, "Haacklee…
$ Description          &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ Activities           &lt;list&gt; &lt;NULL&gt;, &lt;NULL&gt;, &lt;NULL&gt;, &lt;NULL&gt;, &lt;NULL&gt;, &lt;NULL&gt;, …
$ kind                 &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, "city", "…
$ qty_tons             &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ date                 &lt;dttm&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …
$ flag_country         &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ company              &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ tonnage              &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ length_overall       &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ style                &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
$ fish_species_present &lt;list&gt; &lt;NULL&gt;, &lt;NULL&gt;, &lt;NULL&gt;, &lt;NULL&gt;, &lt;NULL&gt;, &lt;NULL&gt;, …</code></pre>
</div>
</div>
</section>
<section id="changing-field-name-1" class="level3">
<h3 class="anchored" data-anchor-id="changing-field-name-1">1.4.3 Changing field name</h3>
<p>In the code chunk below, rename() of dplyr package is used to change the following fields.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>mc2_nodes <span class="ot">&lt;-</span> mc2_nodes <span class="sc">%&gt;%</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"last_edited_by"</span> <span class="ot">=</span> <span class="st">"_last_edited_by"</span>,</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>         <span class="st">"date_added"</span> <span class="ot">=</span> <span class="st">"_date_added"</span>,</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>         <span class="st">"last_edited_date"</span> <span class="ot">=</span> <span class="st">"_last_edited_date"</span>,</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>         <span class="st">"raw_source"</span> <span class="ot">=</span> <span class="st">"_raw_source"</span>,</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>         <span class="st">"algorithm"</span> <span class="ot">=</span> <span class="st">"_algorithm"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="splitting-words-in-type-column-1" class="level3">
<h3 class="anchored" data-anchor-id="splitting-words-in-type-column-1">1.4.4 Splitting words in <code>type</code> column</h3>
<p>Details on the code chunk can be found in section 1.3.4. At this point, we will not be saving the mc2_nodes as R <strong>rds</strong> format yet, as there are more works to be done to clean up the dataframe.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>word_list <span class="ot">&lt;-</span> <span class="fu">strsplit</span>(mc2_nodes<span class="sc">$</span>type, <span class="st">"</span><span class="sc">\\</span><span class="st">."</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>max_elements <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">lengths</span>(word_list))</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>word_list_padded <span class="ot">&lt;-</span> <span class="fu">lapply</span>(word_list, </span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span>(x) <span class="fu">c</span>(x, <span class="fu">rep</span>(<span class="cn">NA</span>, max_elements <span class="sc">-</span> <span class="fu">length</span>(x))))</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>word_df <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, word_list_padded)</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(word_df) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"entity"</span>, <span class="dv">1</span><span class="sc">:</span>max_elements)</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>word_df <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(word_df) <span class="sc">%&gt;%</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(entity2, entity3,entity4)</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(word_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "tbl_df"     "tbl"        "data.frame"</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>mc2_nodes <span class="ot">&lt;-</span> mc2_nodes <span class="sc">%&gt;%</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(word_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="tidying-text-field" class="level3">
<h3 class="anchored" data-anchor-id="tidying-text-field">1.4.5 Tidying text field</h3>
<p>Using <code>mutate()</code> of dplyr and <code>gsub()</code> of Base R to tidy up the values in the cell. Essentially, the unwanted characters like <code>c</code>, <code>(</code>, <code>)</code>, and <code>\</code> are removed by substituting with empty value <code>""</code> for both Activities and fish_species_present columns. What is left in the columns will be characters separated by <code>,</code>.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>mc2_nodes <span class="ot">&lt;-</span> mc2_nodes <span class="sc">%&gt;%</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Activities =</span> <span class="fu">gsub</span>(<span class="st">"c[(]"</span>, <span class="st">""</span>, Activities)) <span class="sc">%&gt;%</span> </span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Activities =</span> <span class="fu">gsub</span>(<span class="st">"</span><span class="sc">\"</span><span class="st">"</span>, <span class="st">""</span>, Activities)) <span class="sc">%&gt;%</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Activities =</span> <span class="fu">gsub</span>(<span class="st">"[)]"</span>, <span class="st">""</span>, Activities))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>mc2_nodes <span class="ot">&lt;-</span> mc2_nodes <span class="sc">%&gt;%</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fish_species_present =</span> <span class="fu">gsub</span>(<span class="st">"c[(]"</span>, <span class="st">""</span>, fish_species_present)) <span class="sc">%&gt;%</span> </span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fish_species_present =</span> <span class="fu">gsub</span>(<span class="st">"</span><span class="sc">\"</span><span class="st">"</span>, <span class="st">""</span>, fish_species_present)) <span class="sc">%&gt;%</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fish_species_present =</span> <span class="fu">gsub</span>(<span class="st">"[)]"</span>, <span class="st">""</span>, fish_species_present)) </span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>mc2_nodes<span class="sc">$</span>entity3[<span class="dv">5342</span>] <span class="ot">=</span> <span class="st">"Ferry_Cargo"</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>mc2_nodes<span class="sc">$</span>entity3[<span class="dv">5461</span>] <span class="ot">=</span> <span class="st">"Ferry_Cargo"</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>mc2_nodes<span class="sc">$</span>entity3[<span class="dv">5332</span>] <span class="ot">=</span> <span class="st">"Ferry_Passenger"</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>mc2_nodes<span class="sc">$</span>entity3[<span class="dv">5452</span>] <span class="ot">=</span> <span class="st">"Ferry_Passenger"</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>mc2_nodes<span class="sc">$</span>entity3[<span class="dv">5484</span>] <span class="ot">=</span> <span class="st">"Ferry_Passenger"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Lastly, we will save the tidied mc2_nodes</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># prior to running this code, create an rds folder in data folder to ensure files are saved in the correct directory</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(mc2_nodes, <span class="st">"data/rds/mc2_nodes.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="processing-nodes-and-edges-data" class="level2">
<h2 class="anchored" data-anchor-id="processing-nodes-and-edges-data">1.5 Processing nodes and edges data</h2>
<section id="understanding-the-nodes-and-edges-data" class="level3">
<h3 class="anchored" data-anchor-id="understanding-the-nodes-and-edges-data">1.5.1 Understanding the nodes and edges data</h3>
<p>In this section, we will gain more insights from the existing data. The table below summarises the type of data we can glean from the nodes and edges:</p>
<table class="table">
<colgroup>
<col style="width: 11%">
<col style="width: 15%">
<col style="width: 34%">
<col style="width: 36%">
</colgroup>
<thead>
<tr class="header">
<th>mc2_nodes Type</th>
<th>Entity</th>
<th>Details</th>
<th>Relevant Fields</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Commodity</td>
<td>Fish</td>
<td><p><strong>10 x Fish Species</strong></p>
<p><img src="images/clipboard-629994936.png" class="img-fluid"></p></td>
<td><ol type="1">
<li>name (fish species common name/scientific name</li>
<li>id (species)</li>
</ol></td>
</tr>
<tr class="even">
<td>Location</td>
<td><ol type="1">
<li>City</li>
<li>Point</li>
<li>Region</li>
</ol></td>
<td><p><strong>24 x Locations:</strong></p>
<p><strong>6 x City</strong></p>
<p><img src="images/clipboard-3282014997.png" class="img-fluid"></p>
<p><strong>12 x Point</strong></p>
<p><img src="images/clipboard-802842425.png" class="img-fluid" width="94"></p>
<p><strong>6 x Region</strong></p>
<ul>
<li><p>3 x Ecological Preserves</p></li>
<li><p>3 x Fishing Ground</p></li>
</ul>
<p><img src="images/clipboard-3654858944.png" class="img-fluid"></p></td>
<td><ol type="1">
<li>id ( City Name)</li>
<li>Name (City short name)</li>
<li>description</li>
<li>activities</li>
<li>kind</li>
<li>entity3 (type of location)</li>
</ol></td>
</tr>
<tr class="odd">
<td>Document</td>
<td>Delivery Report</td>
<td><strong>5,307 x Cargoes</strong></td>
<td><ol type="1">
<li>id</li>
<li>qty_tons</li>
<li>date</li>
</ol></td>
</tr>
<tr class="even">
<td>Vessels</td>
<td><ol type="1">
<li>Fishing Vessels</li>
<li>Cargo Vessels</li>
<li>Ferry Cargo</li>
<li>Ferry Passenger</li>
<li>Research</li>
<li>Tour</li>
<li>Others</li>
</ol></td>
<td><p><strong>296 x Vessels</strong></p>
<ul>
<li><p>178 x Fishing Vessels</p></li>
<li><p>100 x Cargo Vessels</p></li>
<li><p>2 x Cargo Ferry</p></li>
<li><p>3 x Passenger Ferry</p></li>
<li><p>2 x Research Vessels</p></li>
<li><p>6 x Tour Vessels</p></li>
<li><p>5 x Other Vessels</p></li>
</ul></td>
<td><ol type="1">
<li>id</li>
<li>Name</li>
<li>flag_country</li>
<li>company</li>
<li>tonnage</li>
<li>length_overall</li>
<li>entity3 (type of vessels)</li>
</ol></td>
</tr>
</tbody>
</table>
<table class="table">
<colgroup>
<col style="width: 14%">
<col style="width: 58%">
<col style="width: 26%">
</colgroup>
<thead>
<tr class="header">
<th>mc2_edges type</th>
<th>Count (n)</th>
<th>Relevant Fields</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Transponder Ping</td>
<td>258,542&nbsp;x Pings</td>
<td><ol type="1">
<li>time</li>
<li>dwell</li>
<li>source (locations)</li>
<li>target (vessels)</li>
</ol></td>
</tr>
<tr class="even">
<td>Harbor Report</td>
<td>&nbsp;2,487 x Sightings</td>
<td><ol type="1">
<li>source (vessels)</li>
<li>target (city)</li>
<li>date</li>
</ol></td>
</tr>
<tr class="odd">
<td>Import Record</td>
<td>10,614 x Records (matching 5,307 unique cargoes to fish species and city)</td>
<td><ol type="1">
<li>source (cargo)</li>
<li>target (fish species &amp; city)</li>
<li>date</li>
</ol></td>
</tr>
</tbody>
</table>
</section>
<section id="extracting-relevant-information-for-each-nodes-data" class="level3">
<h3 class="anchored" data-anchor-id="extracting-relevant-information-for-each-nodes-data">1.5.2 Extracting Relevant Information for each nodes data</h3>
<p>In this section, we will extract the relevant columns with intuitive names. From the analysis above, we will have 4 nodes data and 3 edges data as below:</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Nodes and Edges Data
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Nodes:</strong></p>
<ol type="1">
<li>fish_nodes: all types of fish species in the data set</li>
<li>location_nodes: all locations in the data set</li>
<li>cargo_nodes: all cargoes in the data set</li>
<li>vessel_nodes: all vessels in the data set</li>
</ol>
<p><strong>Edges:</strong></p>
<ol type="1">
<li>vessel_movement: vessel movement, location, time and dwell</li>
<li>harbor_report: date and vessel that dock in the harbor (city)</li>
<li>import_record: date and location of transaction of cargoes</li>
</ol>
</div>
</div>
<p><strong>fish_nodes</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>fish_nodes <span class="ot">&lt;-</span> mc2_nodes <span class="sc">%&gt;%</span> </span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(entity2 <span class="sc">==</span> <span class="st">"Commodity"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name, id) <span class="sc">%&gt;%</span> </span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">str_replace</span>(name, <span class="st">"/.*"</span>, <span class="st">""</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">fish =</span> name, <span class="at">species =</span> id)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>location_nodes</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>location_nodes <span class="ot">&lt;-</span> mc2_nodes <span class="sc">%&gt;%</span> </span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(entity2 <span class="sc">==</span> <span class="st">"Location"</span> ) <span class="sc">%&gt;%</span> </span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, Name, Description, Activities, kind, entity3) <span class="sc">%&gt;%</span> </span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">loc =</span> id, <span class="at">loc_short =</span> Name, <span class="at">type =</span> entity3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>cargo_nodes</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>cargo_nodes <span class="ot">&lt;-</span> mc2_nodes <span class="sc">%&gt;%</span> </span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(entity3 <span class="sc">==</span> <span class="st">"DeliveryReport"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id,qty_tons,date) <span class="sc">%&gt;%</span> </span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">cargo =</span> id, <span class="at">cargo_delivery_date =</span> date)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>vessel_nodes</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>vessel_nodes <span class="ot">&lt;-</span> mc2_nodes <span class="sc">%&gt;%</span> </span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(entity2 <span class="sc">==</span> <span class="st">"Vessel"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id, Name, flag_country, </span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>         company, tonnage, </span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>         length_overall, entity3) <span class="sc">%&gt;%</span> </span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">vessel =</span> id, <span class="at">vessel_name =</span> Name, <span class="at">type =</span> entity3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="consolidating-relevant-information-in-the-edges-data" class="level3">
<h3 class="anchored" data-anchor-id="consolidating-relevant-information-in-the-edges-data">1.5.3 Consolidating relevant information in the edges data</h3>
<p><strong>vessel_movement</strong></p>
<p>We will add in oceanus_location and vessel_nodes data together with the Transponder Ping data, by using left_join .</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>vessel_movement <span class="ot">&lt;-</span> mc2_edges <span class="sc">%&gt;%</span> </span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(event3 <span class="sc">==</span> <span class="st">"TransponderPing"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(time, dwell, source, target) <span class="sc">%&gt;%</span> </span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">loc=</span> source, <span class="at">vessel =</span> target )</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>vessel_movement<span class="sc">$</span>loc_short <span class="ot">&lt;-</span> vessel_movement<span class="sc">$</span>loc</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>vessel_movement <span class="ot">&lt;-</span> vessel_movement <span class="sc">%&gt;%</span>   </span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">loc_short =</span> <span class="fu">gsub</span>(<span class="st">"^City of"</span>, <span class="st">""</span>,loc_short)) <span class="sc">%&gt;%</span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">loc_short =</span> <span class="fu">gsub</span>(<span class="st">"^</span><span class="sc">\\</span><span class="st">s+"</span>, <span class="st">""</span>,loc_short)) <span class="sc">%&gt;%</span> </span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(oceanus_locations_df) <span class="sc">%&gt;%</span> </span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(vessel_nodes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>harbor_report</strong></p>
<p>Similarly, we will add in vessel_nodes data into the harbor_report using left_join.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>harbor_report <span class="ot">&lt;-</span> mc2_edges <span class="sc">%&gt;%</span> </span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(event2 <span class="sc">==</span><span class="st">"HarborReport"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(source, target, date) <span class="sc">%&gt;%</span> </span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">vessel =</span> source, <span class="at">city =</span> target)</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>harbor_report <span class="ot">&lt;-</span> harbor_report <span class="sc">%&gt;%</span> </span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(vessel_nodes, <span class="at">by =</span> <span class="st">"vessel"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>import_record</strong></p>
<p>Combining fish_nodes and cargo_nodes data into import_record using left_join.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>import_record <span class="ot">&lt;-</span> mc2_edges <span class="sc">%&gt;%</span> </span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(event2 <span class="sc">==</span> <span class="st">"Transaction"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(source, target, date)</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>import_city <span class="ot">&lt;-</span> import_record <span class="sc">%&gt;%</span> </span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(source,target) <span class="sc">%&gt;%</span> </span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(target <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"City of Haacklee"</span>,</span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"City of Lomark"</span>,</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"City of Himark"</span>,</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"City of Paackland"</span>,</span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"City of South Paackland"</span>,</span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"City of Port Grove"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">city =</span> target)</span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>import_cargo <span class="ot">&lt;-</span> import_record <span class="sc">%&gt;%</span> </span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(source,target) <span class="sc">%&gt;%</span> </span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>target <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"City of Haacklee"</span>,</span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"City of Lomark"</span>,</span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"City of Himark"</span>,</span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"City of Paackland"</span>,</span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"City of South Paackland"</span>,</span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"City of Port Grove"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">species =</span> target)</span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-26"><a href="#cb46-26" aria-hidden="true" tabindex="-1"></a>import_record <span class="ot">&lt;-</span> import_city <span class="sc">%&gt;%</span> </span>
<span id="cb46-27"><a href="#cb46-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(import_cargo) <span class="sc">%&gt;%</span> </span>
<span id="cb46-28"><a href="#cb46-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">cargo =</span> source) <span class="sc">%&gt;%</span> </span>
<span id="cb46-29"><a href="#cb46-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(fish_nodes) <span class="sc">%&gt;%</span> </span>
<span id="cb46-30"><a href="#cb46-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(cargo_nodes) <span class="sc">%&gt;%</span> </span>
<span id="cb46-31"><a href="#cb46-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(fish, species, city, cargo, qty_tons, cargo_delivery_date)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Before we move on to exploring the data, we will save the 4 nodes and 3 edges as R <strong>rds</strong> format in the data/rds folder:</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(fish_nodes, <span class="st">"data/rds/fish_nodes.rds"</span>)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(location_nodes, <span class="st">"data/rds/location_nodes.rds"</span>)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(cargo_nodes, <span class="st">"data/rds/cargo_nodes.rds"</span>)</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(vessel_nodes, <span class="st">"data/rds/vessel_nodes.rds"</span>)</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(vessel_movement, <span class="st">"data/rds/vessel_movement.rds"</span>)</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(harbor_report, <span class="st">"data/rds/harbor_report.rds"</span>)</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(import_record, <span class="st">"data/rds/import_record.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="exploratory-data-analysis" class="level2">
<h2 class="anchored" data-anchor-id="exploratory-data-analysis">1.6 Exploratory Data Analysis</h2>
<section id="understanding-the-fish-species-in-each-region" class="level3">
<h3 class="anchored" data-anchor-id="understanding-the-fish-species-in-each-region">1.6.1 Understanding the Fish Species in each Region</h3>
<p>Before we can detect anomalies in the for fishing activities, we first need to understand where are the fish species found in each Region.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>region_fish_species <span class="ot">&lt;-</span> mc2_nodes <span class="sc">%&gt;%</span> </span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(entity3 <span class="sc">==</span> <span class="st">"Region"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Name, fish_species_present, Activities, kind) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>word_list <span class="ot">&lt;-</span> <span class="fu">strsplit</span>(region_fish_species<span class="sc">$</span>fish_species_present, <span class="st">"</span><span class="sc">\\</span><span class="st">,"</span>)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>max_elements <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">lengths</span>(word_list))</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>word_list_padded <span class="ot">&lt;-</span> <span class="fu">lapply</span>(word_list, </span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span>(x) <span class="fu">c</span>(x, <span class="fu">rep</span>(<span class="cn">NA</span>, max_elements <span class="sc">-</span> <span class="fu">length</span>(x))))</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>word_df <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, word_list_padded)</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(word_df) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"species"</span>, <span class="dv">1</span><span class="sc">:</span>max_elements) </span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>word_df <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(word_df) <span class="sc">%&gt;%</span> </span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">species1 =</span> <span class="fu">str_replace</span>(species1, <span class="st">"/.*"</span>, <span class="st">""</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">species2 =</span> <span class="fu">str_replace</span>(species2, <span class="st">"/.*"</span>, <span class="st">""</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">species3 =</span> <span class="fu">str_replace</span>(species3, <span class="st">"/.*"</span>, <span class="st">""</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">species4 =</span> <span class="fu">str_replace</span>(species4, <span class="st">"/.*"</span>, <span class="st">""</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">species5 =</span> <span class="fu">str_replace</span>(species5 , <span class="st">"/.*"</span>, <span class="st">""</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(species1<span class="sc">:</span>species5), trimws)</span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>region_fish_species <span class="ot">&lt;-</span> region_fish_species <span class="sc">%&gt;%</span></span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(word_df)</span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert data to long format</span></span>
<span id="cb49-23"><a href="#cb49-23" aria-hidden="true" tabindex="-1"></a>region_fish_species_long <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(region_fish_species, <span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"species"</span>), <span class="at">names_to =</span> <span class="st">"Species"</span>, <span class="at">values_to =</span> <span class="st">"Presence"</span>)</span>
<span id="cb49-24"><a href="#cb49-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-25"><a href="#cb49-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter out empty values and trim away leading and trailing whitespace</span></span>
<span id="cb49-26"><a href="#cb49-26" aria-hidden="true" tabindex="-1"></a>region_fish_species_long <span class="ot">&lt;-</span> region_fish_species_long[region_fish_species_long<span class="sc">$</span>Presence <span class="sc">!=</span> <span class="st">""</span>, ] <span class="sc">%&gt;%</span> </span>
<span id="cb49-27"><a href="#cb49-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb49-28"><a href="#cb49-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(Presence), trimws)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Order them based on 3 Preserves and 3 Fishing Ground</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>desired_order <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Ghoti Preserve"</span>, <span class="st">"Nemo Reef"</span>, <span class="st">"Don Limpet Preserve"</span>,<span class="st">"Cod Table"</span>, <span class="st">"Wrasse Beds"</span>,<span class="st">"Tuna Shelf"</span>)  </span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>region_fish_species_long<span class="sc">$</span>Name <span class="ot">&lt;-</span> <span class="fu">factor</span>(region_fish_species_long<span class="sc">$</span>Name, <span class="at">levels =</span> desired_order)</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(region_fish_species_long, <span class="fu">aes</span>(<span class="at">x =</span> Name, </span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">y =</span> Presence,</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">colour =</span> Presence)) <span class="sc">+</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Species Presence in each Region"</span>,</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Region"</span>,</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Species"</span>) <span class="sc">+</span></span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Insights from this visualisation
</div>
</div>
<div class="callout-body-container callout-body">
<p><u><strong>Ecological Preserves</strong></u></p>
<p>We can derive that Sockfish, Offidiaa, and Helenaa species can only be found in the preserves but not in the fishing grounds. Therefore, any cargoes that contains these fish species (Sockfish, Offidiaa, and Helenaa) would have fished illegally. Below shows the visualisation of the species and qty_ton that flows through each city by months.</p>
<ul>
<li><p>Sockfish: Only found in Don Limpet Preserve</p></li>
<li><p>Offidiaa: Only found in Ghoti Preserve</p></li>
<li><p>Helenaa: Only found in Ecological Preserves (all three)</p></li>
</ul>
<p><u><strong>Fishing Grounds</strong></u></p>
<ul>
<li><p>Cod: Only found in Cod Table</p></li>
<li><p>Harland: Only found in Tuna Shelf</p></li>
</ul>
<p><strong>Other notable point</strong></p>
<ul>
<li>Salmon: Not found in any of the 6 locations mentioned above. This might be imports from other countries or from international shipping.</li>
</ul>
</div>
</div>
</section>
<section id="understanding-the-qty_tons-of-each-fish-species-by-city" class="level3">
<h3 class="anchored" data-anchor-id="understanding-the-qty_tons-of-each-fish-species-by-city">1.6.2 Understanding the qty_tons of each Fish Species by City</h3>
<p>After identifying the three fish species (Sockfish, Offidiaa, and Helenaa) that are only found in the Ecological Preserves, we will have an overview of how each of the fish species are spread across the city.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate the qty_tons by fish and city</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>qty_tons_agg <span class="ot">&lt;-</span> import_record <span class="sc">%&gt;%</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(fish, city) <span class="sc">%&gt;%</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_qty_tons =</span> <span class="fu">sum</span>(qty_tons, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Add distinct colors to flag out Sockfish, Offidiaa, and Helenaa</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>color <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Wrasse"</span> <span class="ot">=</span> <span class="st">"#000099"</span>,</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Tuna"</span> <span class="ot">=</span> <span class="st">"#0000CC"</span>,</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Harland"</span> <span class="ot">=</span> <span class="st">"#0000FF"</span>,</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Cod"</span> <span class="ot">=</span> <span class="st">"#3333FF"</span>,</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Birdseye"</span> <span class="ot">=</span> <span class="st">"#6666FF"</span>,</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Beauvoir"</span> <span class="ot">=</span> <span class="st">"#9999FF"</span>,</span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Salmon"</span> <span class="ot">=</span> <span class="st">"#CCCCFF"</span>,</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Helenaa"</span> <span class="ot">=</span> <span class="st">"#FF99FF"</span>,</span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Offidiaa"</span> <span class="ot">=</span> <span class="st">"#FF00FF"</span>,</span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Sockfish"</span> <span class="ot">=</span> <span class="st">"#990099"</span>)</span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder to match the above </span></span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a>qty_tons_agg<span class="sc">$</span>fish <span class="ot">&lt;-</span> <span class="fu">factor</span>(qty_tons_agg<span class="sc">$</span>fish,</span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a>                            <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Wrasse"</span>,<span class="st">"Tuna"</span>,</span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"Harland"</span>,<span class="st">"Cod"</span>,</span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"Birdseye"</span>, <span class="st">"Beauvoir"</span>,</span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"Salmon"</span>,<span class="st">"Helenaa"</span>,</span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"Offidiaa"</span>,<span class="st">"Sockfish"</span>))</span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-27"><a href="#cb51-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder city in descending order based on total_qty_tons</span></span>
<span id="cb51-28"><a href="#cb51-28" aria-hidden="true" tabindex="-1"></a>qty_tons_agg<span class="sc">$</span>city <span class="ot">&lt;-</span> <span class="fu">factor</span>(qty_tons_agg<span class="sc">$</span>city,</span>
<span id="cb51-29"><a href="#cb51-29" aria-hidden="true" tabindex="-1"></a>                            <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"City of Paackland"</span>,</span>
<span id="cb51-30"><a href="#cb51-30" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"City of Himark"</span>,</span>
<span id="cb51-31"><a href="#cb51-31" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"City of Lomark"</span>,</span>
<span id="cb51-32"><a href="#cb51-32" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"City of South Paackland"</span>,</span>
<span id="cb51-33"><a href="#cb51-33" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"City of Haacklee"</span>))</span>
<span id="cb51-34"><a href="#cb51-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-35"><a href="#cb51-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Bar plot</span></span>
<span id="cb51-36"><a href="#cb51-36" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(qty_tons_agg, <span class="fu">aes</span>(<span class="at">x =</span> city, </span>
<span id="cb51-37"><a href="#cb51-37" aria-hidden="true" tabindex="-1"></a>                         <span class="at">y =</span> total_qty_tons, </span>
<span id="cb51-38"><a href="#cb51-38" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fill =</span> fish)) <span class="sc">+</span></span>
<span id="cb51-39"><a href="#cb51-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb51-40"><a href="#cb51-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> color) <span class="sc">+</span></span>
<span id="cb51-41"><a href="#cb51-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Quantity Tons of Fish by City and Fish Species"</span>,</span>
<span id="cb51-42"><a href="#cb51-42" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"City"</span>,</span>
<span id="cb51-43"><a href="#cb51-43" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Total Quantity (tons)"</span>,</span>
<span id="cb51-44"><a href="#cb51-44" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Fish Species"</span>) <span class="sc">+</span></span>
<span id="cb51-45"><a href="#cb51-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="understanding-the-number-of-cargoes-of-each-fish-species-by-city" class="level3">
<h3 class="anchored" data-anchor-id="understanding-the-number-of-cargoes-of-each-fish-species-by-city">1.6.3 Understanding the number of cargoes of each Fish Species by City</h3>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate the qty_tons by fish and city</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>cargo_n_agg <span class="ot">&lt;-</span> import_record <span class="sc">%&gt;%</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(fish, city) <span class="sc">%&gt;%</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_cargo =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Add distinct colors to flag out Sockfish, Offidiaa, and Helenaa</span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>color <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Wrasse"</span> <span class="ot">=</span> <span class="st">"#000099"</span>,</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Tuna"</span> <span class="ot">=</span> <span class="st">"#0000CC"</span>,</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Harland"</span> <span class="ot">=</span> <span class="st">"#0000FF"</span>,</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Cod"</span> <span class="ot">=</span> <span class="st">"#3333FF"</span>,</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Birdseye"</span> <span class="ot">=</span> <span class="st">"#6666FF"</span>,</span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Beauvoir"</span> <span class="ot">=</span> <span class="st">"#9999FF"</span>,</span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Salmon"</span> <span class="ot">=</span> <span class="st">"#CCCCFF"</span>,</span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Helenaa"</span> <span class="ot">=</span> <span class="st">"#FF99FF"</span>,</span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Offidiaa"</span> <span class="ot">=</span> <span class="st">"#FF00FF"</span>,</span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a>           <span class="st">"Sockfish"</span> <span class="ot">=</span> <span class="st">"#990099"</span>)</span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder to match the above </span></span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a>cargo_n_agg<span class="sc">$</span>fish <span class="ot">&lt;-</span> <span class="fu">factor</span>(cargo_n_agg<span class="sc">$</span>fish,</span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a>                            <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Wrasse"</span>,<span class="st">"Tuna"</span>,</span>
<span id="cb52-22"><a href="#cb52-22" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"Harland"</span>,<span class="st">"Cod"</span>,</span>
<span id="cb52-23"><a href="#cb52-23" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"Birdseye"</span>, <span class="st">"Beauvoir"</span>,</span>
<span id="cb52-24"><a href="#cb52-24" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"Salmon"</span>,<span class="st">"Helenaa"</span>,</span>
<span id="cb52-25"><a href="#cb52-25" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"Offidiaa"</span>,<span class="st">"Sockfish"</span>))</span>
<span id="cb52-26"><a href="#cb52-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-27"><a href="#cb52-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder city in descending order based on total_qty_tons</span></span>
<span id="cb52-28"><a href="#cb52-28" aria-hidden="true" tabindex="-1"></a>cargo_n_agg<span class="sc">$</span>city <span class="ot">&lt;-</span> <span class="fu">factor</span>(cargo_n_agg<span class="sc">$</span>city,</span>
<span id="cb52-29"><a href="#cb52-29" aria-hidden="true" tabindex="-1"></a>                            <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"City of Paackland"</span>,</span>
<span id="cb52-30"><a href="#cb52-30" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"City of Himark"</span>,</span>
<span id="cb52-31"><a href="#cb52-31" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"City of Lomark"</span>,</span>
<span id="cb52-32"><a href="#cb52-32" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"City of South Paackland"</span>,</span>
<span id="cb52-33"><a href="#cb52-33" aria-hidden="true" tabindex="-1"></a>                                       <span class="st">"City of Haacklee"</span>))</span>
<span id="cb52-34"><a href="#cb52-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-35"><a href="#cb52-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Bar plot</span></span>
<span id="cb52-36"><a href="#cb52-36" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cargo_n_agg, <span class="fu">aes</span>(<span class="at">x =</span> city, </span>
<span id="cb52-37"><a href="#cb52-37" aria-hidden="true" tabindex="-1"></a>                         <span class="at">y =</span> total_cargo, </span>
<span id="cb52-38"><a href="#cb52-38" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fill =</span> fish)) <span class="sc">+</span></span>
<span id="cb52-39"><a href="#cb52-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb52-40"><a href="#cb52-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> color) <span class="sc">+</span></span>
<span id="cb52-41"><a href="#cb52-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Number of Cargoes by City and Fish Species"</span>,</span>
<span id="cb52-42"><a href="#cb52-42" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"City"</span>,</span>
<span id="cb52-43"><a href="#cb52-43" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"No. of Cargoes"</span>,</span>
<span id="cb52-44"><a href="#cb52-44" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Fish Species"</span>) <span class="sc">+</span></span>
<span id="cb52-45"><a href="#cb52-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Insights from this visualisation
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>Both qty_tons and number of cargoes bar plots shows similar distribution of fish species within each city.</p></li>
<li><p>The City of Paackland processed the highest qty_tons and number of cargoes, follow by City of Himark, City of Lomark, City of South Paackalnd, and City of Hacklee.</p></li>
</ul>
</div>
</div>
</section>
<section id="understanding-the-activities-by-locations" class="level3">
<h3 class="anchored" data-anchor-id="understanding-the-activities-by-locations">1.6.4 Understanding the Activities by Locations</h3>
<p>Understanding the activities in each of the locations.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>word_list <span class="ot">&lt;-</span> <span class="fu">strsplit</span>(location_nodes<span class="sc">$</span>Activities, <span class="st">"</span><span class="sc">\\</span><span class="st">,"</span>)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>max_elements <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">lengths</span>(word_list))</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>word_list_padded <span class="ot">&lt;-</span> <span class="fu">lapply</span>(word_list, </span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a><span class="cf">function</span>(x) <span class="fu">c</span>(x, <span class="fu">rep</span>(<span class="cn">NA</span>, max_elements <span class="sc">-</span> <span class="fu">length</span>(x))))</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>word_df <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, word_list_padded)</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(word_df) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"activity"</span>, <span class="dv">1</span><span class="sc">:</span>max_elements) </span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>word_df <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(word_df) </span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>location_nodes1 <span class="ot">&lt;-</span> location_nodes <span class="sc">%&gt;%</span></span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(word_df)</span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert data to long format</span></span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a>location_nodes_long <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(location_nodes1, <span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"activity"</span>), <span class="at">names_to =</span> <span class="st">"activity"</span>, <span class="at">values_to =</span> <span class="st">"Presence"</span>)</span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter out empty values and trim away leading and trailing whitespace</span></span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a>location_nodes_long <span class="ot">&lt;-</span> location_nodes_long[location_nodes_long<span class="sc">$</span>Presence <span class="sc">!=</span> <span class="st">""</span>, ] <span class="sc">%&gt;%</span> </span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="fu">vars</span>(Presence), trimws) <span class="sc">%&gt;%</span> </span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">if_all</span>(<span class="fu">c</span>(loc), <span class="sc">~</span> <span class="sc">!</span><span class="fu">is.na</span>(.)))</span>
<span id="cb53-23"><a href="#cb53-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-24"><a href="#cb53-24" aria-hidden="true" tabindex="-1"></a>location_nodes_long<span class="sc">$</span>Presence[<span class="dv">8</span>] <span class="ot">=</span> <span class="st">"Tourism"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Order the locations</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>desired_order <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"City of Himark"</span>,</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"City of Lomark"</span>,</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"City of Haacklee"</span>,</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"City of Paackland"</span>,</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"City of South Paackland"</span>,</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"City of Port Grove"</span>,</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Ghoti Preserve"</span>, </span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Nemo Reef"</span>, </span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Don Limpet Preserve"</span>,</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Cod Table"</span>, </span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Wrasse Beds"</span>,</span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Tuna Shelf"</span>,</span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Exit North"</span>,</span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Exit South"</span>,</span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Exit East"</span>,</span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Exit West"</span>,</span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Nav 1"</span>,<span class="st">"Nav 2"</span>, <span class="st">"Nav 3"</span>, </span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Nav A"</span>, <span class="st">"Nav B"</span>, <span class="st">"Nav C"</span>, <span class="st">"Nav D"</span>, <span class="st">"Nav E"</span>)  </span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a>location_nodes_long<span class="sc">$</span>loc <span class="ot">&lt;-</span> <span class="fu">factor</span>(location_nodes_long<span class="sc">$</span>loc, <span class="at">levels =</span> desired_order)</span>
<span id="cb54-22"><a href="#cb54-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-23"><a href="#cb54-23" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(location_nodes_long, <span class="fu">aes</span>(<span class="at">x =</span> loc, </span>
<span id="cb54-24"><a href="#cb54-24" aria-hidden="true" tabindex="-1"></a>                                <span class="at">y =</span> Presence,</span>
<span id="cb54-25"><a href="#cb54-25" aria-hidden="true" tabindex="-1"></a>                                <span class="at">colour =</span> Presence)) <span class="sc">+</span></span>
<span id="cb54-26"><a href="#cb54-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb54-27"><a href="#cb54-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Activities in each Location"</span>,</span>
<span id="cb54-28"><a href="#cb54-28" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Location"</span>,</span>
<span id="cb54-29"><a href="#cb54-29" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Activity"</span>) <span class="sc">+</span></span>
<span id="cb54-30"><a href="#cb54-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb54-31"><a href="#cb54-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb54-32"><a href="#cb54-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate the transponder ping by location</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>location_ping_agg <span class="ot">&lt;-</span> vessel_movement <span class="sc">%&gt;%</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(loc, type) <span class="sc">%&gt;%</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_ping =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder to match the above </span></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>location_ping_agg<span class="sc">$</span>loc <span class="ot">&lt;-</span> <span class="fu">factor</span>(location_ping_agg<span class="sc">$</span>loc,</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>                           <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"City of Himark"</span>,</span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"City of Lomark"</span>,</span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"City of Haacklee"</span>,</span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"City of Paackland"</span>,</span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"City of South Paackland"</span>,</span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"City of Port Grove"</span>,</span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"Ghoti Preserve"</span>, </span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"Nemo Reef"</span>, </span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"Don Limpet Preserve"</span>,</span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"Cod Table"</span>, </span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"Wrasse Beds"</span>,</span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"Tuna Shelf"</span>,</span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"Exit North"</span>,</span>
<span id="cb55-23"><a href="#cb55-23" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"Exit South"</span>,</span>
<span id="cb55-24"><a href="#cb55-24" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"Exit East"</span>,</span>
<span id="cb55-25"><a href="#cb55-25" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"Exit West"</span>,</span>
<span id="cb55-26"><a href="#cb55-26" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"Nav 1"</span>,<span class="st">"Nav 2"</span>, <span class="st">"Nav 3"</span>, </span>
<span id="cb55-27"><a href="#cb55-27" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"Nav A"</span>, <span class="st">"Nav B"</span>, <span class="st">"Nav C"</span>, <span class="st">"Nav D"</span>, <span class="st">"Nav E"</span>))  </span>
<span id="cb55-28"><a href="#cb55-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-29"><a href="#cb55-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Bar plot</span></span>
<span id="cb55-30"><a href="#cb55-30" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(location_ping_agg, <span class="fu">aes</span>(<span class="at">x =</span> loc, </span>
<span id="cb55-31"><a href="#cb55-31" aria-hidden="true" tabindex="-1"></a>                              <span class="at">y =</span> total_ping, </span>
<span id="cb55-32"><a href="#cb55-32" aria-hidden="true" tabindex="-1"></a>                              <span class="at">fill =</span> type)) <span class="sc">+</span></span>
<span id="cb55-33"><a href="#cb55-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb55-34"><a href="#cb55-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Number of Transponder Ping by Locations"</span>,</span>
<span id="cb55-35"><a href="#cb55-35" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Locations"</span>,</span>
<span id="cb55-36"><a href="#cb55-36" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"No. of Transponder Ping"</span>,</span>
<span id="cb55-37"><a href="#cb55-37" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Locations"</span>) <span class="sc">+</span></span>
<span id="cb55-38"><a href="#cb55-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Insights from this visualisation
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>There is abnormally high number of pings for fishing vessels at Nemo Reef. Since Nemo Reef is a Ecological Preserve, the correct safe navigation around it is through Nav D.</p></li>
<li><p>Given that the fish species (Wrasse, Tuna, Birdseye, Beauvoir) in Nemo Reef, can also be found in other fishing grounds, there is likelihood of IUU here. The presence of Helenaa is the only tell-tale sign if a fishing vessel indeed fish in Nemo Reef.</p></li>
<li><p>There is abornormally high number of pings for fishing vessels at Exit East. Since the activities in Exit E are international shipping and Deep Sea Fishing, it is not a designated Fishing Ground within Oceanus. Thus, we should be only expecting cargo vessels through Exit E, as observed in other exits.</p></li>
</ul>
</div>
</div>
</section>
<section id="understanding-the-harbor-report-by-locations" class="level3">
<h3 class="anchored" data-anchor-id="understanding-the-harbor-report-by-locations">1.6.5 Understanding the Harbor Report by Locations</h3>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate the harbor report by location</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>harbor_report_agg <span class="ot">&lt;-</span> harbor_report <span class="sc">%&gt;%</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(city, type) <span class="sc">%&gt;%</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_report =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder to match the above </span></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>harbor_report_agg<span class="sc">$</span>city<span class="ot">&lt;-</span> <span class="fu">factor</span>(harbor_report_agg<span class="sc">$</span>city,</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>                           <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"City of Himark"</span>,</span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"City of Lomark"</span>,</span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"City of Haacklee"</span>,</span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"City of Paackland"</span>,</span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"City of South Paackland"</span>,</span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"City of Port Grove"</span>))</span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a>                                        </span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Bar plot</span></span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(harbor_report_agg, <span class="fu">aes</span>(<span class="at">x =</span> city, </span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a>                              <span class="at">y =</span> total_report, </span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a>                              <span class="at">fill =</span> type)) <span class="sc">+</span></span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb56-23"><a href="#cb56-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Number of Report by City"</span>,</span>
<span id="cb56-24"><a href="#cb56-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"City"</span>,</span>
<span id="cb56-25"><a href="#cb56-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"No. of Reports"</span>,</span>
<span id="cb56-26"><a href="#cb56-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"City"</span>) <span class="sc">+</span></span>
<span id="cb56-27"><a href="#cb56-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Insights from this visualisation
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>There is only Research and Tour vessels visiting City of Port Grove.</p></li>
<li><p>The other five cities have mostly fishing or cargo vessels visits.</p></li>
</ul>
</div>
</div>
</section>
<section id="understanding-the-cargoes" class="level3">
<h3 class="anchored" data-anchor-id="understanding-the-cargoes">1.6.6 Understanding the Cargoes</h3>
<p><strong>Cargoes by Quantity in Ton</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate Vlines</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>mean_qty_tons <span class="ot">&lt;-</span> <span class="fu">mean</span>(cargo_nodes<span class="sc">$</span>qty_tons, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>median_qty_tons <span class="ot">&lt;-</span> <span class="fu">median</span>(cargo_nodes<span class="sc">$</span>qty_tons, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new column to indicate if the value is negative</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>cargo_nodes <span class="ot">&lt;-</span> cargo_nodes <span class="sc">%&gt;%</span></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">is_negative =</span> <span class="fu">ifelse</span>(qty_tons <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="st">"Positive"</span>, <span class="st">"Negative"</span>))</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot Histogram</span></span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(cargo_nodes, <span class="fu">aes</span>(<span class="at">x =</span> qty_tons, <span class="at">fill =</span> is_negative)) <span class="sc">+</span></span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">5</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> mean_qty_tons), </span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"darkgreen"</span>, </span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>, </span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> median_qty_tons), </span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"blue"</span>, </span>
<span id="cb57-18"><a href="#cb57-18" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb57-19"><a href="#cb57-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Negative"</span> <span class="ot">=</span> <span class="st">"red"</span>, </span>
<span id="cb57-20"><a href="#cb57-20" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Positive"</span> <span class="ot">=</span> <span class="st">"skyblue"</span>), </span>
<span id="cb57-21"><a href="#cb57-21" aria-hidden="true" tabindex="-1"></a>                    <span class="at">name =</span> <span class="st">"Value Type"</span>) <span class="sc">+</span></span>
<span id="cb57-22"><a href="#cb57-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Cargo Quantity in Tons with Mean and Median"</span>,</span>
<span id="cb57-23"><a href="#cb57-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Quantity of Tons"</span>,</span>
<span id="cb57-24"><a href="#cb57-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb57-25"><a href="#cb57-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb57-26"><a href="#cb57-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, </span>
<span id="cb57-27"><a href="#cb57-27" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> mean_qty_tons, </span>
<span id="cb57-28"><a href="#cb57-28" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> <span class="cn">Inf</span>, </span>
<span id="cb57-29"><a href="#cb57-29" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Mean ="</span>, <span class="fu">round</span>(mean_qty_tons, <span class="dv">2</span>)), </span>
<span id="cb57-30"><a href="#cb57-30" aria-hidden="true" tabindex="-1"></a>           <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.2</span>, </span>
<span id="cb57-31"><a href="#cb57-31" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"darkgreen"</span>) <span class="sc">+</span></span>
<span id="cb57-32"><a href="#cb57-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, </span>
<span id="cb57-33"><a href="#cb57-33" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> median_qty_tons, </span>
<span id="cb57-34"><a href="#cb57-34" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> <span class="cn">Inf</span>, </span>
<span id="cb57-35"><a href="#cb57-35" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"Median ="</span>, <span class="fu">round</span>(median_qty_tons, <span class="dv">2</span>)), </span>
<span id="cb57-36"><a href="#cb57-36" aria-hidden="true" tabindex="-1"></a>           <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">hjust =</span> <span class="fl">1.3</span>, <span class="at">color =</span> <span class="st">"blue"</span>)</span>
<span id="cb57-37"><a href="#cb57-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-38"><a href="#cb57-38" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> boxplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(cargo_nodes, <span class="fu">aes</span>(<span class="at">y =</span> qty_tons)) <span class="sc">+</span></span>
<span id="cb57-39"><a href="#cb57-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">"skyblue"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb57-40"><a href="#cb57-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span>  <span class="co"># Flip coordinates to make it horizontal</span></span>
<span id="cb57-41"><a href="#cb57-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Boxplot of Quantity of Tons"</span>,</span>
<span id="cb57-42"><a href="#cb57-42" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">""</span>,</span>
<span id="cb57-43"><a href="#cb57-43" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Quantity of Tons"</span>) <span class="sc">+</span></span>
<span id="cb57-44"><a href="#cb57-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb57-45"><a href="#cb57-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-46"><a href="#cb57-46" aria-hidden="true" tabindex="-1"></a>p1<span class="sc">/</span>p2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Insights from this visualisation
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>There are cargoes which has negative values. This is abnormal as all cargoes qty_tons values should be at least zero .</p></li>
<li><p>There are a number of outliers cargoes with qty_tons above ~70 tons.</p></li>
</ul>
</div>
</div>
<p><strong>Cargoes Quantity Ton by Date and City</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Aggregate import record data</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>import_record_agg <span class="ot">&lt;-</span> import_record <span class="sc">%&gt;%</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">year</span>(cargo_delivery_date),</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">month =</span> <span class="fu">factor</span>(<span class="fu">month</span>(cargo_delivery_date, <span class="at">label =</span> <span class="cn">TRUE</span>), <span class="at">levels =</span> month.abb), <span class="co"># Ensure month is a factor</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">day =</span> <span class="fu">day</span>(cargo_delivery_date),</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">week =</span> <span class="fu">week</span>(cargo_delivery_date),</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">weekday =</span> <span class="fu">wday</span>(cargo_delivery_date, <span class="at">label =</span> <span class="cn">TRUE</span>, <span class="at">week_start =</span> <span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(city, year, month) <span class="sc">%&gt;%</span>  <span class="co"># Group by city, year, and month</span></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">total_qty_tons =</span> <span class="fu">sum</span>(qty_tons, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(city, year, month)</span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Create heatmap</span></span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(import_record_agg, </span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> month, </span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> city, </span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a>           <span class="at">fill =</span> total_qty_tons)) <span class="sc">+</span> </span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"white"</span>, </span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span>  </span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>() <span class="sc">+</span></span>
<span id="cb58-20"><a href="#cb58-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">name =</span> <span class="st">"Cargo Quantity Ton by Month"</span>,</span>
<span id="cb58-21"><a href="#cb58-21" aria-hidden="true" tabindex="-1"></a>                      <span class="at">low =</span> <span class="st">"sky blue"</span>, </span>
<span id="cb58-22"><a href="#cb58-22" aria-hidden="true" tabindex="-1"></a>                      <span class="at">high =</span> <span class="st">"dark blue"</span>) <span class="sc">+</span></span>
<span id="cb58-23"><a href="#cb58-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, </span>
<span id="cb58-24"><a href="#cb58-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="cn">NULL</span>, </span>
<span id="cb58-25"><a href="#cb58-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Cargo Quantity Ton by Month"</span>) <span class="sc">+</span></span>
<span id="cb58-26"><a href="#cb58-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb58-27"><a href="#cb58-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb58-28"><a href="#cb58-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb58-29"><a href="#cb58-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb58-30"><a href="#cb58-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">6</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Insights from this visualisation
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>Higher qty_tons of cargoes enters the various cities from Aug to Nov period.</p></li>
<li><p>Qty_tons peak in Oct and Nov period, expecially for City of Paackland.</p></li>
</ul>
</div>
</div>
</section>
<section id="understanding-the-vessels" class="level3">
<h3 class="anchored" data-anchor-id="understanding-the-vessels">1.6.7 Understanding the Vessels</h3>
<p><strong>Types of vessels</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Vessel count and reorder bar plot</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>vessel_count <span class="ot">&lt;-</span> vessel_nodes <span class="sc">%&gt;%</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(type) <span class="sc">%&gt;%</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type =</span> <span class="fu">reorder</span>(type, <span class="sc">-</span>n))</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Bar plot</span></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(vessel_count,</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> type,</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> n)) <span class="sc">+</span></span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> n), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Length by Tonnage</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(vessel_nodes, <span class="at">class=</span> <span class="st">"compact"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-82c17732184ebb5902af" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-82c17732184ebb5902af">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251","252","253","254","255","256","257","258","259","260","261","262","263","264","265","266","267","268","269","270","271","272","273","274","275","276","277","278","279","280","281","282","283","284","285","286","287","288","289","290","291","292","293","294","295","296"],["wavewranglerc2d","yellowfintunataker08b","webigailba7","arcticgraylingangler094","anchovyassaulterb1c","oceanreaper44a","herringharpooner843","halibuthunterd84","brooktroutbuccaneerc0b","venerable89c","groupergrabber60d","welscatfishwrangler6ae","skipjacktunatakerf85","seawaysavvy9847","pacificcodcapturer81c","bluefishbandit8ec","maritimemaelstromc5d","europeanperchpirated9b","whitefishwrangler7df","sturdyd7f","longfintunalooterf32","plaicepirate8c6","pikeplunderer0ca","albacoreangler47d","pikepirate89a","flatheadcatfishfindera51","burbotbandit7bf","clamclaimer13d","neptunesnete8c","shrimpshooter91c","aquaticangler5c3","blackbullheadbandit801","turbottakerd86","seaswindler255","atlanticbluemarlinmarauder0b4","laketroutlooter534","dolphindasher004","oceanicoracle9da","stout369","tidetamerbe1","mackerelmarauder2d4","grasspickerelgangster7d1","harborharmonyfc9","barracudabaiter8b3","nauticalnomada36","wavewarrior5d7","cargocatalyst39a7","bluemarlinbandit292","longnosesuckerseeker6ab","halibuthero9b9","marinemarauder8c9","yellowperchpiratec59","inquisitive8c0","pompanoplunderere5d","herringhunter30b","musselmaster8d8","speckledtroutsaboteur509","swordfishswindler37b","sharkshooterd66","marlinmaster8ab","mackerelmariner70c","pollockpirate212","perchpursuer982","rainbowtroutraider4d0","vesselvertexa2e","skipjacktunaseeker76c","haddockhawkb7c","catchcruisera94","bigeyetunabuccaneera16","codfather685","cohosalmoncapturera7b","largemouthbasslooterf95","snappersnatcher7be","malta8cc","hooklinesinkera2d","redfinpickerelraider744","tigermuskellungemaster012","sockeyesalmonseekerb95","trouttracker43b","atlanticcodcatcherca6","fishtracker03e","flukefinder28d","chumsalmoncatcher41e","saltyskippera9e","perchplundererbc0","stripedbassseeker80c","gurnardgrabberd9a","dewie961","swordfishsaboteur22f","whitingwrangler842","vesselventuredfa","carpcatcher3f4","himarkroyal032","mrray9c4","whelkwrangler9ac","manatee17ea","hewey2ef","tenchtaker595","pinksalmonpirate2a3","seasentinel1c4b","maritimematrix7755","maritimemajesticeb7","bluecatfishcatcher468","carpcapturer993","goldfishgrabber270","soleseeker47a","whitefishwhisperer6df","cutthroattroutcatchere2b","haddockhunter1a7","seawaysavvy102","brinebuccaneer9fd","redfishraider677","roachraider7ce","europeaneelenthusiastf9f","chainpickerelplunderer039","marinersmate8ee","snooksnatcherbdb","squidsquad7fd","baitedbreath538","blueharbor2c1","goldentroutgrabber7f6","yellowbullheadbuccaneer968","tunatrawlerafd","cargocentric4d0","ladyfishlooter7ea","deepseadrifter9f2","seahunter56b","freightfrontiers1bc","honorablea6e","bluegillbandita5f","eelenthusiast8c6","costasmeraldaac7","clownfishe3d","maritimemomentumfab","seaserpent4b4","walleyewranglerda0","louietheii3e0","eelensnarerd3a","harborhelios585","bigeyetunabanditb73","lobsterlooterd41","shipmatrix9b4","oysteropener442","cargocatalystb02","channelcatfishcapturer175","trawlertriumph31f","spanishmackerelmaster037","bonefishbaiter565","kingfisher87d","tunataker80c","tarpontaker6cd","fishfinderb9d","kingfishcapturerbe7","wahoowrangler016","zanderzealotb23","mackerelmaster0a5","ruddraiderced","sailfishseeker8d5","transatlantic77d","bluefintunabandit177","respectable717","seabassbandit9ad","spiritofoceanus404","barracudabandit836","codcatcher04c","europeanseabassbuccaneer777","squidsquasherda9","bassbandit0d5","cobiacapturere5e","flounderfinderd64","salmonseeker630","northernpikepirated97","sailfishswindlerb4f","muskellungemastere7c","seasirenf43","steelheadstalkera87","clamcatcherfb3","brillbandit0a1","huron1b3","fishflingere29","muskellungemarauder78c","crappiecapturer875","freightfrequency5f65","plaiceplundererba1","albacoreassaulter482","seabreamseekerd8b","wahoowarriord42","musselmaraudere9b","americaneelenthusiastcfa","mahimahimaster04f","brownbullheadbriganded2","bassbaiterb9f","sardineseeker62e","blackdrumbanditc5b","graylinggrabber802","browntroutbandite67","kingsalmonking5b4","salmonsnatcher19d","amberjackassaulterd52","breambanditc85","oceanoracle1d0","whitesuckerwrangler0b3","swimmingsafely92d","vesselvictory3738","oceanicoasis15f6","harborhalo9dd6","transpacificed8","freightfirm27f","catfishcapturer7a8","opheliacac","aquaticpursuitf31","whitemarlinwranglerbac","tautogtaker867","seawayspectra490","cargocircuit26cc","crabcatcher1aa","louieda4","weakfishwranglerd3c","roachrobberdb6","oceanicoasisd3f","posiedonsparadise7e6","prawnpredator5d7","seasovereignc6e","oceanicodyssey11207","freightfortef0d","nauticalnetworks865","whitemarlinmasterfa1","maritimemiraclef85","vesselvanguardbf2","seasystem375","seasanctuary505","seasystem3e22","athenad34","freightforte6f28","vesselvistad0c","nauticalnirvana874","oceanoptimum9f4","maritimemomentum8d12","transpolar2a4","maritimemover13f","transoceane48","maritimemastersd93","seasphere38e","transatlantic47a9","cargocircuit545","seawayservicesc71","harborhalo603","oceanicodyssey5dd","nauticalnimbusa99","harborhavenf91","maritimematrix51a","vesselventure46e5","nauticalnexus1a5d","freightfrontiers7134","transglobal266","seasentry2e28","cargocosmoscde","oceanicline3de","oceanicoverturec58","harborhorizon6c6","transcontinentalcf3","freightfrequencyfea","harborholdings797","seawaysurgeb1c","harborhorizon10ecb","cargocrestb7c","freightflux254","nauticalnexus6cc","oceanicoracle2bf2","transglobal607c","vesselventuresc7e","freightfusion141","nauticalnucleusc5a","freightfountaind90","cargocynosure29d","vesselvanguard5d06","cargocentric443e","vesselvortex355","vesselvictoryafd","aquatransit6bc","harborhelix456","seasolutions4d5","seawaysynergybaf","seawaysynergy8489","transpacific5ada","seasentry1d3","nauticalnomad11356","bulkcarriers6cd","seasentinel24e","nauticalnavigatorabd","seawayspectrumca2","oceanicomnipotenta4a","heartofoceanusf11","seawaysage5ce","nauticalnucleus107c4","maritimemagnitude2e9"],["Wave Wrangler","Yellowfin Tuna Taker","Webigail","Arctic Grayling Angler","Anchovy Assaulter","Ocean Reaper","Herring Harpooner","Halibut Hunter","Brook Trout Buccaneer","Venerable","Grouper Grabber","Wels Catfish Wrangler","Skipjack Tuna Taker","Seaway Savvy 9","Pacific Cod Capturer","Bluefish Bandit","Maritime Maelstrom","European Perch Pirate","Whitefish Wrangler","Sturdy","Longfin Tuna Looter","Plaice Pirate","Pike Plunderer","Albacore Angler","Pike Pirate","Flathead Catfish Finder","Burbot Bandit","Clam Claimer","Neptune's Net","Shrimp Shooter","Aquatic Angler","Black Bullhead Bandit","Turbot Taker","Sea Swindler","Atlantic Blue Marlin Marauder","Lake Trout Looter","Dolphin Dasher","Oceanic Oracle","Stout","Tide Tamer","Mackerel Marauder","Grass Pickerel Gangster","Harbor Harmony","Barracuda Baiter","Nautical Nomad","Wave Warrior","Cargo Catalyst 3","Blue Marlin Bandit","Longnose Sucker Seeker","Halibut Hero","Marine Marauder","Yellow Perch Pirate","Inquisitive","Pompano Plunderer","Herring Hunter","Mussel Master","Speckled Trout Saboteur","Swordfish Swindler","Shark Shooter","Marlin Master","Mackerel Mariner","Pollock Pirate","Perch Pursuer","Rainbow Trout Raider","Vessel Vertex","Skipjack Tuna Seeker","Haddock Hawk","Catch Cruiser","Bigeye Tuna Buccaneer","Codfather","Coho Salmon Capturer","Largemouth Bass Looter","Snapper Snatcher","Malta","Hook, Line &amp; Sinker","Redfin Pickerel Raider","Tiger Muskellunge Master","Sockeye Salmon Seeker","Trout Tracker","Atlantic Cod Catcher","Fish Tracker","Fluke Finder","Chum Salmon Catcher","Salty Skipper","Perch Plunderer","Striped Bass Seeker","Gurnard Grabber","Dewie","Swordfish Saboteur","Whiting Wrangler","Vessel Venture","Carp Catcher","Himark Royal","Mr. Ray","Whelk Wrangler","Manatee 1","Hewey","Tench Taker","Pink Salmon Pirate","Sea Sentinel 1","Maritime Matrix 7","Maritime Majestic","Blue Catfish Catcher","Carp Capturer","Goldfish Grabber","Sole Seeker","Whitefish Whisperer","Cutthroat Trout Catcher","Haddock Hunter","Seaway Savvy","Brine Buccaneer","Redfish Raider","Roach Raider","European Eel Enthusiast","Chain Pickerel Plunderer","Mariner's Mate","Snook Snatcher","Squid Squad","Baited Breath","Blue Harbor","Golden Trout Grabber","Yellow Bullhead Buccaneer","Tuna Trawler","Cargo Centric","Ladyfish Looter","Deepsea Drifter","Sea Hunter","Freight Frontiers","Honorable","Bluegill Bandit","Eel Enthusiast","Costa Smeralda","Clown Fish","Maritime Momentum","Sea Serpent","Walleye Wrangler","Louie the II","Eel Ensnarer","Harbor Helios","Bigeye Tuna Bandit","Lobster Looter","Ship Matrix","Oyster Opener","Cargo Catalyst","Channel Catfish Capturer","Trawler Triumph","Spanish Mackerel Master","Bonefish Baiter","Kingfisher","Tuna Taker","Tarpon Taker","Fish Finder","Kingfish Capturer","Wahoo Wrangler","Zander Zealot","Mackerel Master","Rudd Raider","Sailfish Seeker","Trans Atlantic","Bluefin Tuna Bandit","Respectable","Sea Bass Bandit","Spirit of Oceanus","Barracuda Bandit","Cod Catcher","European Seabass Buccaneer","Squid Squasher","Bass Bandit","Cobia Capturer","Flounder Finder","Salmon Seeker","Northern Pike Pirate","Sailfish Swindler","Muskellunge Master","Sea Siren","Steelhead Stalker","Clam Catcher","Brill Bandit","Huron","Fish Flinger","Muskellunge Marauder","Crappie Capturer","Freight Frequency 5","Plaice Plunderer","Albacore Assaulter","Seabream Seeker","Wahoo Warrior","Mussel Marauder","American Eel Enthusiast","Mahi-Mahi Master","Brown Bullhead Brigand","Bass Baiter","Sardine Seeker","Black Drum Bandit","Grayling Grabber","Brown Trout Bandit","King Salmon King","Salmon Snatcher","Amberjack Assaulter","Bream Bandit","Ocean Oracle","White Sucker Wrangler","Swimming Safely","Vessel Victory 3","Oceanic Oasis 1","Harbor Halo 9","Trans Pacific","Freight Firm","Catfish Capturer","Ophelia","Aquatic Pursuit","White Marlin Wrangler","Tautog Taker","Seaway Spectra","Cargo Circuit 2","Crab Catcher","Louie","Weakfish Wrangler","Roach Robber","Oceanic Oasis","Posiedon's Paradise","Prawn Predator","Sea Sovereign","Oceanic Odyssey 11","Freight Forte","Nautical Networks","White Marlin Master","Maritime Miracle","Vessel Vanguard","Sea System","Sea Sanctuary","Sea System 3","Athena","Freight Forte 6","Vessel Vista","Nautical Nirvana","Ocean Optimum","Maritime Momentum 8","Trans Polar","Maritime Mover","Trans Ocean","Maritime Masters","Sea Sphere","Trans Atlantic 4","Cargo Circuit","Seaway Services","Harbor Halo","Oceanic Odyssey","Nautical Nimbus","Harbor Haven","Maritime Matrix","Vessel Venture 4","Nautical Nexus 1","Freight Frontiers 7","Trans Global","Sea Sentry 2","Cargo Cosmos","Oceanic Line","Oceanic Overture","Harbor Horizon","Trans Continental","Freight Frequency","Harbor Holdings","Seaway Surge","Harbor Horizon 10","Cargo Crest","Freight Flux","Nautical Nexus","Oceanic Oracle 2","Trans Global 6","Vessel Ventures","Freight Fusion","Nautical Nucleus","Freight Fountain","Cargo Cynosure","Vessel Vanguard 5","Cargo Centric 4","Vessel Vortex","Vessel Victory","Aqua Transit","Harbor Helix","Sea Solutions","Seaway Synergy","Seaway Synergy 8","Trans Pacific 5","Sea Sentry","Nautical Nomad 11","Bulk Carriers","Sea Sentinel","Nautical Navigator","Seaway Spectrum","Oceanic Omnipotent","Heart of Oceanus","Seaway Sage","Nautical Nucleus 10","Maritime Magnitude"],["Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Osterivaro","Oceanus","Oceanus","Helvoris","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Helixia","Oceanus","Oceanus","Oceanus","Ariuzima","Oceanus","Oceanus","Oceanus","Oceanus","Alverovia","Oceanus","Oceanterra","Oceanus","Ariuzima","Islavaragon","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Wysterion","Oceanus","Oceanus","Oceanus","Kondarica","Oceanus","Oceanus","Oceanus","Uziland","Uzifrica","Oceanus","Oceanus","Oceanus","Calabrand","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Solterrix","Oceanus","Kethilim","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Faraluna","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Kondanovia","Oceanus","Anderia del Mar","Alverossia","Merigrad","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Uzifrica","Oceanus","Oceanus","Icarnia","Oceanus","Oceanus","Oceanus","Alverossia","Oceanus","Oceanus","Mawalara","Oceanus","Oceanus","Oceanus","Lumindoria","Oceanus","Oceanus","Arvekalia","Brindivaria","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Playa Solis","Oceanus","Oceanus","Oceanus","Oceanus","Lumakari","Oceanus","Oceanus","Khamseena","Oceanus","Nyxonix","Oceanus","Oceanus","Oceanus","Nalakond","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Afarivaria","Lumindoria","Oceanus","Luminkind","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Osterivaro","Oceanus","Lumindoria","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Kondarica","Utoporiana","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Arvaros","Oceanus","Oceanus","Oceanus","Merigrad","Utoparadia","Calabrand","Valtalmo","Playa Solis","Oceanus","Oceanus","Syrithania","Oceanus","Oceanus","Oceanus","Kethanor","Oceanus","Oceanus","Oceanus","Oceanus","Brindisola","Oceanus","Oceanus","Gavanovia","Isla Solmar","Valtalmo","Baziuzim","Oceanus","Coralmarica","Orvietola","Thessalandia","Playa Solis","Kethanor","Oceanus","Novarctica","Anderia del Mar","Rio Solovia","Marebak","Novarcticaa","Vientoro","Orvietola","Yggdrasonia","Zawalinda","Orvietola","Talandria","Utoparadia","Rio Solovia","Helixia","Vesperlandia","Helixia","Mawalara","Helixia","Novarcticaa","Riodelsol","Azurionix","Faraluna","Kuzalanda","Coralada","Ariuzima","Uzifrica","Islavaria","Isla Solmar","Utoparadia","Riodelsol","Coralada","Novarctica","Imazam","Mango del Oro","Utoporiana","Myriadonia","Thessalandia","Nyxonix","Solovarossa","Valtalmo","Nyxonix","Islavaria","Khamseena","Playa Solis","Marifada","Nalaloria","Korvelonia","Kondarivakia","Nyxonix","Puerto del Mar","Azurionix","Arreciviento","Uziland","Zambarka","Sirenareef","Alverossia","Kilivaria","Kethanor","Playa Solis","Oceanus","Coralada","Zawalinda","Gavanovia"],["Roth, Logan and Moreno","Brown-Haas",null,"Smith, Davis and Acosta","Cisneros-Meyer","FlounderLeska Marine BV","House Group","Weaver-Baker","Stewart, Perkins and Sanchez",null,"ScaniaSeafood Holdings Ltd. Liability Co","Mccormick Group","Parks Ltd",null,"Taylor-Sawyer","Parks Ltd",null,"Nielsen, Valentine and Bell","Jacobson Inc",null,"House Group","Ballard-Bailey","Steele PLC","WestRiver Shipping KgaA","Robinson, Mcmillan and Watson","Lowery-Myers","Robinson, Mcmillan and Watson","Dyer-Campbell","Adkins LLC","BaringoAmerica Marine Ges.m.b.H.","Terry, Smith and Lyons","Schmidt Ltd","Brown-Haas","Mccormick Group","Ritter Ltd","Ritter Ltd","Decker PLC",null,null,"Faulkner, Shaffer and Moyer","Brown-Allen","Bell, Reynolds and Forbes",null,"French Ltd","Saltwater Sisters Company Marine","Rivera Group",null,"Bowers Group","MonarchCreek Shipping S.p.A.","Mendez-Tyler","Nielsen, Valentine and Bell","Dyer-Campbell",null,"Ballard-Bailey","Mooney, Stevenson and Miller","Garcia-Wallace","Cox-Mason","Mendez-Tyler","Garcia-Sanchez","Bell, Reynolds and Forbes","Sutton PLC","Nielsen, Valentine and Bell","Rasmussen, Nelson and King","Cisneros-Meyer",null,"Cisneros-Meyer","Garcia-Sanchez","Brown, Clarke and Martinez","Gomez-Mccormick","Solis-Lopez","Faulkner, Shaffer and Moyer","Solis-Lopez","SouthSeafood Express Corp","Clark, Hall and Cole","Cox-Donovan","Solis PLC","Newton-Meyer","Mcpherson-Wright","Cordova, Ritter and Flores","Miller, Smith and Reed","Barnes and Sons","Gomez-Mccormick","Mooney, Stevenson and Miller","Weaver-Baker","Bennett, Jones and Miller","Mercado, French and Graham","Schmidt Ltd",null,"Brewer-Massey","Norman LLC",null,"Wiley LLC",null,null,"WestRiver Shipping KgaA",null,null,"Davis, Harris and West","Ritter Ltd",null,null,null,"Goodman LLC","Reid, Thomas and Gill","Henry-Alvarez","Mccormick Group","Lane Group","Smith, Collins and Johnson","Solis-Lopez",null,"Bennett, Jones and Miller","House Group","Franco, Olson and Long","Dry CreekWorldLogistics Ltd. Liability Co","Rodriguez, Henry and Woodard","Decker PLC","Solis-Lopez","Thompson-Padilla","Faulkner, Shaffer and Moyer",null,"Carter, Mcdonald and Miller","Franco, Olson and Long","Williams, Horn and Morales",null,"Smith, Collins and Johnson","Garcia-Wallace","Steele PLC",null,null,"Lane Group","Sutton PLC","Garcia-Sanchez",null,null,"Smith, Collins and Johnson","Callahan-Green",null,"Green, Vincent and Thompson",null,"Lake Malawi  Corp United","Wolf and Sons",null,"Hernandez Group",null,"Lowery-Myers","Terry, Smith and Lyons","Ritter Ltd","Garcia-Wallace","Horne Group","Fischer, Graham and Robinson","Terry, Smith and Lyons","Carter, Mcdonald and Miller","Rodriguez, Henry and Woodard","Bell, Reynolds and Forbes","Mercado, French and Graham","Chavez and Sons","Maacama Ocean Worldwide LLC","Jordan and Sons",null,"Clark, Hall and Cole",null,"Mccormick Group",null,"Smith, Davis and Acosta","Martin-Case","Murphy and Sons","Brown-Haas","Collins, Johnson and Lloyd","Chavez and Sons","Sparmans Marine Carriers Oyj","Thompson-Padilla","Brown-Allen","Mullins-Carrillo","Jordan and Sons","Bowers Group","Chavez and Sons","Green, Vincent and Thompson","Mcpherson-Wright","Riley Inc","Robinson, Mcmillan and Watson","Ritter Ltd","Brown, Clarke and Martinez",null,"NortheastSeafood Carriers Ltd","Solis PLC","Mullins-Carrillo","Chambers, Hall and Walker","Osborne and Sons","Conley, Benton and Miller","Taylor-Sawyer","Jacobson Inc","Saltwater Sisters Company Marine","Costa de Oro Enterprises","Bailey-Mccullough","Nielsen, Valentine and Bell","Ballard-Bailey","Chase, Long and Anderson","Vasquez-Gonzalez","Williams, Horn and Morales","Murphy and Sons","Harper and Sons","Robinson, Mcmillan and Watson","Tainamarine Fishing Co",null,null,null,null,null,"Ritter Ltd","Mcdonald-Jones","George-Brown","Callahan-Green","Costa de Oro Enterprises",null,null,"SamakaDredgeTransport OJSC",null,"Gomez-Mccormick","SouthSeafood Express Corp",null,"Tainamarine Fishing Co","Cordova, Ritter and Flores",null,null,null,null,"Mendez-Tyler",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[700,4500,null,1500,400,300,7400,100,6500,null,600,10800,7100,2100,200,2800,76300,700,2100,null,4900,400,3800,800,14400,2100,6700,5200,11500,1300,3900,500,600,4500,3900,4900,5700,2300,null,600,300,11800,71000,100,14300,6300,29200,200,300,1800,17200,3100,null,400,2400,2200,9400,4000,4500,7800,4200,2100,11400,4900,76300,800,1100,100,300,1700,100,200,100,200,3200,900,5100,6600,2400,6200,3800,1200,2300,4400,600,3300,300,null,11100,800,7900,1700,null,null,7100,null,null,3900,200,76300,38800,3800,7800,100,4200,6200,3600,100,1500,36800,5600,1900,300,6300,800,400,4300,200,700,75700,2500,2800,300,2100,800,900,10600,41300,null,3900,2500,600,null,76300,3500,4400,null,10400,2100,11100,800,2100,3000,76000,3900,5000,2400,9100,400,1700,400,100,2900,300,2100,4100,1400,1300,2200,4100,null,6000,null,1200,300,10300,4200,600,10500,1400,200,3800,4000,4400,700,4700,700,2400,11700,700,2900,1700,2100,4400,600,3600,5300,500,3400,2600,200,1100,2200,11800,300,4900,10300,3000,300,3500,8900,600,100,76300,76300,2100,70900,2100,1400,1400,7600,500,1900,74700,21700,3600,null,12100,11700,2100,11700,100,2100,2100,76300,2100,800,4800,2100,45600,3400,2200,null,2300,12800,2100,9400,8100,11600,2100,33800,72400,62300,76300,30700,25300,2100,76300,2100,6200,2100,71500,2600,35100,2100,2100,2100,13900,75600,76300,2100,73700,76300,35900,63200,2100,68100,75900,76200,76300,76300,22200,49500,76300,45300,2100,2100,72800,66500,76300,2100,2100,76300,2100,60600,19200,76300,74000,76300,76000,2600,76300,null,2100,2100,2100],[110,110,50,80,60,50,130,10,90,null,70,120,110,90,40,90,230,50,60,null,80,70,120,50,160,100,70,100,150,30,40,60,70,110,50,100,90,90,null,30,20,120,150,40,90,150,120,50,30,60,180,90,null,60,90,70,100,90,70,120,80,90,140,90,230,30,50,30,30,110,10,40,20,40,110,80,90,90,90,80,90,50,50,80,70,90,80,75,110,90,210,110,null,null,110,null,75,60,30,230,120,90,120,10,140,80,70,10,70,190,70,130,50,150,50,30,110,60,110,130,60,70,60,90,20,50,120,100,null,50,80,80,null,220,110,130,75,150,110,110,60,110,80,210,60,80,90,130,10,30,50,10,110,20,40,90,70,70,100,110,null,110,null,50,50,130,90,70,90,60,10,120,40,110,60,160,60,90,130,60,80,50,90,130,70,110,70,20,100,60,60,70,70,120,70,100,130,140,20,60,150,30,20,230,230,90,230,180,60,60,130,20,120,230,200,100,75,140,130,130,130,10,90,90,230,90,90,110,90,230,150,210,null,100,160,210,110,220,150,140,90,220,160,230,220,100,90,230,180,90,150,230,210,100,130,150,90,220,170,230,90,220,230,130,140,90,120,200,230,210,230,190,210,230,220,110,90,220,170,220,120,130,230,120,130,100,230,200,200,230,100,210,null,100,100,90],["FishingVessel","FishingVessel","Other","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","Ferry_Passenger","FishingVessel","FishingVessel","FishingVessel","CargoVessel","FishingVessel","FishingVessel","CargoVessel","FishingVessel","FishingVessel","Ferry_Cargo","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","CargoVessel","Ferry","FishingVessel","FishingVessel","FishingVessel","CargoVessel","FishingVessel","CargoVessel","FishingVessel","CargoVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","Research","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","CargoVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","Other","FishingVessel","FishingVessel","CargoVessel","FishingVessel","Tour","Tour","FishingVessel","Tour","Other","FishingVessel","FishingVessel","CargoVessel","CargoVessel","CargoVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","CargoVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","CargoVessel","FishingVessel","FishingVessel","FishingVessel","CargoVessel","FishingVessel","FishingVessel","FishingVessel","CargoVessel","Ferry_Passenger","FishingVessel","FishingVessel","FishingVessel","Tour","CargoVessel","FishingVessel","FishingVessel","Other","Ferry_Cargo","CargoVessel","FishingVessel","FishingVessel","CargoVessel","FishingVessel","CargoVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","CargoVessel","FishingVessel","Ferry_Passenger","FishingVessel","Tour","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","CargoVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","CargoVessel","CargoVessel","FishingVessel","Other","FishingVessel","FishingVessel","CargoVessel","FishingVessel","FishingVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","FishingVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","Research","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","Tour","CargoVessel","CargoVessel","CargoVessel"]],"container":"<table class=\"compact\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>vessel<\/th>\n      <th>vessel_name<\/th>\n      <th>flag_country<\/th>\n      <th>company<\/th>\n      <th>tonnage<\/th>\n      <th>length_overall<\/th>\n      <th>type<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[5,6]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"vessel","targets":1},{"name":"vessel_name","targets":2},{"name":"flag_country","targets":3},{"name":"company","targets":4},{"name":"tonnage","targets":5},{"name":"length_overall","targets":6},{"name":"type","targets":7}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">highlight_key</span>(vessel_nodes)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter plot</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(d) <span class="sc">+</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> length_overall,</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y =</span> tonnage,</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> type))</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>gg <span class="ot">&lt;-</span> <span class="fu">highlight</span>(<span class="fu">ggplotly</span>(p),</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>                <span class="st">"plotly_selected"</span>)</span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>crosstalk<span class="sc">::</span><span class="fu">bscols</span>(gg,               </span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>                  DT<span class="sc">::</span><span class="fu">datatable</span>(d), </span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>                  <span class="at">widths =</span> <span class="dv">5</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="container-fluid crosstalk-bscols">
<div class="row">
<div class="col-xs-5">
<div class="plotly html-widget html-fill-item" id="htmlwidget-0eea024ca3040dc0457b" style="width:100%;height:400px;"></div>
<script type="application/json" data-for="htmlwidget-0eea024ca3040dc0457b">{"x":{"data":[{"x":[90,230,90,150,90,120,230,210,230,120,90,190,130,90,100,220,110,110,210,100,90,230,230,90,230,180,230,200,130,90,90,230,90,110,90,230,150,210,100,160,210,110,220,150,140,90,220,160,230,220,100,90,230,180,90,150,230,210,100,130,150,90,220,170,230,90,220,230,130,140,90,120,200,230,210,230,190,210,230,220,110,90,220,170,220,120,130,230,120,130,100,230,200,200,230,100,210,100,100,90],"y":[2100,76300,2300,71000,14300,29200,76300,7900,76300,38800,3800,36800,75700,2100,41300,76300,2100,2100,76000,2200,2100,76300,76300,2100,70900,2100,74700,21700,2100,2100,2100,76300,2100,4800,2100,45600,3400,2200,2300,12800,2100,9400,8100,11600,2100,33800,72400,62300,76300,30700,25300,2100,76300,2100,6200,2100,71500,2600,35100,2100,2100,2100,13900,75600,76300,2100,73700,76300,35900,63200,2100,68100,75900,76200,76300,76300,22200,49500,76300,45300,2100,2100,72800,66500,76300,2100,2100,76300,2100,60600,19200,76300,74000,76300,76000,2600,76300,2100,2100,2100],"text":["length_overall:  90<br />tonnage:  2100<br />type: CargoVessel","length_overall: 230<br />tonnage: 76300<br />type: CargoVessel","length_overall:  90<br />tonnage:  2300<br />type: CargoVessel","length_overall: 150<br />tonnage: 71000<br />type: CargoVessel","length_overall:  90<br />tonnage: 14300<br />type: CargoVessel","length_overall: 120<br />tonnage: 29200<br />type: CargoVessel","length_overall: 230<br />tonnage: 76300<br />type: CargoVessel","length_overall: 210<br />tonnage:  7900<br />type: CargoVessel","length_overall: 230<br />tonnage: 76300<br />type: CargoVessel","length_overall: 120<br />tonnage: 38800<br />type: CargoVessel","length_overall:  90<br />tonnage:  3800<br />type: CargoVessel","length_overall: 190<br />tonnage: 36800<br />type: CargoVessel","length_overall: 130<br />tonnage: 75700<br />type: CargoVessel","length_overall:  90<br />tonnage:  2100<br />type: CargoVessel","length_overall: 100<br />tonnage: 41300<br />type: CargoVessel","length_overall: 220<br />tonnage: 76300<br />type: CargoVessel","length_overall: 110<br />tonnage:  2100<br />type: CargoVessel","length_overall: 110<br />tonnage:  2100<br />type: CargoVessel","length_overall: 210<br />tonnage: 76000<br />type: CargoVessel","length_overall: 100<br />tonnage:  2200<br />type: CargoVessel","length_overall:  90<br />tonnage:  2100<br />type: CargoVessel","length_overall: 230<br />tonnage: 76300<br />type: CargoVessel","length_overall: 230<br />tonnage: 76300<br />type: CargoVessel","length_overall:  90<br />tonnage:  2100<br />type: CargoVessel","length_overall: 230<br />tonnage: 70900<br />type: CargoVessel","length_overall: 180<br />tonnage:  2100<br />type: CargoVessel","length_overall: 230<br />tonnage: 74700<br />type: CargoVessel","length_overall: 200<br />tonnage: 21700<br />type: CargoVessel","length_overall: 130<br />tonnage:  2100<br />type: CargoVessel","length_overall:  90<br />tonnage:  2100<br />type: CargoVessel","length_overall:  90<br />tonnage:  2100<br />type: CargoVessel","length_overall: 230<br />tonnage: 76300<br />type: CargoVessel","length_overall:  90<br />tonnage:  2100<br />type: CargoVessel","length_overall: 110<br />tonnage:  4800<br />type: CargoVessel","length_overall:  90<br />tonnage:  2100<br />type: CargoVessel","length_overall: 230<br />tonnage: 45600<br />type: CargoVessel","length_overall: 150<br />tonnage:  3400<br />type: CargoVessel","length_overall: 210<br />tonnage:  2200<br />type: CargoVessel","length_overall: 100<br />tonnage:  2300<br />type: CargoVessel","length_overall: 160<br />tonnage: 12800<br />type: CargoVessel","length_overall: 210<br />tonnage:  2100<br />type: CargoVessel","length_overall: 110<br />tonnage:  9400<br />type: CargoVessel","length_overall: 220<br />tonnage:  8100<br />type: CargoVessel","length_overall: 150<br />tonnage: 11600<br />type: CargoVessel","length_overall: 140<br />tonnage:  2100<br />type: CargoVessel","length_overall:  90<br />tonnage: 33800<br />type: CargoVessel","length_overall: 220<br />tonnage: 72400<br />type: CargoVessel","length_overall: 160<br />tonnage: 62300<br />type: CargoVessel","length_overall: 230<br />tonnage: 76300<br />type: CargoVessel","length_overall: 220<br />tonnage: 30700<br />type: CargoVessel","length_overall: 100<br />tonnage: 25300<br />type: CargoVessel","length_overall:  90<br />tonnage:  2100<br />type: CargoVessel","length_overall: 230<br />tonnage: 76300<br />type: CargoVessel","length_overall: 180<br />tonnage:  2100<br />type: CargoVessel","length_overall:  90<br />tonnage:  6200<br />type: CargoVessel","length_overall: 150<br />tonnage:  2100<br />type: CargoVessel","length_overall: 230<br />tonnage: 71500<br />type: CargoVessel","length_overall: 210<br />tonnage:  2600<br />type: CargoVessel","length_overall: 100<br />tonnage: 35100<br />type: CargoVessel","length_overall: 130<br />tonnage:  2100<br />type: CargoVessel","length_overall: 150<br />tonnage:  2100<br />type: CargoVessel","length_overall:  90<br />tonnage:  2100<br />type: CargoVessel","length_overall: 220<br />tonnage: 13900<br />type: CargoVessel","length_overall: 170<br />tonnage: 75600<br />type: CargoVessel","length_overall: 230<br />tonnage: 76300<br />type: CargoVessel","length_overall:  90<br />tonnage:  2100<br />type: CargoVessel","length_overall: 220<br />tonnage: 73700<br />type: CargoVessel","length_overall: 230<br />tonnage: 76300<br />type: CargoVessel","length_overall: 130<br />tonnage: 35900<br />type: CargoVessel","length_overall: 140<br />tonnage: 63200<br />type: CargoVessel","length_overall:  90<br />tonnage:  2100<br />type: CargoVessel","length_overall: 120<br />tonnage: 68100<br />type: CargoVessel","length_overall: 200<br />tonnage: 75900<br />type: CargoVessel","length_overall: 230<br />tonnage: 76200<br />type: CargoVessel","length_overall: 210<br />tonnage: 76300<br />type: CargoVessel","length_overall: 230<br />tonnage: 76300<br />type: CargoVessel","length_overall: 190<br />tonnage: 22200<br />type: CargoVessel","length_overall: 210<br />tonnage: 49500<br />type: CargoVessel","length_overall: 230<br />tonnage: 76300<br />type: CargoVessel","length_overall: 220<br />tonnage: 45300<br />type: CargoVessel","length_overall: 110<br />tonnage:  2100<br />type: CargoVessel","length_overall:  90<br />tonnage:  2100<br />type: CargoVessel","length_overall: 220<br />tonnage: 72800<br />type: CargoVessel","length_overall: 170<br />tonnage: 66500<br />type: CargoVessel","length_overall: 220<br />tonnage: 76300<br />type: CargoVessel","length_overall: 120<br />tonnage:  2100<br />type: CargoVessel","length_overall: 130<br />tonnage:  2100<br />type: CargoVessel","length_overall: 230<br />tonnage: 76300<br />type: CargoVessel","length_overall: 120<br />tonnage:  2100<br />type: CargoVessel","length_overall: 130<br />tonnage: 60600<br />type: CargoVessel","length_overall: 100<br />tonnage: 19200<br />type: CargoVessel","length_overall: 230<br />tonnage: 76300<br />type: CargoVessel","length_overall: 200<br />tonnage: 74000<br />type: CargoVessel","length_overall: 200<br />tonnage: 76300<br />type: CargoVessel","length_overall: 230<br />tonnage: 76000<br />type: CargoVessel","length_overall: 100<br />tonnage:  2600<br />type: CargoVessel","length_overall: 210<br />tonnage: 76300<br />type: CargoVessel","length_overall: 100<br />tonnage:  2100<br />type: CargoVessel","length_overall: 100<br />tonnage:  2100<br />type: CargoVessel","length_overall:  90<br />tonnage:  2100<br />type: CargoVessel"],"key":["14","17","38","43","45","47","65","91","100","101","102","110","120","124","128","134","139","142","144","159","183","204","205","206","207","208","214","215","220","223","224","225","226","228","229","230","231","232","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251","252","253","254","255","256","257","258","259","260","261","262","263","264","265","266","267","268","269","270","271","272","273","274","275","276","277","278","279","280","281","282","283","284","285","286","287","288","289","290","291","292","294","295","296"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(248,118,109,1)","opacity":1,"size":5.6692913385826778,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(248,118,109,1)"}},"hoveron":"points","set":"SharedData82c17732","name":"CargoVessel","legendgroup":"CargoVessel","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","_isNestedKey":false,"frame":null},{"x":[null],"y":[null],"text":"length_overall:  NA<br />tonnage:    NA<br />type: Ferry","key":["39"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(205,150,0,1)","opacity":1,"size":5.6692913385826778,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(205,150,0,1)"}},"hoveron":"points","set":"SharedData82c17732","name":"Ferry","legendgroup":"Ferry","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","_isSimpleKey":true,"_isNestedKey":false,"frame":null},{"x":[null,150],"y":[null,10400],"text":["length_overall:  NA<br />tonnage:    NA<br />type: Ferry_Cargo","length_overall: 150<br />tonnage: 10400<br />type: Ferry_Cargo"],"key":["20","138"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(124,174,0,1)","opacity":1,"size":5.6692913385826778,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(124,174,0,1)"}},"hoveron":"points","set":"SharedData82c17732","name":"Ferry_Cargo","legendgroup":"Ferry_Cargo","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","_isNestedKey":false,"frame":null},{"x":[null,null,null],"y":[null,null,null],"text":"length_overall:  NA<br />tonnage:    NA<br />type: Ferry_Passenger","key":["10","129","161"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,190,103,1)","opacity":1,"size":5.6692913385826778,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(0,190,103,1)"}},"hoveron":"points","set":"SharedData82c17732","name":"Ferry_Passenger","legendgroup":"Ferry_Passenger","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","_isNestedKey":false,"frame":null},{"x":[110,110,80,60,50,130,10,90,70,120,110,40,90,50,60,80,70,120,50,160,100,70,100,150,30,40,60,70,110,50,100,90,30,20,120,40,150,50,30,60,180,90,60,90,70,100,90,70,120,80,90,140,90,30,50,30,30,110,10,40,20,40,110,80,90,90,90,80,90,50,50,80,70,90,80,110,90,110,110,60,30,120,10,140,80,70,10,70,70,130,50,150,50,30,110,60,110,60,70,60,20,50,120,50,80,80,110,130,110,60,80,60,80,90,130,10,30,50,10,110,20,40,90,70,70,110,110,50,50,130,90,70,90,60,10,120,40,110,60,160,60,90,130,60,80,50,130,70,110,70,20,100,60,60,70,70,120,70,100,130,140,20,60,150,30,20,60,60,130,20,120,100,140,130,130,10,90],"y":[700,4500,1500,400,300,7400,100,6500,600,10800,7100,200,2800,700,2100,4900,400,3800,800,14400,2100,6700,5200,11500,1300,3900,500,600,4500,3900,4900,5700,600,300,11800,100,6300,200,300,1800,17200,3100,400,2400,2200,9400,4000,4500,7800,4200,2100,11400,4900,800,1100,100,300,1700,100,200,100,200,3200,900,5100,6600,2400,6200,3800,1200,2300,4400,600,3300,300,11100,800,1700,7100,3900,200,7800,100,4200,6200,3600,100,1500,5600,1900,300,6300,800,400,4300,200,700,2500,2800,300,800,900,10600,3900,2500,600,3500,4400,11100,800,3000,3900,5000,2400,9100,400,1700,400,100,2900,300,2100,4100,1400,1300,4100,6000,1200,300,10300,4200,600,10500,1400,200,3800,4000,4400,700,4700,700,2400,11700,700,2900,1700,4400,600,3600,5300,500,3400,2600,200,1100,2200,11800,300,4900,10300,3000,300,3500,8900,600,100,1400,1400,7600,500,1900,3600,12100,11700,11700,100,800],"text":["length_overall: 110<br />tonnage:   700<br />type: FishingVessel","length_overall: 110<br />tonnage:  4500<br />type: FishingVessel","length_overall:  80<br />tonnage:  1500<br />type: FishingVessel","length_overall:  60<br />tonnage:   400<br />type: FishingVessel","length_overall:  50<br />tonnage:   300<br />type: FishingVessel","length_overall: 130<br />tonnage:  7400<br />type: FishingVessel","length_overall:  10<br />tonnage:   100<br />type: FishingVessel","length_overall:  90<br />tonnage:  6500<br />type: FishingVessel","length_overall:  70<br />tonnage:   600<br />type: FishingVessel","length_overall: 120<br />tonnage: 10800<br />type: FishingVessel","length_overall: 110<br />tonnage:  7100<br />type: FishingVessel","length_overall:  40<br />tonnage:   200<br />type: FishingVessel","length_overall:  90<br />tonnage:  2800<br />type: FishingVessel","length_overall:  50<br />tonnage:   700<br />type: FishingVessel","length_overall:  60<br />tonnage:  2100<br />type: FishingVessel","length_overall:  80<br />tonnage:  4900<br />type: FishingVessel","length_overall:  70<br />tonnage:   400<br />type: FishingVessel","length_overall: 120<br />tonnage:  3800<br />type: FishingVessel","length_overall:  50<br />tonnage:   800<br />type: FishingVessel","length_overall: 160<br />tonnage: 14400<br />type: FishingVessel","length_overall: 100<br />tonnage:  2100<br />type: FishingVessel","length_overall:  70<br />tonnage:  6700<br />type: FishingVessel","length_overall: 100<br />tonnage:  5200<br />type: FishingVessel","length_overall: 150<br />tonnage: 11500<br />type: FishingVessel","length_overall:  30<br />tonnage:  1300<br />type: FishingVessel","length_overall:  40<br />tonnage:  3900<br />type: FishingVessel","length_overall:  60<br />tonnage:   500<br />type: FishingVessel","length_overall:  70<br />tonnage:   600<br />type: FishingVessel","length_overall: 110<br />tonnage:  4500<br />type: FishingVessel","length_overall:  50<br />tonnage:  3900<br />type: FishingVessel","length_overall: 100<br />tonnage:  4900<br />type: FishingVessel","length_overall:  90<br />tonnage:  5700<br />type: FishingVessel","length_overall:  30<br />tonnage:   600<br />type: FishingVessel","length_overall:  20<br />tonnage:   300<br />type: FishingVessel","length_overall: 120<br />tonnage: 11800<br />type: FishingVessel","length_overall:  40<br />tonnage:   100<br />type: FishingVessel","length_overall: 150<br />tonnage:  6300<br />type: FishingVessel","length_overall:  50<br />tonnage:   200<br />type: FishingVessel","length_overall:  30<br />tonnage:   300<br />type: FishingVessel","length_overall:  60<br />tonnage:  1800<br />type: FishingVessel","length_overall: 180<br />tonnage: 17200<br />type: FishingVessel","length_overall:  90<br />tonnage:  3100<br />type: FishingVessel","length_overall:  60<br />tonnage:   400<br />type: FishingVessel","length_overall:  90<br />tonnage:  2400<br />type: FishingVessel","length_overall:  70<br />tonnage:  2200<br />type: FishingVessel","length_overall: 100<br />tonnage:  9400<br />type: FishingVessel","length_overall:  90<br />tonnage:  4000<br />type: FishingVessel","length_overall:  70<br />tonnage:  4500<br />type: FishingVessel","length_overall: 120<br />tonnage:  7800<br />type: FishingVessel","length_overall:  80<br />tonnage:  4200<br />type: FishingVessel","length_overall:  90<br />tonnage:  2100<br />type: FishingVessel","length_overall: 140<br />tonnage: 11400<br />type: FishingVessel","length_overall:  90<br />tonnage:  4900<br />type: FishingVessel","length_overall:  30<br />tonnage:   800<br />type: FishingVessel","length_overall:  50<br />tonnage:  1100<br />type: FishingVessel","length_overall:  30<br />tonnage:   100<br />type: FishingVessel","length_overall:  30<br />tonnage:   300<br />type: FishingVessel","length_overall: 110<br />tonnage:  1700<br />type: FishingVessel","length_overall:  10<br />tonnage:   100<br />type: FishingVessel","length_overall:  40<br />tonnage:   200<br />type: FishingVessel","length_overall:  20<br />tonnage:   100<br />type: FishingVessel","length_overall:  40<br />tonnage:   200<br />type: FishingVessel","length_overall: 110<br />tonnage:  3200<br />type: FishingVessel","length_overall:  80<br />tonnage:   900<br />type: FishingVessel","length_overall:  90<br />tonnage:  5100<br />type: FishingVessel","length_overall:  90<br />tonnage:  6600<br />type: FishingVessel","length_overall:  90<br />tonnage:  2400<br />type: FishingVessel","length_overall:  80<br />tonnage:  6200<br />type: FishingVessel","length_overall:  90<br />tonnage:  3800<br />type: FishingVessel","length_overall:  50<br />tonnage:  1200<br />type: FishingVessel","length_overall:  50<br />tonnage:  2300<br />type: FishingVessel","length_overall:  80<br />tonnage:  4400<br />type: FishingVessel","length_overall:  70<br />tonnage:   600<br />type: FishingVessel","length_overall:  90<br />tonnage:  3300<br />type: FishingVessel","length_overall:  80<br />tonnage:   300<br />type: FishingVessel","length_overall: 110<br />tonnage: 11100<br />type: FishingVessel","length_overall:  90<br />tonnage:   800<br />type: FishingVessel","length_overall: 110<br />tonnage:  1700<br />type: FishingVessel","length_overall: 110<br />tonnage:  7100<br />type: FishingVessel","length_overall:  60<br />tonnage:  3900<br />type: FishingVessel","length_overall:  30<br />tonnage:   200<br />type: FishingVessel","length_overall: 120<br />tonnage:  7800<br />type: FishingVessel","length_overall:  10<br />tonnage:   100<br />type: FishingVessel","length_overall: 140<br />tonnage:  4200<br />type: FishingVessel","length_overall:  80<br />tonnage:  6200<br />type: FishingVessel","length_overall:  70<br />tonnage:  3600<br />type: FishingVessel","length_overall:  10<br />tonnage:   100<br />type: FishingVessel","length_overall:  70<br />tonnage:  1500<br />type: FishingVessel","length_overall:  70<br />tonnage:  5600<br />type: FishingVessel","length_overall: 130<br />tonnage:  1900<br />type: FishingVessel","length_overall:  50<br />tonnage:   300<br />type: FishingVessel","length_overall: 150<br />tonnage:  6300<br />type: FishingVessel","length_overall:  50<br />tonnage:   800<br />type: FishingVessel","length_overall:  30<br />tonnage:   400<br />type: FishingVessel","length_overall: 110<br />tonnage:  4300<br />type: FishingVessel","length_overall:  60<br />tonnage:   200<br />type: FishingVessel","length_overall: 110<br />tonnage:   700<br />type: FishingVessel","length_overall:  60<br />tonnage:  2500<br />type: FishingVessel","length_overall:  70<br />tonnage:  2800<br />type: FishingVessel","length_overall:  60<br />tonnage:   300<br />type: FishingVessel","length_overall:  20<br />tonnage:   800<br />type: FishingVessel","length_overall:  50<br />tonnage:   900<br />type: FishingVessel","length_overall: 120<br />tonnage: 10600<br />type: FishingVessel","length_overall:  50<br />tonnage:  3900<br />type: FishingVessel","length_overall:  80<br />tonnage:  2500<br />type: FishingVessel","length_overall:  80<br />tonnage:   600<br />type: FishingVessel","length_overall: 110<br />tonnage:  3500<br />type: FishingVessel","length_overall: 130<br />tonnage:  4400<br />type: FishingVessel","length_overall: 110<br />tonnage: 11100<br />type: FishingVessel","length_overall:  60<br />tonnage:   800<br />type: FishingVessel","length_overall:  80<br />tonnage:  3000<br />type: FishingVessel","length_overall:  60<br />tonnage:  3900<br />type: FishingVessel","length_overall:  80<br />tonnage:  5000<br />type: FishingVessel","length_overall:  90<br />tonnage:  2400<br />type: FishingVessel","length_overall: 130<br />tonnage:  9100<br />type: FishingVessel","length_overall:  10<br />tonnage:   400<br />type: FishingVessel","length_overall:  30<br />tonnage:  1700<br />type: FishingVessel","length_overall:  50<br />tonnage:   400<br />type: FishingVessel","length_overall:  10<br />tonnage:   100<br />type: FishingVessel","length_overall: 110<br />tonnage:  2900<br />type: FishingVessel","length_overall:  20<br />tonnage:   300<br />type: FishingVessel","length_overall:  40<br />tonnage:  2100<br />type: FishingVessel","length_overall:  90<br />tonnage:  4100<br />type: FishingVessel","length_overall:  70<br />tonnage:  1400<br />type: FishingVessel","length_overall:  70<br />tonnage:  1300<br />type: FishingVessel","length_overall: 110<br />tonnage:  4100<br />type: FishingVessel","length_overall: 110<br />tonnage:  6000<br />type: FishingVessel","length_overall:  50<br />tonnage:  1200<br />type: FishingVessel","length_overall:  50<br />tonnage:   300<br />type: FishingVessel","length_overall: 130<br />tonnage: 10300<br />type: FishingVessel","length_overall:  90<br />tonnage:  4200<br />type: FishingVessel","length_overall:  70<br />tonnage:   600<br />type: FishingVessel","length_overall:  90<br />tonnage: 10500<br />type: FishingVessel","length_overall:  60<br />tonnage:  1400<br />type: FishingVessel","length_overall:  10<br />tonnage:   200<br />type: FishingVessel","length_overall: 120<br />tonnage:  3800<br />type: FishingVessel","length_overall:  40<br />tonnage:  4000<br />type: FishingVessel","length_overall: 110<br />tonnage:  4400<br />type: FishingVessel","length_overall:  60<br />tonnage:   700<br />type: FishingVessel","length_overall: 160<br />tonnage:  4700<br />type: FishingVessel","length_overall:  60<br />tonnage:   700<br />type: FishingVessel","length_overall:  90<br />tonnage:  2400<br />type: FishingVessel","length_overall: 130<br />tonnage: 11700<br />type: FishingVessel","length_overall:  60<br />tonnage:   700<br />type: FishingVessel","length_overall:  80<br />tonnage:  2900<br />type: FishingVessel","length_overall:  50<br />tonnage:  1700<br />type: FishingVessel","length_overall: 130<br />tonnage:  4400<br />type: FishingVessel","length_overall:  70<br />tonnage:   600<br />type: FishingVessel","length_overall: 110<br />tonnage:  3600<br />type: FishingVessel","length_overall:  70<br />tonnage:  5300<br />type: FishingVessel","length_overall:  20<br />tonnage:   500<br />type: FishingVessel","length_overall: 100<br />tonnage:  3400<br />type: FishingVessel","length_overall:  60<br />tonnage:  2600<br />type: FishingVessel","length_overall:  60<br />tonnage:   200<br />type: FishingVessel","length_overall:  70<br />tonnage:  1100<br />type: FishingVessel","length_overall:  70<br />tonnage:  2200<br />type: FishingVessel","length_overall: 120<br />tonnage: 11800<br />type: FishingVessel","length_overall:  70<br />tonnage:   300<br />type: FishingVessel","length_overall: 100<br />tonnage:  4900<br />type: FishingVessel","length_overall: 130<br />tonnage: 10300<br />type: FishingVessel","length_overall: 140<br />tonnage:  3000<br />type: FishingVessel","length_overall:  20<br />tonnage:   300<br />type: FishingVessel","length_overall:  60<br />tonnage:  3500<br />type: FishingVessel","length_overall: 150<br />tonnage:  8900<br />type: FishingVessel","length_overall:  30<br />tonnage:   600<br />type: FishingVessel","length_overall:  20<br />tonnage:   100<br />type: FishingVessel","length_overall:  60<br />tonnage:  1400<br />type: FishingVessel","length_overall:  60<br />tonnage:  1400<br />type: FishingVessel","length_overall: 130<br />tonnage:  7600<br />type: FishingVessel","length_overall:  20<br />tonnage:   500<br />type: FishingVessel","length_overall: 120<br />tonnage:  1900<br />type: FishingVessel","length_overall: 100<br />tonnage:  3600<br />type: FishingVessel","length_overall: 140<br />tonnage: 12100<br />type: FishingVessel","length_overall: 130<br />tonnage: 11700<br />type: FishingVessel","length_overall: 130<br />tonnage: 11700<br />type: FishingVessel","length_overall:  10<br />tonnage:   100<br />type: FishingVessel","length_overall:  90<br />tonnage:   800<br />type: FishingVessel"],"key":["1","2","4","5","6","7","8","9","11","12","13","15","16","18","19","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","40","41","42","44","46","48","49","50","51","52","54","55","56","57","58","59","60","61","62","63","64","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","89","90","92","95","98","99","103","104","105","106","107","108","109","111","112","113","114","115","116","117","118","119","121","122","123","125","126","127","130","131","132","135","136","140","141","143","145","146","147","148","149","150","151","152","153","154","155","156","157","158","160","162","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","209","210","211","212","213","216","218","219","221","222","227"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,191,196,1)","opacity":1,"size":5.6692913385826778,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(0,191,196,1)"}},"hoveron":"points","set":"SharedData82c17732","name":"FishingVessel","legendgroup":"FishingVessel","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","_isNestedKey":false,"frame":null},{"x":[50,75,75,75,75],"y":[null,null,null,null,null],"text":["length_overall:  50<br />tonnage:    NA<br />type: Other","length_overall:  75<br />tonnage:    NA<br />type: Other","length_overall:  75<br />tonnage:    NA<br />type: Other","length_overall:  75<br />tonnage:    NA<br />type: Other","length_overall:  75<br />tonnage:    NA<br />type: Other"],"key":["3","88","97","137","217"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,169,255,1)","opacity":1,"size":5.6692913385826778,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(0,169,255,1)"}},"hoveron":"points","set":"SharedData82c17732","name":"Other","legendgroup":"Other","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","_isNestedKey":false,"frame":null},{"x":[null,null],"y":[null,null],"text":"length_overall:  NA<br />tonnage:    NA<br />type: Research","key":["53","233"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(199,124,255,1)","opacity":1,"size":5.6692913385826778,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(199,124,255,1)"}},"hoveron":"points","set":"SharedData82c17732","name":"Research","legendgroup":"Research","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","_isNestedKey":false,"frame":null},{"x":[null,null,null,null,null,null],"y":[null,null,null,null,null,null],"text":"length_overall:  NA<br />tonnage:    NA<br />type: Tour","key":["93","94","96","133","163","293"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(255,97,204,1)","opacity":1,"size":5.6692913385826778,"symbol":"circle","line":{"width":1.8897637795275593,"color":"rgba(255,97,204,1)"}},"hoveron":"points","set":"SharedData82c17732","name":"Tour","legendgroup":"Tour","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","_isNestedKey":false,"frame":null}],"layout":{"margin":{"t":37.917808219178085,"r":7.3059360730593621,"b":51.872146118721474,"l":54.794520547945211},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-1,241],"tickmode":"array","ticktext":["0","50","100","150","200"],"tickvals":[0,50,100,150,200],"categoryorder":"array","categoryarray":["0","50","100","150","200"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"y","title":{"text":"length_overall","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-3710,80110],"tickmode":"array","ticktext":["0","20000","40000","60000","80000"],"tickvals":[0,20000,40000,60000,80000],"categoryorder":"array","categoryarray":["0","20000","40000","60000","80000"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.6529680365296811,"tickwidth":0.66417600664176002,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176002,"zeroline":false,"anchor":"x","title":{"text":"tonnage","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498},"title":{"text":"type","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}}},"hovermode":"closest","barmode":"relative","dragmode":"select"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"e7c6d172d73":{"x":{},"y":{},"colour":{},"type":"scatter"}},"cur_data":"e7c6d172d73","visdat":{"e7c6d172d73":["function (y) ","x"]},"highlight":{"on":"plotly_selected","off":"plotly_deselect","persistent":false,"dynamic":false,"color":null,"selectize":false,"defaultValues":null,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0,"ctGroups":["SharedData82c17732"]},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div class="col-xs-5">
<div class="datatables html-widget html-fill-item" id="htmlwidget-031ad469cdd1323d38a2" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-031ad469cdd1323d38a2">{"x":{"crosstalkOptions":{"key":["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251","252","253","254","255","256","257","258","259","260","261","262","263","264","265","266","267","268","269","270","271","272","273","274","275","276","277","278","279","280","281","282","283","284","285","286","287","288","289","290","291","292","293","294","295","296"],"group":"SharedData82c17732"},"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251","252","253","254","255","256","257","258","259","260","261","262","263","264","265","266","267","268","269","270","271","272","273","274","275","276","277","278","279","280","281","282","283","284","285","286","287","288","289","290","291","292","293","294","295","296"],["wavewranglerc2d","yellowfintunataker08b","webigailba7","arcticgraylingangler094","anchovyassaulterb1c","oceanreaper44a","herringharpooner843","halibuthunterd84","brooktroutbuccaneerc0b","venerable89c","groupergrabber60d","welscatfishwrangler6ae","skipjacktunatakerf85","seawaysavvy9847","pacificcodcapturer81c","bluefishbandit8ec","maritimemaelstromc5d","europeanperchpirated9b","whitefishwrangler7df","sturdyd7f","longfintunalooterf32","plaicepirate8c6","pikeplunderer0ca","albacoreangler47d","pikepirate89a","flatheadcatfishfindera51","burbotbandit7bf","clamclaimer13d","neptunesnete8c","shrimpshooter91c","aquaticangler5c3","blackbullheadbandit801","turbottakerd86","seaswindler255","atlanticbluemarlinmarauder0b4","laketroutlooter534","dolphindasher004","oceanicoracle9da","stout369","tidetamerbe1","mackerelmarauder2d4","grasspickerelgangster7d1","harborharmonyfc9","barracudabaiter8b3","nauticalnomada36","wavewarrior5d7","cargocatalyst39a7","bluemarlinbandit292","longnosesuckerseeker6ab","halibuthero9b9","marinemarauder8c9","yellowperchpiratec59","inquisitive8c0","pompanoplunderere5d","herringhunter30b","musselmaster8d8","speckledtroutsaboteur509","swordfishswindler37b","sharkshooterd66","marlinmaster8ab","mackerelmariner70c","pollockpirate212","perchpursuer982","rainbowtroutraider4d0","vesselvertexa2e","skipjacktunaseeker76c","haddockhawkb7c","catchcruisera94","bigeyetunabuccaneera16","codfather685","cohosalmoncapturera7b","largemouthbasslooterf95","snappersnatcher7be","malta8cc","hooklinesinkera2d","redfinpickerelraider744","tigermuskellungemaster012","sockeyesalmonseekerb95","trouttracker43b","atlanticcodcatcherca6","fishtracker03e","flukefinder28d","chumsalmoncatcher41e","saltyskippera9e","perchplundererbc0","stripedbassseeker80c","gurnardgrabberd9a","dewie961","swordfishsaboteur22f","whitingwrangler842","vesselventuredfa","carpcatcher3f4","himarkroyal032","mrray9c4","whelkwrangler9ac","manatee17ea","hewey2ef","tenchtaker595","pinksalmonpirate2a3","seasentinel1c4b","maritimematrix7755","maritimemajesticeb7","bluecatfishcatcher468","carpcapturer993","goldfishgrabber270","soleseeker47a","whitefishwhisperer6df","cutthroattroutcatchere2b","haddockhunter1a7","seawaysavvy102","brinebuccaneer9fd","redfishraider677","roachraider7ce","europeaneelenthusiastf9f","chainpickerelplunderer039","marinersmate8ee","snooksnatcherbdb","squidsquad7fd","baitedbreath538","blueharbor2c1","goldentroutgrabber7f6","yellowbullheadbuccaneer968","tunatrawlerafd","cargocentric4d0","ladyfishlooter7ea","deepseadrifter9f2","seahunter56b","freightfrontiers1bc","honorablea6e","bluegillbandita5f","eelenthusiast8c6","costasmeraldaac7","clownfishe3d","maritimemomentumfab","seaserpent4b4","walleyewranglerda0","louietheii3e0","eelensnarerd3a","harborhelios585","bigeyetunabanditb73","lobsterlooterd41","shipmatrix9b4","oysteropener442","cargocatalystb02","channelcatfishcapturer175","trawlertriumph31f","spanishmackerelmaster037","bonefishbaiter565","kingfisher87d","tunataker80c","tarpontaker6cd","fishfinderb9d","kingfishcapturerbe7","wahoowrangler016","zanderzealotb23","mackerelmaster0a5","ruddraiderced","sailfishseeker8d5","transatlantic77d","bluefintunabandit177","respectable717","seabassbandit9ad","spiritofoceanus404","barracudabandit836","codcatcher04c","europeanseabassbuccaneer777","squidsquasherda9","bassbandit0d5","cobiacapturere5e","flounderfinderd64","salmonseeker630","northernpikepirated97","sailfishswindlerb4f","muskellungemastere7c","seasirenf43","steelheadstalkera87","clamcatcherfb3","brillbandit0a1","huron1b3","fishflingere29","muskellungemarauder78c","crappiecapturer875","freightfrequency5f65","plaiceplundererba1","albacoreassaulter482","seabreamseekerd8b","wahoowarriord42","musselmaraudere9b","americaneelenthusiastcfa","mahimahimaster04f","brownbullheadbriganded2","bassbaiterb9f","sardineseeker62e","blackdrumbanditc5b","graylinggrabber802","browntroutbandite67","kingsalmonking5b4","salmonsnatcher19d","amberjackassaulterd52","breambanditc85","oceanoracle1d0","whitesuckerwrangler0b3","swimmingsafely92d","vesselvictory3738","oceanicoasis15f6","harborhalo9dd6","transpacificed8","freightfirm27f","catfishcapturer7a8","opheliacac","aquaticpursuitf31","whitemarlinwranglerbac","tautogtaker867","seawayspectra490","cargocircuit26cc","crabcatcher1aa","louieda4","weakfishwranglerd3c","roachrobberdb6","oceanicoasisd3f","posiedonsparadise7e6","prawnpredator5d7","seasovereignc6e","oceanicodyssey11207","freightfortef0d","nauticalnetworks865","whitemarlinmasterfa1","maritimemiraclef85","vesselvanguardbf2","seasystem375","seasanctuary505","seasystem3e22","athenad34","freightforte6f28","vesselvistad0c","nauticalnirvana874","oceanoptimum9f4","maritimemomentum8d12","transpolar2a4","maritimemover13f","transoceane48","maritimemastersd93","seasphere38e","transatlantic47a9","cargocircuit545","seawayservicesc71","harborhalo603","oceanicodyssey5dd","nauticalnimbusa99","harborhavenf91","maritimematrix51a","vesselventure46e5","nauticalnexus1a5d","freightfrontiers7134","transglobal266","seasentry2e28","cargocosmoscde","oceanicline3de","oceanicoverturec58","harborhorizon6c6","transcontinentalcf3","freightfrequencyfea","harborholdings797","seawaysurgeb1c","harborhorizon10ecb","cargocrestb7c","freightflux254","nauticalnexus6cc","oceanicoracle2bf2","transglobal607c","vesselventuresc7e","freightfusion141","nauticalnucleusc5a","freightfountaind90","cargocynosure29d","vesselvanguard5d06","cargocentric443e","vesselvortex355","vesselvictoryafd","aquatransit6bc","harborhelix456","seasolutions4d5","seawaysynergybaf","seawaysynergy8489","transpacific5ada","seasentry1d3","nauticalnomad11356","bulkcarriers6cd","seasentinel24e","nauticalnavigatorabd","seawayspectrumca2","oceanicomnipotenta4a","heartofoceanusf11","seawaysage5ce","nauticalnucleus107c4","maritimemagnitude2e9"],["Wave Wrangler","Yellowfin Tuna Taker","Webigail","Arctic Grayling Angler","Anchovy Assaulter","Ocean Reaper","Herring Harpooner","Halibut Hunter","Brook Trout Buccaneer","Venerable","Grouper Grabber","Wels Catfish Wrangler","Skipjack Tuna Taker","Seaway Savvy 9","Pacific Cod Capturer","Bluefish Bandit","Maritime Maelstrom","European Perch Pirate","Whitefish Wrangler","Sturdy","Longfin Tuna Looter","Plaice Pirate","Pike Plunderer","Albacore Angler","Pike Pirate","Flathead Catfish Finder","Burbot Bandit","Clam Claimer","Neptune's Net","Shrimp Shooter","Aquatic Angler","Black Bullhead Bandit","Turbot Taker","Sea Swindler","Atlantic Blue Marlin Marauder","Lake Trout Looter","Dolphin Dasher","Oceanic Oracle","Stout","Tide Tamer","Mackerel Marauder","Grass Pickerel Gangster","Harbor Harmony","Barracuda Baiter","Nautical Nomad","Wave Warrior","Cargo Catalyst 3","Blue Marlin Bandit","Longnose Sucker Seeker","Halibut Hero","Marine Marauder","Yellow Perch Pirate","Inquisitive","Pompano Plunderer","Herring Hunter","Mussel Master","Speckled Trout Saboteur","Swordfish Swindler","Shark Shooter","Marlin Master","Mackerel Mariner","Pollock Pirate","Perch Pursuer","Rainbow Trout Raider","Vessel Vertex","Skipjack Tuna Seeker","Haddock Hawk","Catch Cruiser","Bigeye Tuna Buccaneer","Codfather","Coho Salmon Capturer","Largemouth Bass Looter","Snapper Snatcher","Malta","Hook, Line &amp; Sinker","Redfin Pickerel Raider","Tiger Muskellunge Master","Sockeye Salmon Seeker","Trout Tracker","Atlantic Cod Catcher","Fish Tracker","Fluke Finder","Chum Salmon Catcher","Salty Skipper","Perch Plunderer","Striped Bass Seeker","Gurnard Grabber","Dewie","Swordfish Saboteur","Whiting Wrangler","Vessel Venture","Carp Catcher","Himark Royal","Mr. Ray","Whelk Wrangler","Manatee 1","Hewey","Tench Taker","Pink Salmon Pirate","Sea Sentinel 1","Maritime Matrix 7","Maritime Majestic","Blue Catfish Catcher","Carp Capturer","Goldfish Grabber","Sole Seeker","Whitefish Whisperer","Cutthroat Trout Catcher","Haddock Hunter","Seaway Savvy","Brine Buccaneer","Redfish Raider","Roach Raider","European Eel Enthusiast","Chain Pickerel Plunderer","Mariner's Mate","Snook Snatcher","Squid Squad","Baited Breath","Blue Harbor","Golden Trout Grabber","Yellow Bullhead Buccaneer","Tuna Trawler","Cargo Centric","Ladyfish Looter","Deepsea Drifter","Sea Hunter","Freight Frontiers","Honorable","Bluegill Bandit","Eel Enthusiast","Costa Smeralda","Clown Fish","Maritime Momentum","Sea Serpent","Walleye Wrangler","Louie the II","Eel Ensnarer","Harbor Helios","Bigeye Tuna Bandit","Lobster Looter","Ship Matrix","Oyster Opener","Cargo Catalyst","Channel Catfish Capturer","Trawler Triumph","Spanish Mackerel Master","Bonefish Baiter","Kingfisher","Tuna Taker","Tarpon Taker","Fish Finder","Kingfish Capturer","Wahoo Wrangler","Zander Zealot","Mackerel Master","Rudd Raider","Sailfish Seeker","Trans Atlantic","Bluefin Tuna Bandit","Respectable","Sea Bass Bandit","Spirit of Oceanus","Barracuda Bandit","Cod Catcher","European Seabass Buccaneer","Squid Squasher","Bass Bandit","Cobia Capturer","Flounder Finder","Salmon Seeker","Northern Pike Pirate","Sailfish Swindler","Muskellunge Master","Sea Siren","Steelhead Stalker","Clam Catcher","Brill Bandit","Huron","Fish Flinger","Muskellunge Marauder","Crappie Capturer","Freight Frequency 5","Plaice Plunderer","Albacore Assaulter","Seabream Seeker","Wahoo Warrior","Mussel Marauder","American Eel Enthusiast","Mahi-Mahi Master","Brown Bullhead Brigand","Bass Baiter","Sardine Seeker","Black Drum Bandit","Grayling Grabber","Brown Trout Bandit","King Salmon King","Salmon Snatcher","Amberjack Assaulter","Bream Bandit","Ocean Oracle","White Sucker Wrangler","Swimming Safely","Vessel Victory 3","Oceanic Oasis 1","Harbor Halo 9","Trans Pacific","Freight Firm","Catfish Capturer","Ophelia","Aquatic Pursuit","White Marlin Wrangler","Tautog Taker","Seaway Spectra","Cargo Circuit 2","Crab Catcher","Louie","Weakfish Wrangler","Roach Robber","Oceanic Oasis","Posiedon's Paradise","Prawn Predator","Sea Sovereign","Oceanic Odyssey 11","Freight Forte","Nautical Networks","White Marlin Master","Maritime Miracle","Vessel Vanguard","Sea System","Sea Sanctuary","Sea System 3","Athena","Freight Forte 6","Vessel Vista","Nautical Nirvana","Ocean Optimum","Maritime Momentum 8","Trans Polar","Maritime Mover","Trans Ocean","Maritime Masters","Sea Sphere","Trans Atlantic 4","Cargo Circuit","Seaway Services","Harbor Halo","Oceanic Odyssey","Nautical Nimbus","Harbor Haven","Maritime Matrix","Vessel Venture 4","Nautical Nexus 1","Freight Frontiers 7","Trans Global","Sea Sentry 2","Cargo Cosmos","Oceanic Line","Oceanic Overture","Harbor Horizon","Trans Continental","Freight Frequency","Harbor Holdings","Seaway Surge","Harbor Horizon 10","Cargo Crest","Freight Flux","Nautical Nexus","Oceanic Oracle 2","Trans Global 6","Vessel Ventures","Freight Fusion","Nautical Nucleus","Freight Fountain","Cargo Cynosure","Vessel Vanguard 5","Cargo Centric 4","Vessel Vortex","Vessel Victory","Aqua Transit","Harbor Helix","Sea Solutions","Seaway Synergy","Seaway Synergy 8","Trans Pacific 5","Sea Sentry","Nautical Nomad 11","Bulk Carriers","Sea Sentinel","Nautical Navigator","Seaway Spectrum","Oceanic Omnipotent","Heart of Oceanus","Seaway Sage","Nautical Nucleus 10","Maritime Magnitude"],["Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Osterivaro","Oceanus","Oceanus","Helvoris","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Helixia","Oceanus","Oceanus","Oceanus","Ariuzima","Oceanus","Oceanus","Oceanus","Oceanus","Alverovia","Oceanus","Oceanterra","Oceanus","Ariuzima","Islavaragon","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Wysterion","Oceanus","Oceanus","Oceanus","Kondarica","Oceanus","Oceanus","Oceanus","Uziland","Uzifrica","Oceanus","Oceanus","Oceanus","Calabrand","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Solterrix","Oceanus","Kethilim","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Faraluna","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Kondanovia","Oceanus","Anderia del Mar","Alverossia","Merigrad","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Uzifrica","Oceanus","Oceanus","Icarnia","Oceanus","Oceanus","Oceanus","Alverossia","Oceanus","Oceanus","Mawalara","Oceanus","Oceanus","Oceanus","Lumindoria","Oceanus","Oceanus","Arvekalia","Brindivaria","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Playa Solis","Oceanus","Oceanus","Oceanus","Oceanus","Lumakari","Oceanus","Oceanus","Khamseena","Oceanus","Nyxonix","Oceanus","Oceanus","Oceanus","Nalakond","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Afarivaria","Lumindoria","Oceanus","Luminkind","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Osterivaro","Oceanus","Lumindoria","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Kondarica","Utoporiana","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Oceanus","Arvaros","Oceanus","Oceanus","Oceanus","Merigrad","Utoparadia","Calabrand","Valtalmo","Playa Solis","Oceanus","Oceanus","Syrithania","Oceanus","Oceanus","Oceanus","Kethanor","Oceanus","Oceanus","Oceanus","Oceanus","Brindisola","Oceanus","Oceanus","Gavanovia","Isla Solmar","Valtalmo","Baziuzim","Oceanus","Coralmarica","Orvietola","Thessalandia","Playa Solis","Kethanor","Oceanus","Novarctica","Anderia del Mar","Rio Solovia","Marebak","Novarcticaa","Vientoro","Orvietola","Yggdrasonia","Zawalinda","Orvietola","Talandria","Utoparadia","Rio Solovia","Helixia","Vesperlandia","Helixia","Mawalara","Helixia","Novarcticaa","Riodelsol","Azurionix","Faraluna","Kuzalanda","Coralada","Ariuzima","Uzifrica","Islavaria","Isla Solmar","Utoparadia","Riodelsol","Coralada","Novarctica","Imazam","Mango del Oro","Utoporiana","Myriadonia","Thessalandia","Nyxonix","Solovarossa","Valtalmo","Nyxonix","Islavaria","Khamseena","Playa Solis","Marifada","Nalaloria","Korvelonia","Kondarivakia","Nyxonix","Puerto del Mar","Azurionix","Arreciviento","Uziland","Zambarka","Sirenareef","Alverossia","Kilivaria","Kethanor","Playa Solis","Oceanus","Coralada","Zawalinda","Gavanovia"],["Roth, Logan and Moreno","Brown-Haas",null,"Smith, Davis and Acosta","Cisneros-Meyer","FlounderLeska Marine BV","House Group","Weaver-Baker","Stewart, Perkins and Sanchez",null,"ScaniaSeafood Holdings Ltd. Liability Co","Mccormick Group","Parks Ltd",null,"Taylor-Sawyer","Parks Ltd",null,"Nielsen, Valentine and Bell","Jacobson Inc",null,"House Group","Ballard-Bailey","Steele PLC","WestRiver Shipping KgaA","Robinson, Mcmillan and Watson","Lowery-Myers","Robinson, Mcmillan and Watson","Dyer-Campbell","Adkins LLC","BaringoAmerica Marine Ges.m.b.H.","Terry, Smith and Lyons","Schmidt Ltd","Brown-Haas","Mccormick Group","Ritter Ltd","Ritter Ltd","Decker PLC",null,null,"Faulkner, Shaffer and Moyer","Brown-Allen","Bell, Reynolds and Forbes",null,"French Ltd","Saltwater Sisters Company Marine","Rivera Group",null,"Bowers Group","MonarchCreek Shipping S.p.A.","Mendez-Tyler","Nielsen, Valentine and Bell","Dyer-Campbell",null,"Ballard-Bailey","Mooney, Stevenson and Miller","Garcia-Wallace","Cox-Mason","Mendez-Tyler","Garcia-Sanchez","Bell, Reynolds and Forbes","Sutton PLC","Nielsen, Valentine and Bell","Rasmussen, Nelson and King","Cisneros-Meyer",null,"Cisneros-Meyer","Garcia-Sanchez","Brown, Clarke and Martinez","Gomez-Mccormick","Solis-Lopez","Faulkner, Shaffer and Moyer","Solis-Lopez","SouthSeafood Express Corp","Clark, Hall and Cole","Cox-Donovan","Solis PLC","Newton-Meyer","Mcpherson-Wright","Cordova, Ritter and Flores","Miller, Smith and Reed","Barnes and Sons","Gomez-Mccormick","Mooney, Stevenson and Miller","Weaver-Baker","Bennett, Jones and Miller","Mercado, French and Graham","Schmidt Ltd",null,"Brewer-Massey","Norman LLC",null,"Wiley LLC",null,null,"WestRiver Shipping KgaA",null,null,"Davis, Harris and West","Ritter Ltd",null,null,null,"Goodman LLC","Reid, Thomas and Gill","Henry-Alvarez","Mccormick Group","Lane Group","Smith, Collins and Johnson","Solis-Lopez",null,"Bennett, Jones and Miller","House Group","Franco, Olson and Long","Dry CreekWorldLogistics Ltd. Liability Co","Rodriguez, Henry and Woodard","Decker PLC","Solis-Lopez","Thompson-Padilla","Faulkner, Shaffer and Moyer",null,"Carter, Mcdonald and Miller","Franco, Olson and Long","Williams, Horn and Morales",null,"Smith, Collins and Johnson","Garcia-Wallace","Steele PLC",null,null,"Lane Group","Sutton PLC","Garcia-Sanchez",null,null,"Smith, Collins and Johnson","Callahan-Green",null,"Green, Vincent and Thompson",null,"Lake Malawi  Corp United","Wolf and Sons",null,"Hernandez Group",null,"Lowery-Myers","Terry, Smith and Lyons","Ritter Ltd","Garcia-Wallace","Horne Group","Fischer, Graham and Robinson","Terry, Smith and Lyons","Carter, Mcdonald and Miller","Rodriguez, Henry and Woodard","Bell, Reynolds and Forbes","Mercado, French and Graham","Chavez and Sons","Maacama Ocean Worldwide LLC","Jordan and Sons",null,"Clark, Hall and Cole",null,"Mccormick Group",null,"Smith, Davis and Acosta","Martin-Case","Murphy and Sons","Brown-Haas","Collins, Johnson and Lloyd","Chavez and Sons","Sparmans Marine Carriers Oyj","Thompson-Padilla","Brown-Allen","Mullins-Carrillo","Jordan and Sons","Bowers Group","Chavez and Sons","Green, Vincent and Thompson","Mcpherson-Wright","Riley Inc","Robinson, Mcmillan and Watson","Ritter Ltd","Brown, Clarke and Martinez",null,"NortheastSeafood Carriers Ltd","Solis PLC","Mullins-Carrillo","Chambers, Hall and Walker","Osborne and Sons","Conley, Benton and Miller","Taylor-Sawyer","Jacobson Inc","Saltwater Sisters Company Marine","Costa de Oro Enterprises","Bailey-Mccullough","Nielsen, Valentine and Bell","Ballard-Bailey","Chase, Long and Anderson","Vasquez-Gonzalez","Williams, Horn and Morales","Murphy and Sons","Harper and Sons","Robinson, Mcmillan and Watson","Tainamarine Fishing Co",null,null,null,null,null,"Ritter Ltd","Mcdonald-Jones","George-Brown","Callahan-Green","Costa de Oro Enterprises",null,null,"SamakaDredgeTransport OJSC",null,"Gomez-Mccormick","SouthSeafood Express Corp",null,"Tainamarine Fishing Co","Cordova, Ritter and Flores",null,null,null,null,"Mendez-Tyler",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[700,4500,null,1500,400,300,7400,100,6500,null,600,10800,7100,2100,200,2800,76300,700,2100,null,4900,400,3800,800,14400,2100,6700,5200,11500,1300,3900,500,600,4500,3900,4900,5700,2300,null,600,300,11800,71000,100,14300,6300,29200,200,300,1800,17200,3100,null,400,2400,2200,9400,4000,4500,7800,4200,2100,11400,4900,76300,800,1100,100,300,1700,100,200,100,200,3200,900,5100,6600,2400,6200,3800,1200,2300,4400,600,3300,300,null,11100,800,7900,1700,null,null,7100,null,null,3900,200,76300,38800,3800,7800,100,4200,6200,3600,100,1500,36800,5600,1900,300,6300,800,400,4300,200,700,75700,2500,2800,300,2100,800,900,10600,41300,null,3900,2500,600,null,76300,3500,4400,null,10400,2100,11100,800,2100,3000,76000,3900,5000,2400,9100,400,1700,400,100,2900,300,2100,4100,1400,1300,2200,4100,null,6000,null,1200,300,10300,4200,600,10500,1400,200,3800,4000,4400,700,4700,700,2400,11700,700,2900,1700,2100,4400,600,3600,5300,500,3400,2600,200,1100,2200,11800,300,4900,10300,3000,300,3500,8900,600,100,76300,76300,2100,70900,2100,1400,1400,7600,500,1900,74700,21700,3600,null,12100,11700,2100,11700,100,2100,2100,76300,2100,800,4800,2100,45600,3400,2200,null,2300,12800,2100,9400,8100,11600,2100,33800,72400,62300,76300,30700,25300,2100,76300,2100,6200,2100,71500,2600,35100,2100,2100,2100,13900,75600,76300,2100,73700,76300,35900,63200,2100,68100,75900,76200,76300,76300,22200,49500,76300,45300,2100,2100,72800,66500,76300,2100,2100,76300,2100,60600,19200,76300,74000,76300,76000,2600,76300,null,2100,2100,2100],[110,110,50,80,60,50,130,10,90,null,70,120,110,90,40,90,230,50,60,null,80,70,120,50,160,100,70,100,150,30,40,60,70,110,50,100,90,90,null,30,20,120,150,40,90,150,120,50,30,60,180,90,null,60,90,70,100,90,70,120,80,90,140,90,230,30,50,30,30,110,10,40,20,40,110,80,90,90,90,80,90,50,50,80,70,90,80,75,110,90,210,110,null,null,110,null,75,60,30,230,120,90,120,10,140,80,70,10,70,190,70,130,50,150,50,30,110,60,110,130,60,70,60,90,20,50,120,100,null,50,80,80,null,220,110,130,75,150,110,110,60,110,80,210,60,80,90,130,10,30,50,10,110,20,40,90,70,70,100,110,null,110,null,50,50,130,90,70,90,60,10,120,40,110,60,160,60,90,130,60,80,50,90,130,70,110,70,20,100,60,60,70,70,120,70,100,130,140,20,60,150,30,20,230,230,90,230,180,60,60,130,20,120,230,200,100,75,140,130,130,130,10,90,90,230,90,90,110,90,230,150,210,null,100,160,210,110,220,150,140,90,220,160,230,220,100,90,230,180,90,150,230,210,100,130,150,90,220,170,230,90,220,230,130,140,90,120,200,230,210,230,190,210,230,220,110,90,220,170,220,120,130,230,120,130,100,230,200,200,230,100,210,null,100,100,90],["FishingVessel","FishingVessel","Other","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","Ferry_Passenger","FishingVessel","FishingVessel","FishingVessel","CargoVessel","FishingVessel","FishingVessel","CargoVessel","FishingVessel","FishingVessel","Ferry_Cargo","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","CargoVessel","Ferry","FishingVessel","FishingVessel","FishingVessel","CargoVessel","FishingVessel","CargoVessel","FishingVessel","CargoVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","Research","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","CargoVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","Other","FishingVessel","FishingVessel","CargoVessel","FishingVessel","Tour","Tour","FishingVessel","Tour","Other","FishingVessel","FishingVessel","CargoVessel","CargoVessel","CargoVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","CargoVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","CargoVessel","FishingVessel","FishingVessel","FishingVessel","CargoVessel","FishingVessel","FishingVessel","FishingVessel","CargoVessel","Ferry_Passenger","FishingVessel","FishingVessel","FishingVessel","Tour","CargoVessel","FishingVessel","FishingVessel","Other","Ferry_Cargo","CargoVessel","FishingVessel","FishingVessel","CargoVessel","FishingVessel","CargoVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","CargoVessel","FishingVessel","Ferry_Passenger","FishingVessel","Tour","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","CargoVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","FishingVessel","CargoVessel","CargoVessel","FishingVessel","Other","FishingVessel","FishingVessel","CargoVessel","FishingVessel","FishingVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","FishingVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","Research","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","CargoVessel","Tour","CargoVessel","CargoVessel","CargoVessel"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>vessel<\/th>\n      <th>vessel_name<\/th>\n      <th>flag_country<\/th>\n      <th>company<\/th>\n      <th>tonnage<\/th>\n      <th>length_overall<\/th>\n      <th>type<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[5,6]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"vessel","targets":1},{"name":"vessel_name","targets":2},{"name":"flag_country","targets":3},{"name":"company","targets":4},{"name":"tonnage","targets":5},{"name":"length_overall","targets":6},{"name":"type","targets":7}],"order":[],"autoWidth":false,"orderClasses":false},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Insights from this visualisation
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>Cargo vessels have wide range of length and tonnage. Only a few data points ( &lt;20), falls within similar range of the fishing vessels.</p></li>
<li><p>The fishing vessels tonnage mostly are &lt;12,000 ton and length_overall of &lt;150m. Only three fishing vessels are above these range.</p></li>
</ul>
</div>
</div>
<p><strong>Tonnage Distribution</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Raincloud Plot for Tonnage Distribution of Fishing and Cargo Vessels</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> vessel_nodes <span class="sc">%&gt;%</span> </span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"FishingVessel"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> tonnage, </span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> type)) <span class="sc">+</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(<span class="at">adjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">justification =</span> <span class="sc">-</span><span class="fl">0.2</span>,</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">.width =</span> <span class="dv">0</span>,</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">point_colour =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> .<span class="dv">20</span>,</span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_dots</span>(<span class="at">side =</span> <span class="st">"left"</span>, </span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">justification =</span> <span class="fl">1.2</span>, </span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">binwidth =</span> <span class="dv">100</span>,</span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">dotsize =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Tonnage Distribution by of Fishing Vessels"</span>) <span class="sc">+</span></span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>)) <span class="sc">+</span></span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-20"><a href="#cb62-20" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> vessel_nodes <span class="sc">%&gt;%</span> </span>
<span id="cb62-21"><a href="#cb62-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"CargoVessel"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb62-22"><a href="#cb62-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> tonnage, </span>
<span id="cb62-23"><a href="#cb62-23" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> type)) <span class="sc">+</span></span>
<span id="cb62-24"><a href="#cb62-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_halfeye</span>(<span class="at">adjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb62-25"><a href="#cb62-25" aria-hidden="true" tabindex="-1"></a>               <span class="at">justification =</span> <span class="sc">-</span><span class="fl">0.2</span>,</span>
<span id="cb62-26"><a href="#cb62-26" aria-hidden="true" tabindex="-1"></a>               <span class="at">.width =</span> <span class="dv">0</span>,</span>
<span id="cb62-27"><a href="#cb62-27" aria-hidden="true" tabindex="-1"></a>               <span class="at">point_colour =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb62-28"><a href="#cb62-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> .<span class="dv">20</span>,</span>
<span id="cb62-29"><a href="#cb62-29" aria-hidden="true" tabindex="-1"></a>               <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb62-30"><a href="#cb62-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_dots</span>(<span class="at">side =</span> <span class="st">"left"</span>, </span>
<span id="cb62-31"><a href="#cb62-31" aria-hidden="true" tabindex="-1"></a>            <span class="at">justification =</span> <span class="fl">1.2</span>, </span>
<span id="cb62-32"><a href="#cb62-32" aria-hidden="true" tabindex="-1"></a>            <span class="at">binwidth =</span> <span class="dv">500</span>,</span>
<span id="cb62-33"><a href="#cb62-33" aria-hidden="true" tabindex="-1"></a>            <span class="at">dotsize =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb62-34"><a href="#cb62-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Tonnage Distribution by of Cargo Vessels"</span>) <span class="sc">+</span></span>
<span id="cb62-35"><a href="#cb62-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>)) <span class="sc">+</span></span>
<span id="cb62-36"><a href="#cb62-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb62-37"><a href="#cb62-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-38"><a href="#cb62-38" aria-hidden="true" tabindex="-1"></a>p1<span class="sc">/</span>p2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Insights from this visualisation
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>Fishing vessels tonnage distribution is right skewed. There is high concentration of fishing vessels of &lt; 1,000 ton.</p></li>
<li><p>Cargo vessels tonnage falls largely into two distinct groups: (1) ~2000 ton, and (2) ~75,000 ton.</p></li>
</ul>
</div>
</div>
<p><strong>Vessel Type and Flag Country</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Bar plot</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(vessel_nodes) <span class="sc">+</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x =</span> flag_country,</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill =</span> type)) <span class="sc">+</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid figure-img" width="1440"></p>
</figure>
</div>
</div>
</div>
<p><strong>Vessels from Oceanus</strong> We now take a more detailed look at Oceanus vessel.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Oceanus vessel count and reorder bar plot</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>vessel_count <span class="ot">&lt;-</span> vessel_nodes <span class="sc">%&gt;%</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(flag_country <span class="sc">==</span> <span class="st">"Oceanus"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(type) <span class="sc">%&gt;%</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">type =</span> <span class="fu">reorder</span>(type, <span class="sc">-</span>n))</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Bar plot</span></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(vessel_count,</span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> type,</span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> n,</span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">fill =</span> type)) <span class="sc">+</span></span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> n), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-51-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Vessels from other flag_country</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Bar plot for flag countries other than Oceanus</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>vessel_nodes <span class="sc">%&gt;%</span> </span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(flag_country <span class="sc">!=</span> <span class="st">"Oceanus"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x =</span> flag_country,</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill =</span> type)) <span class="sc">+</span></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-52-1.png" class="img-fluid figure-img" width="1440"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Bar plot for flag countries other than Oceanus</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>vessel_nodes <span class="sc">%&gt;%</span> </span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(flag_country <span class="sc">!=</span> <span class="st">"Oceanus"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x =</span> flag_country,</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">fill =</span> type)) <span class="sc">+</span></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span>type)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-53-1.png" class="img-fluid figure-img" width="1440"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Insights from these vessels visualisation
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>Most fishing vessels (158 of 178) are registered under flag country of Oceanus.</p></li>
<li><p>Other countries vessels are only cargo vessels (99) and fishing vessels (20).</p></li>
<li><p>Other countries own between 0 to 5 cargo vessels and 0 to 2 fishing vessels.</p></li>
</ul>
</div>
</div>
<p><strong>Vessels by Company</strong></p>
<p>Upon inspecting the vessel_nodes data, we observe that non-Oceanus fishing vessels has registered company information, while non-Oceanus cargo vessels do not have registered company information. To confirm this is true, we remove those company that are “NA” in the bar plot.</p>
<p><img src="images/clipboard-651628543.png" class="img-fluid"></p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Checking the hypothesis that non-Oceanus cargo vessels are not registered as company in the data</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>vessel_nodes <span class="sc">%&gt;%</span> </span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>(company) <span class="sc">%&gt;%</span> </span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(flag_country <span class="sc">!=</span> <span class="st">"Oceanus"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> company, <span class="at">fill =</span> type)) <span class="sc">+</span></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span>type)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-54-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Insights from this visualisation
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>Only one cargo vessel is registered with company. This belongs to the “Saltwater Sisters Company Marine”. Using the data table created above, we found out that this cargo vessel is registered under the flag_country of Oceantterra. This company also owns a fishing vessel (bassbaiterb9f) with flag_country as Oceanus.</p></li>
<li><p>All 20 non-Oceanus fishing vessels are all registered with company in the data.</p></li>
</ul>
</div>
</div>
</section>
<section id="understanding-the-vessel-movements" class="level3">
<h3 class="anchored" data-anchor-id="understanding-the-vessel-movements">1.6.8 Understanding the vessel movements</h3>
<p><strong>Understand Average Dwell by Location</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>vessel_movement<span class="sc">$</span>loc <span class="ot">&lt;-</span> <span class="fu">factor</span>(vessel_movement<span class="sc">$</span>loc,</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>                              <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"City of Himark"</span>,</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"City of Lomark"</span>,</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"City of Haacklee"</span>,</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"City of Paackland"</span>,</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"City of South Paackland"</span>,</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"City of Port Grove"</span>,</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"Ghoti Preserve"</span>, </span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"Nemo Reef"</span>, </span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"Don Limpet Preserve"</span>,</span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"Cod Table"</span>, </span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"Wrasse Beds"</span>,</span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"Tuna Shelf"</span>,</span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"Exit North"</span>,</span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"Exit South"</span>,</span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"Exit East"</span>,</span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"Exit West"</span>,</span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"Nav 1"</span>,<span class="st">"Nav 2"</span>, <span class="st">"Nav 3"</span>, </span>
<span id="cb68-19"><a href="#cb68-19" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"Nav A"</span>, <span class="st">"Nav B"</span>, <span class="st">"Nav C"</span>, <span class="st">"Nav D"</span>, <span class="st">"Nav E"</span>))</span>
<span id="cb68-20"><a href="#cb68-20" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(vessel_movement, <span class="fu">aes</span>(<span class="at">x =</span> loc, </span>
<span id="cb68-21"><a href="#cb68-21" aria-hidden="true" tabindex="-1"></a>                            <span class="at">y =</span> dwell,</span>
<span id="cb68-22"><a href="#cb68-22" aria-hidden="true" tabindex="-1"></a>                            <span class="at">fill =</span> loc_type)) <span class="sc">+</span></span>
<span id="cb68-23"><a href="#cb68-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb68-24"><a href="#cb68-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb68-25"><a href="#cb68-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Median Dwell Time by Location"</span>, </span>
<span id="cb68-26"><a href="#cb68-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Location"</span>, </span>
<span id="cb68-27"><a href="#cb68-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Median Dwell Time"</span>) <span class="sc">+</span></span>
<span id="cb68-28"><a href="#cb68-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">300000</span>)) <span class="sc">+</span></span>
<span id="cb68-29"><a href="#cb68-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-55-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Insights from this visualisation
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>For the cities, the outliers can be explained by the extend stay due to repair and replenishment purposes.</p></li>
<li><p>For all three ecological preserves, there are many outliers, and this is a tell-tale sign of extended stay in the preserves by fishing vessels for IUU fishing.</p></li>
<li><p>For the fishing grounds, the extended stay of fishing vessels may be explained by conducting of transshipment between small fishing vessels and bigger reefer/cargo ships, where the small fishing vessels stay at the location for fishing. There are fishing vessels that are out in the sea for months.</p></li>
<li><p>For the navigation points, Exit E display signs of abnormality due to its high number of outliers compared to other navigation points that are used for international shipping (Exit North, Exit South and Exit West). Nav 1 and Nav A may also be investigated since there are high numbers of outliers, and also, they are at the fringe of the Ghoti and Don Limpet Preserves respectively.</p></li>
</ul>
</div>
</div>
</section>
</section>
<section id="task-1-flow-of-commercially-caught-fish" class="level2">
<h2 class="anchored" data-anchor-id="task-1-flow-of-commercially-caught-fish">2.0 Task 1: Flow of Commercially Caught Fish</h2>
<p>In this section, we focus on a few key areas to understand how the commercially caught fish flows from the vessels through the various ports:</p>
<ol type="1">
<li>Associating the vessels with their probable cargoes</li>
<li>Which vessels deliver which products and when?</li>
<li>Examine the seasonal trends and anomalies in the port exit records</li>
</ol>
</section>
<section id="associating-the-vessels-with-their-probable-cargoes" class="level2">
<h2 class="anchored" data-anchor-id="associating-the-vessels-with-their-probable-cargoes">2.1 Associating the vessels with their probable cargoes</h2>
<p><strong>Matching the vessel with the import_record</strong></p>
<p>We will use the vessel_nodes that contains information on the movement of fishing vessels and cargoes, and define the vessels location, start time and end time of the vessels in the particular location using transponder ping.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>fishing_and_cargo_vessel_list <span class="ot">&lt;-</span> vessel_nodes <span class="sc">%&gt;%</span> </span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"FishingVessel"</span>, <span class="st">"CargoVessel"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(vessel)</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>fishing_and_cargo_vessel_list <span class="ot">&lt;-</span> <span class="fu">as.list</span>(fishing_and_cargo_vessel_list)</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>vessel_location <span class="ot">&lt;-</span> vessel_movement <span class="sc">%&gt;%</span> </span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(vessel <span class="sc">%in%</span> <span class="fu">unlist</span>(fishing_and_cargo_vessel_list)) <span class="sc">%&gt;%</span> </span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(vessel,time) <span class="sc">%&gt;%</span> </span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">next_time =</span> <span class="fu">ifelse</span>(<span class="fu">lead</span>(vessel) <span class="sc">==</span> vessel, <span class="fu">lead</span>(time), <span class="cn">NA</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">next_time =</span> <span class="fu">as_datetime</span>(next_time))   <span class="sc">%&gt;%</span> </span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">end_time =</span> time <span class="sc">+</span> dwell)</span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a>vessel_location_city <span class="ot">&lt;-</span> vessel_location <span class="sc">%&gt;%</span> </span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(loc_short <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Haacklee"</span>,</span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"Lomark"</span>,</span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"Himark"</span>,</span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"Paackland"</span>,</span>
<span id="cb69-19"><a href="#cb69-19" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"South Paackland"</span>,</span>
<span id="cb69-20"><a href="#cb69-20" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"Port Grove"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>Vessel Location based on harbor report</strong></p>
<p>The next step we do is to extract the date, location and vessel from the harbor report. Since this is describe as canonical, it should be considered for matching first before using the vessel location data from transponder ping. Columns are renamed to match the information in the cargo_list.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>vessel_mvmt_hr <span class="ot">&lt;-</span> harbor_report <span class="sc">%&gt;%</span> </span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(vessel, city, date) <span class="sc">%&gt;%</span> </span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">vessel_delivery_date =</span> date)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>Merging import_record and vessel_mvmt_hr</strong></p>
<p>Adding one column on vessel delivery date, which is 1 day before the date stated in the harbor import record.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>cargo_list <span class="ot">&lt;-</span> import_record <span class="sc">%&gt;%</span> </span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">vessel_delivery_date =</span> cargo_delivery_date <span class="sc">+</span> <span class="fu">days</span>(<span class="sc">-</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Saving cargo_list:</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(cargo_list, <span class="st">"data/rds/cargo_list.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>vessel_location_match_hr <span class="ot">&lt;-</span> cargo_list <span class="sc">%&gt;%</span> </span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(vessel_mvmt_hr ) <span class="sc">%&gt;%</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">if_all</span>(<span class="fu">c</span>(qty_tons,vessel), <span class="sc">~</span> <span class="sc">!</span><span class="fu">is.na</span>(.))) <span class="sc">%&gt;%</span> </span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(vessel_location_match_hr, <span class="st">"data/rds/vessel_location_match_hr.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>hr_match <span class="ot">&lt;-</span> mc2_nodes <span class="sc">%&gt;%</span> </span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id,Name,flag_country, company, tonnage,entity3) <span class="sc">%&gt;%</span> </span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">vessel =</span> id) <span class="sc">%&gt;%</span> </span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(vessel_location_match_hr) <span class="sc">%&gt;%</span>   </span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">if_all</span>(<span class="fu">c</span>(qty_tons, tonnage), <span class="sc">~</span> <span class="sc">!</span><span class="fu">is.na</span>(.))) <span class="sc">%&gt;%</span> </span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>Merging cargo_list and vessel_location_city</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>vessel_location_city <span class="ot">&lt;-</span> vessel_location_city <span class="sc">%&gt;%</span> </span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date =</span> <span class="fu">substr</span>(<span class="st">`</span><span class="at">time</span><span class="st">`</span>,<span class="dv">1</span>,<span class="dv">10</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">vessel_delivery_date =</span> <span class="fu">ymd</span>(date))  <span class="sc">%&gt;%</span> </span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(dwell <span class="sc">&gt;</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>vessel_location_match <span class="ot">&lt;-</span> vessel_location_city <span class="sc">%&gt;%</span> </span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(cargo_list, </span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">unmatched =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">if_all</span>(<span class="fu">c</span>(qty_tons), <span class="sc">~</span> <span class="sc">!</span><span class="fu">is.na</span>(.))) <span class="sc">%&gt;%</span> </span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>Vessel Match Graph</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>id1 <span class="ot">&lt;-</span> vessel_location_match_hr  <span class="sc">%&gt;%</span> </span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(vessel) <span class="sc">%&gt;%</span> </span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">id =</span> vessel) </span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>id2 <span class="ot">&lt;-</span> vessel_location_match_hr  <span class="sc">%&gt;%</span> </span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(cargo) <span class="sc">%&gt;%</span> </span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">id =</span> cargo)</span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>cargo_vessel_nodes <span class="ot">&lt;-</span> <span class="fu">rbind</span>(id1,id2) <span class="sc">%&gt;%</span> </span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() </span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a>cargo_vessel_edges <span class="ot">&lt;-</span> vessel_location_match_hr <span class="sc">%&gt;%</span> </span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(vessel,cargo, fish, city) <span class="sc">%&gt;%</span> </span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span></span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(vessel, cargo) <span class="sc">%&gt;%</span></span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">source =</span> vessel, <span class="at">target =</span> cargo)<span class="sc">%&gt;%</span></span>
<span id="cb78-17"><a href="#cb78-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(source<span class="sc">!=</span>target) <span class="sc">%&gt;%</span> </span>
<span id="cb78-18"><a href="#cb78-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb78-19"><a href="#cb78-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-20"><a href="#cb78-20" aria-hidden="true" tabindex="-1"></a>cargo_vessel_graph <span class="ot">&lt;-</span> <span class="fu">tbl_graph</span>(<span class="at">nodes =</span> cargo_vessel_nodes,</span>
<span id="cb78-21"><a href="#cb78-21" aria-hidden="true" tabindex="-1"></a>                       <span class="at">edges =</span> cargo_vessel_edges,</span>
<span id="cb78-22"><a href="#cb78-22" aria-hidden="true" tabindex="-1"></a>                       <span class="at">directed =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>cargo_vessel_graph <span class="sc">%&gt;%</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">'fr'</span>) <span class="sc">+</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>() <span class="sc">+</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>() <span class="sc">+</span> </span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_graph</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-66-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Finding anomalies in vessel movement by comparing end time (calculated by dwell) with next time (the next time the vessel is detected at the next location).</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>ab_vessel_mvmt <span class="ot">&lt;-</span> vessel_location <span class="sc">%&gt;%</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">time =</span> <span class="fu">ymd_hms</span>(time)) <span class="sc">%&gt;%</span> </span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">next_time =</span> <span class="fu">ymd_hms</span>(next_time)) <span class="sc">%&gt;%</span> </span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">end_time =</span> <span class="fu">ymd_hms</span>(end_time)) <span class="sc">%&gt;%</span> </span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(end_time <span class="sc">!=</span> next_time) </span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>ab_vessel_mvmt_agg <span class="ot">&lt;-</span> ab_vessel_mvmt <span class="sc">%&gt;%</span> </span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(vessel) <span class="sc">%&gt;%</span> </span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">weights =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(weights))</span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a>ab_vessel_mvmt_agg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 277 × 2
   vessel                 weights
   &lt;chr&gt;                    &lt;int&gt;
 1 brooktroutbuccaneerc0b     151
 2 bluemarlinbandit292        149
 3 halibuthero9b9             146
 4 catchcruisera94            145
 5 bluefishbandit8ec          138
 6 tenchtaker595              133
 7 deepseadrifter9f2          132
 8 whitefishwrangler7df       132
 9 yellowfintunataker08b      130
10 rainbowtroutraider4d0      129
# ℹ 267 more rows</code></pre>
</div>
</div>
</section>
<section id="examine-the-seasonal-trends-and-anomalies-in-the-port-exit-records" class="level2">
<h2 class="anchored" data-anchor-id="examine-the-seasonal-trends-and-anomalies-in-the-port-exit-records">2.3 Examine the seasonal trends and anomalies in the port exit records</h2>
<section id="seasonal-trends-in-port-exit-records" class="level3">
<h3 class="anchored" data-anchor-id="seasonal-trends-in-port-exit-records">2.3.1 Seasonal trends in port exit records</h3>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>import_record1 <span class="ot">&lt;-</span> import_record <span class="sc">%&gt;%</span> </span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">year</span>(cargo_delivery_date),</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">month =</span> <span class="fu">month</span>(cargo_delivery_date, <span class="at">label =</span> <span class="cn">TRUE</span>),</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">day =</span> <span class="fu">day</span>(cargo_delivery_date),</span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">week =</span> <span class="fu">week</span>(cargo_delivery_date),</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">weekday =</span> <span class="fu">wday</span>(cargo_delivery_date, <span class="at">label =</span> <span class="cn">TRUE</span>, <span class="at">week_start =</span> <span class="dv">1</span>))</span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an overall Oceanus heat map for all types of fish</span></span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>fish_agg <span class="ot">&lt;-</span> import_record1  <span class="sc">%&gt;%</span></span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span></span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(fish,month) <span class="sc">%&gt;%</span></span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_qty_tons =</span> <span class="fu">sum</span>(qty_tons)) <span class="sc">%&gt;%</span> </span>
<span id="cb82-13"><a href="#cb82-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb82-14"><a href="#cb82-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-15"><a href="#cb82-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(fish_agg, <span class="fu">aes</span>(<span class="at">x =</span> month, <span class="at">y =</span> fish, <span class="at">fill =</span> total_qty_tons)) <span class="sc">+</span></span>
<span id="cb82-16"><a href="#cb82-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb82-17"><a href="#cb82-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"white"</span>, <span class="at">high =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb82-18"><a href="#cb82-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Calendar Heatmap for fish in Oceanus"</span>),</span>
<span id="cb82-19"><a href="#cb82-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">"Month of the Year"</span>,</span>
<span id="cb82-20"><a href="#cb82-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">"Fish Type"</span>,</span>
<span id="cb82-21"><a href="#cb82-21" aria-hidden="true" tabindex="-1"></a>         <span class="at">fill =</span> <span class="st">"Total Quantity (tons)"</span>) <span class="sc">+</span></span>
<span id="cb82-22"><a href="#cb82-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-68-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to create a calendar heat map</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>create_heatmap <span class="ot">&lt;-</span> <span class="cf">function</span>(data, city) {</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> month, </span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> fish, </span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">fill =</span> total_qty_tons)) <span class="sc">+</span></span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"white"</span>, <span class="at">high =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Calendar Heatmap for fish in"</span>, city),</span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">"Month of the Year"</span>,</span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">"Fish Type"</span>,</span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">fill =</span> <span class="st">"Total Quantity (tons)"</span>) <span class="sc">+</span></span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span>
<span id="cb83-13"><a href="#cb83-13" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>fish_by_port_agg <span class="ot">&lt;-</span> import_record1 <span class="sc">%&gt;%</span> </span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(city,fish,month) <span class="sc">%&gt;%</span> </span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_qty_tons =</span> <span class="fu">sum</span>(qty_tons))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an empty list to store heatmaps</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>heatmaps <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Iterate over each city</span></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>cities <span class="ot">&lt;-</span> <span class="fu">unique</span>(cargo_list<span class="sc">$</span>city)</span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (c <span class="cf">in</span> cities) {</span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filter the data for the current city</span></span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>  heatmap_data <span class="ot">&lt;-</span> fish_by_port_agg <span class="sc">%&gt;%</span> </span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(city <span class="sc">==</span> c)</span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create the heatmap for the current city</span></span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a>  heatmap <span class="ot">&lt;-</span> <span class="fu">create_heatmap</span>(heatmap_data, c)</span>
<span id="cb85-13"><a href="#cb85-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb85-14"><a href="#cb85-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Store the heatmap in the list</span></span>
<span id="cb85-15"><a href="#cb85-15" aria-hidden="true" tabindex="-1"></a>  heatmaps[[c]] <span class="ot">&lt;-</span> heatmap</span>
<span id="cb85-16"><a href="#cb85-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb85-17"><a href="#cb85-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-18"><a href="#cb85-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Print or visualize the heatmaps</span></span>
<span id="cb85-19"><a href="#cb85-19" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (c <span class="cf">in</span> cities) {</span>
<span id="cb85-20"><a href="#cb85-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(heatmaps[[c]])</span>
<span id="cb85-21"><a href="#cb85-21" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-71-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-71-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-71-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-71-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-71-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="understanding-the-types-of-fish-that-should-not-be-in-the-market" class="level2">
<h2 class="anchored" data-anchor-id="understanding-the-types-of-fish-that-should-not-be-in-the-market">2.3.1 <strong>Understanding the types of fish that should not be in the market</strong></h2>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an empty list to store heatmaps</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>heatmaps <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Iterate over each city</span></span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>cities <span class="ot">&lt;-</span> <span class="fu">unique</span>(cargo_list<span class="sc">$</span>city)</span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (c <span class="cf">in</span> cities) {</span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filter the data for the current city</span></span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a>  heatmap_data <span class="ot">&lt;-</span> fish_by_port_agg <span class="sc">%&gt;%</span> </span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(city <span class="sc">==</span> c) <span class="sc">%&gt;%</span> </span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(fish <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Sockfish"</span>, <span class="st">"Offidiaa"</span>, <span class="st">"Helenaa"</span>,<span class="st">"Salmon"</span>))</span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb86-12"><a href="#cb86-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create the heatmap for the current city</span></span>
<span id="cb86-13"><a href="#cb86-13" aria-hidden="true" tabindex="-1"></a>  heatmap <span class="ot">&lt;-</span> <span class="fu">create_heatmap</span>(heatmap_data, c)</span>
<span id="cb86-14"><a href="#cb86-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb86-15"><a href="#cb86-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Store the heatmap in the list</span></span>
<span id="cb86-16"><a href="#cb86-16" aria-hidden="true" tabindex="-1"></a>  heatmaps[[c]] <span class="ot">&lt;-</span> heatmap</span>
<span id="cb86-17"><a href="#cb86-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb86-18"><a href="#cb86-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-19"><a href="#cb86-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Print or visualize the heatmaps</span></span>
<span id="cb86-20"><a href="#cb86-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (c <span class="cf">in</span> cities) {</span>
<span id="cb86-21"><a href="#cb86-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(heatmaps[[c]])</span>
<span id="cb86-22"><a href="#cb86-22" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-72-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-72-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-72-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-72-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-72-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Insights from this visualisation
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>From this heatmap above, we understand that there is an abnormal increase in Sockfish catch from May onwards, and abnormal increase in Offidiaa catch from September onwards , which are species unique to the Don Limpet Preserve and Ghoti Preserve respectively.</p></li>
<li><p>Probable reason for this is that since SouthSeafood Express Corp was caught in mid-May for illegal fishing in Ghoti Preserve, other illegal fishing vessels made a switch to Don Limpet Reserves to fish.</p></li>
</ul>
</div>
</div>
</section>
<section id="task-2" class="level2">
<h2 class="anchored" data-anchor-id="task-2">3.0 Task 2</h2>
<p>Develop visualizations that illustrate the inappropriate behavior of SouthSeafood Express Corp vessels. How do their movement and catch contents compare to other fishing vessels? When and where did SouthSeafood Express Corp vessels perform their illegal fishing? How many different types of suspicious behaviors are observed? Use visual evidence to justify your conclusions.</p>
</section>
<section id="illegal-fishing-by-southseafood-express-corp" class="level2">
<h2 class="anchored" data-anchor-id="illegal-fishing-by-southseafood-express-corp">3.1 Illegal fishing by SouthSeafood Express Corp</h2>
<p>SouthSeafood Express Corp operates two fishing vessels by the id of “snappersnatcher7be” and “roachrobberdb6”.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>vessel_movement_agg <span class="ot">&lt;-</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>  vessel_movement <span class="sc">%&gt;%</span></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(loc, vessel, type) <span class="sc">%&gt;%</span></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">weights =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>vessel_movement_agg <span class="sc">%&gt;%</span> </span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(vessel <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"snappersnatcher7be"</span>,<span class="st">"roachrobberdb6"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(vessel) <span class="sc">%&gt;%</span> </span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>vessel, <span class="at">y=</span>loc,</span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> weights)) <span class="sc">+</span></span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-74-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="when-and-where-did-southseafood-express-corp-vessels-perform-their-illegal-fishing" class="level3">
<h3 class="anchored" data-anchor-id="when-and-where-did-southseafood-express-corp-vessels-perform-their-illegal-fishing">3.1.1 When and where did SouthSeafood Express Corp vessels perform their illegal fishing?</h3>
<p>Since only Snapper Snatcher appears to be operating in Ghoti Preserve, we will examine this fishing vessel more closely.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>snapper_activities <span class="ot">&lt;-</span> vessel_movement <span class="sc">%&gt;%</span> </span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(vessel <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"snappersnatcher7be"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(loc <span class="sc">==</span> <span class="st">"Ghoti Preserve"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(vessel,time) <span class="sc">%&gt;%</span> </span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">end_time =</span> time <span class="sc">+</span> dwell) <span class="sc">%&gt;%</span> </span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(time, dwell, end_time)</span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>snapper_activities</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                 time      dwell            end_time
1 2035-02-02 05:39:59 282000.853 2035-02-05 12:00:00
2 2035-02-09 05:49:11 281448.765 2035-02-12 12:00:00
3 2035-02-16 07:02:09 277070.841 2035-02-19 12:00:00
4 2035-03-15 05:46:02   6410.348 2035-03-15 07:32:52</code></pre>
</div>
</div>
<p>There three instances (2,9 and 16 Feb) where Snapper Snatcher stayed at the Ghoti Preserve for over 3 days. These are the instances where SouthSeafood Express Corp’s Snapper Snatcher conducted IUU Fishing in Ghoti Preserve.</p>
</section>
<section id="visualising-vessel-trajectory" class="level3">
<h3 class="anchored" data-anchor-id="visualising-vessel-trajectory">3.1.2 Visualising Vessel Trajectory</h3>
<p>In the code chunk below, st_as_sf() of sf package is used to convert vessel_movement_data data.frame into sf point data.frame by using values in XCOORD and YCOORD columns. The output is an sf data.frame called vessel_movement_sf.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>vessel_movement_sf <span class="ot">&lt;-</span> vessel_movement <span class="sc">%&gt;%</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_sf</span>(<span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"XCOORD"</span>, <span class="st">"YCOORD"</span>), </span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">crs =</span> <span class="dv">4326</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Next arrange() is used to sort the records according to the vessels’ name (i.e.&nbsp;target) and navigation time (i.e.&nbsp;time)</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>vessel_movement_sf <span class="ot">&lt;-</span> vessel_movement_sf <span class="sc">%&gt;%</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(vessel, time)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Lastly, st_cast() of sf package is used to convert vessel_movement_sf from point features into linestring features called vessel_trajectory.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>vessel_trajectory <span class="ot">&lt;-</span> vessel_movement_sf <span class="sc">%&gt;%</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(vessel) <span class="sc">%&gt;%</span></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">do_union =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_cast</span>(<span class="st">"LINESTRING"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>Selecting SouthSeafood Express vessels</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>vessel_trajectory_selected <span class="ot">&lt;-</span> vessel_trajectory <span class="sc">%&gt;%</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(vessel <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"snappersnatcher7be"</span>, <span class="st">"roachrobberdb6"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Next, appropriate functions of ggplot2 is used to plot the selected vessel trajectories by using the code chunk below.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> oceanus_geography) <span class="sc">+</span></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> vessel_trajectory_selected, </span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>          <span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(vessel)), </span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Trajectories of SouthSeafood Express Vessels"</span>, </span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="st">"Longitude"</span>, <span class="at">y =</span> <span class="st">"Latitude"</span>, <span class="at">color =</span> <span class="st">"ID"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-80-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="task-4" class="level2">
<h2 class="anchored" data-anchor-id="task-4">4.0 Task 4</h2>
<p><strong>The Questions</strong>:</p>
<ol type="1">
<li><p>How did fishing activity change after SouthSeafood Express Corp was caught?</p></li>
<li><p>What new behaviors in the Oceanus commercial fishing community are most suspicious and why?</p></li>
</ol>
<p>In order to understand the change in fishing activities, we first have to determine the date where SouthSeafood Express Corp was caught. The final activities of SouthSeafood’s vessels are on 2035-05-14 at City of Lomark for Snapper Snatcher (snappersnatcher7be) and 2035-05-12 at City of Himark for Roach Robber (roachrobberdb6) according to the transponder pings. Hence, we can conclude that the SouthSeafood is caught for illegal fishing, and had ceased operating its fishing vessels since 2035-05-14. We will use this date as the cut off to define before and after SSEC was caught.</p>
</section>
<section id="changes-in-commercial-fishing" class="level2">
<h2 class="anchored" data-anchor-id="changes-in-commercial-fishing">4.1 Changes in Commercial Fishing</h2>
<p>Firstly, we take a look at the species caught across the months (Feb to Nov 2035).</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an overall Oceanus heat map for all types of fish</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>fish_agg <span class="ot">&lt;-</span> fish_by_port_agg  <span class="sc">%&gt;%</span></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(fish,month) <span class="sc">%&gt;%</span></span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">total_qty_tons =</span> <span class="fu">sum</span>(total_qty_tons)) </span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a>oceanus_heatmap <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(fish_agg, <span class="fu">aes</span>(<span class="at">x =</span> month, <span class="at">y =</span> fish, <span class="at">fill =</span> total_qty_tons)) <span class="sc">+</span></span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"white"</span>, <span class="at">high =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste</span>(<span class="st">"Calendar Heatmap for fish in Oceanus"</span>),</span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">"Month of the Year"</span>,</span>
<span id="cb96-12"><a href="#cb96-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">"Fish Type"</span>,</span>
<span id="cb96-13"><a href="#cb96-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">fill =</span> <span class="st">"Total Quantity (tons)"</span>) <span class="sc">+</span></span>
<span id="cb96-14"><a href="#cb96-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb96-15"><a href="#cb96-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="st">"May"</span>,<span class="at">color =</span> <span class="st">'red'</span>, <span class="at">linetype =</span> <span class="st">'dashed'</span>) <span class="sc">+</span></span>
<span id="cb96-16"><a href="#cb96-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="st">"May"</span> , <span class="at">y =</span> <span class="st">"Offidiaa"</span>, <span class="at">label =</span> <span class="st">"SouthSeafood caught"</span>, <span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Order them based on 3 Preserves and 3 Fishing Ground</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>desired_order <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Ghoti Preserve"</span>, <span class="st">"Nemo Reef"</span>, <span class="st">"Don Limpet Preserve"</span>,<span class="st">"Cod Table"</span>, <span class="st">"Wrasse Beds"</span>,<span class="st">"Tuna Shelf"</span>)  </span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>region_fish_species_long<span class="sc">$</span>Name <span class="ot">&lt;-</span> <span class="fu">factor</span>(region_fish_species_long<span class="sc">$</span>Name, <span class="at">levels =</span> desired_order)</span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>species_plot <span class="ot">&lt;-</span><span class="fu">ggplot</span>(region_fish_species_long, <span class="fu">aes</span>(<span class="at">x =</span> Name, </span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">y =</span> Presence,</span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">colour =</span> Presence)) <span class="sc">+</span></span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Species Presence by Name"</span>,</span>
<span id="cb97-11"><a href="#cb97-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Name"</span>,</span>
<span id="cb97-12"><a href="#cb97-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Species"</span>) <span class="sc">+</span></span>
<span id="cb97-13"><a href="#cb97-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb97-14"><a href="#cb97-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb97-15"><a href="#cb97-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>oceanus_heatmap <span class="sc">/</span> species_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-83-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<p>For recapitulation, we know that Sockfish, Offidiaa, and Helenaa are fish species that are unique to the three Preserves. From the two plots above, we can derive initial conclusion that there is an usual increase in Sockfish catch after SouthSeafood was caught in mid-May. We also see a minor increase in Helenaa between Jun to Aug, and later in Oct to Nov.&nbsp;The spike in Offidiaa catch begins in Sep and grows gradually to Nov.&nbsp;There is also appearance of Salmon from Jul onwards.</p>
<p>Combining the information above, we can make the following two hypothesis about the changes in fishing activities in Oceanus after SouthSeafood was caught:</p>
<ol type="1">
<li><p>The fishing vessels switched to Don Limpet Preserve for IUU fishing. Tell tale sign is the increase in Sockfish catch, which is species unique to Don Limpet Preserve. This also explains the slight increase in Helena catch from Jun.</p></li>
<li><p>The fishing vessels moved into Ghoti Preserves from Sep onwards for IUU fishing. Tell tale sign is the increase in Offidia catch from Sep, which is species unique to Ghoti Preserve.</p></li>
<li><p>Salmon start to appear in the cargoes in various cities. Salmon is a deep sea fish species that is not found in any of the fishing ground in Oceanus</p></li>
</ol>
<p>For confirmation, we take a look at the changes to OVLS Transponder Ping, comparing the total pings to various locations month by month.</p>
<p><strong>Frequency of visits to the Cities</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>vessel_movement_long <span class="ot">&lt;-</span> vessel_movement <span class="sc">%&gt;%</span> </span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(loc_type <span class="sc">==</span> <span class="st">"city"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"FishingVessel"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">month =</span> <span class="fu">month</span>(time)) <span class="sc">%&gt;%</span> </span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(loc, vessel, month) <span class="sc">%&gt;%</span> </span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(loc, month) <span class="sc">%&gt;%</span> </span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n =</span> <span class="fu">n</span>()) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> vessel_movement_long <span class="sc">%&gt;%</span> </span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">month =</span> <span class="fu">as.factor</span>(month)) <span class="sc">%&gt;%</span> </span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">newggslopegraph</span>(month,n, loc,</span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">Title =</span> <span class="st">"Changes in Visit Frequency of Fishing Vessels"</span>,</span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">SubTitle =</span> <span class="st">"Cities"</span>,</span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">Caption =</span> <span class="st">"Feb-Nov.Before and After SSEC caught in May"</span>) </span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> a <span class="sc">+</span> </span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">4</span>, </span>
<span id="cb100-11"><a href="#cb100-11" aria-hidden="true" tabindex="-1"></a>                    <span class="at">linetype =</span> <span class="dv">2</span>, </span>
<span id="cb100-12"><a href="#cb100-12" aria-hidden="true" tabindex="-1"></a>                    <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb100-13"><a href="#cb100-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">4</span>, <span class="at">y =</span> <span class="dv">150</span>, <span class="at">label =</span> <span class="st">"SouthSeafood caught"</span>),</span>
<span id="cb100-14"><a href="#cb100-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"red"</span>,</span>
<span id="cb100-15"><a href="#cb100-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">hjust =</span> <span class="fl">1.1</span>,</span>
<span id="cb100-16"><a href="#cb100-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">3</span>)</span>
<span id="cb100-17"><a href="#cb100-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb100-18"><a href="#cb100-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>List of 136
 $ line                            :List of 6
  ..$ colour       : chr "black"
  ..$ linewidth    : num 0.5
  ..$ linetype     : num 1
  ..$ lineend      : chr "butt"
  ..$ arrow        : logi FALSE
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_line" "element"
 $ rect                            :List of 5
  ..$ fill         : chr "white"
  ..$ colour       : chr "black"
  ..$ linewidth    : num 0.5
  ..$ linetype     : num 1
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_rect" "element"
 $ text                            :List of 11
  ..$ family       : chr ""
  ..$ face         : chr "plain"
  ..$ colour       : chr "black"
  ..$ size         : num 11
  ..$ hjust        : num 0.5
  ..$ vjust        : num 0.5
  ..$ angle        : num 0
  ..$ lineheight   : num 0.9
  ..$ margin       : 'margin' num [1:4] 0points 0points 0points 0points
  .. ..- attr(*, "unit")= int 8
  ..$ debug        : logi FALSE
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_text" "element"
 $ title                           : NULL
 $ aspect.ratio                    : NULL
 $ axis.title                      : NULL
 $ axis.title.x                    :List of 11
  ..$ family       : NULL
  ..$ face         : NULL
  ..$ colour       : NULL
  ..$ size         : NULL
  ..$ hjust        : NULL
  ..$ vjust        : num 1
  ..$ angle        : NULL
  ..$ lineheight   : NULL
  ..$ margin       : 'margin' num [1:4] 2.75points 0points 0points 0points
  .. ..- attr(*, "unit")= int 8
  ..$ debug        : NULL
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_text" "element"
 $ axis.title.x.top                :List of 11
  ..$ family       : NULL
  ..$ face         : NULL
  ..$ colour       : NULL
  ..$ size         : NULL
  ..$ hjust        : NULL
  ..$ vjust        : num 0
  ..$ angle        : NULL
  ..$ lineheight   : NULL
  ..$ margin       : 'margin' num [1:4] 0points 0points 2.75points 0points
  .. ..- attr(*, "unit")= int 8
  ..$ debug        : NULL
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_text" "element"
 $ axis.title.x.bottom             : NULL
 $ axis.title.y                    :List of 11
  ..$ family       : NULL
  ..$ face         : NULL
  ..$ colour       : NULL
  ..$ size         : NULL
  ..$ hjust        : NULL
  ..$ vjust        : num 1
  ..$ angle        : num 90
  ..$ lineheight   : NULL
  ..$ margin       : 'margin' num [1:4] 0points 2.75points 0points 0points
  .. ..- attr(*, "unit")= int 8
  ..$ debug        : NULL
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_text" "element"
 $ axis.title.y.left               : NULL
 $ axis.title.y.right              :List of 11
  ..$ family       : NULL
  ..$ face         : NULL
  ..$ colour       : NULL
  ..$ size         : NULL
  ..$ hjust        : NULL
  ..$ vjust        : num 1
  ..$ angle        : num -90
  ..$ lineheight   : NULL
  ..$ margin       : 'margin' num [1:4] 0points 0points 0points 2.75points
  .. ..- attr(*, "unit")= int 8
  ..$ debug        : NULL
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_text" "element"
 $ axis.text                       :List of 11
  ..$ family       : NULL
  ..$ face         : NULL
  ..$ colour       : chr "grey30"
  ..$ size         : 'rel' num 0.8
  ..$ hjust        : NULL
  ..$ vjust        : NULL
  ..$ angle        : NULL
  ..$ lineheight   : NULL
  ..$ margin       : NULL
  ..$ debug        : NULL
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_text" "element"
 $ axis.text.x                     :List of 11
  ..$ family       : NULL
  ..$ face         : NULL
  ..$ colour       : NULL
  ..$ size         : NULL
  ..$ hjust        : NULL
  ..$ vjust        : num 1
  ..$ angle        : NULL
  ..$ lineheight   : NULL
  ..$ margin       : 'margin' num [1:4] 2.2points 0points 0points 0points
  .. ..- attr(*, "unit")= int 8
  ..$ debug        : NULL
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_text" "element"
 $ axis.text.x.top                 :List of 11
  ..$ family       : NULL
  ..$ face         : NULL
  ..$ colour       : NULL
  ..$ size         : NULL
  ..$ hjust        : NULL
  ..$ vjust        : num 0
  ..$ angle        : NULL
  ..$ lineheight   : NULL
  ..$ margin       : 'margin' num [1:4] 0points 0points 2.2points 0points
  .. ..- attr(*, "unit")= int 8
  ..$ debug        : NULL
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_text" "element"
 $ axis.text.x.bottom              : NULL
 $ axis.text.y                     :List of 11
  ..$ family       : NULL
  ..$ face         : NULL
  ..$ colour       : NULL
  ..$ size         : NULL
  ..$ hjust        : num 1
  ..$ vjust        : NULL
  ..$ angle        : NULL
  ..$ lineheight   : NULL
  ..$ margin       : 'margin' num [1:4] 0points 2.2points 0points 0points
  .. ..- attr(*, "unit")= int 8
  ..$ debug        : NULL
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_text" "element"
 $ axis.text.y.left                : NULL
 $ axis.text.y.right               :List of 11
  ..$ family       : NULL
  ..$ face         : NULL
  ..$ colour       : NULL
  ..$ size         : NULL
  ..$ hjust        : num 0
  ..$ vjust        : NULL
  ..$ angle        : NULL
  ..$ lineheight   : NULL
  ..$ margin       : 'margin' num [1:4] 0points 0points 0points 2.2points
  .. ..- attr(*, "unit")= int 8
  ..$ debug        : NULL
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_text" "element"
 $ axis.text.theta                 : NULL
 $ axis.text.r                     :List of 11
  ..$ family       : NULL
  ..$ face         : NULL
  ..$ colour       : NULL
  ..$ size         : NULL
  ..$ hjust        : num 0.5
  ..$ vjust        : NULL
  ..$ angle        : NULL
  ..$ lineheight   : NULL
  ..$ margin       : 'margin' num [1:4] 0points 2.2points 0points 2.2points
  .. ..- attr(*, "unit")= int 8
  ..$ debug        : NULL
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_text" "element"
 $ axis.ticks                      : list()
  ..- attr(*, "class")= chr [1:2] "element_blank" "element"
 $ axis.ticks.x                    : NULL
 $ axis.ticks.x.top                : NULL
 $ axis.ticks.x.bottom             : NULL
 $ axis.ticks.y                    : NULL
 $ axis.ticks.y.left               : NULL
 $ axis.ticks.y.right              : NULL
 $ axis.ticks.theta                : NULL
 $ axis.ticks.r                    : NULL
 $ axis.minor.ticks.x.top          : NULL
 $ axis.minor.ticks.x.bottom       : NULL
 $ axis.minor.ticks.y.left         : NULL
 $ axis.minor.ticks.y.right        : NULL
 $ axis.minor.ticks.theta          : NULL
 $ axis.minor.ticks.r              : NULL
 $ axis.ticks.length               : 'simpleUnit' num 2.75points
  ..- attr(*, "unit")= int 8
 $ axis.ticks.length.x             : NULL
 $ axis.ticks.length.x.top         : NULL
 $ axis.ticks.length.x.bottom      : NULL
 $ axis.ticks.length.y             : NULL
 $ axis.ticks.length.y.left        : NULL
 $ axis.ticks.length.y.right       : NULL
 $ axis.ticks.length.theta         : NULL
 $ axis.ticks.length.r             : NULL
 $ axis.minor.ticks.length         : 'rel' num 0.75
 $ axis.minor.ticks.length.x       : NULL
 $ axis.minor.ticks.length.x.top   : NULL
 $ axis.minor.ticks.length.x.bottom: NULL
 $ axis.minor.ticks.length.y       : NULL
 $ axis.minor.ticks.length.y.left  : NULL
 $ axis.minor.ticks.length.y.right : NULL
 $ axis.minor.ticks.length.theta   : NULL
 $ axis.minor.ticks.length.r       : NULL
 $ axis.line                       : list()
  ..- attr(*, "class")= chr [1:2] "element_blank" "element"
 $ axis.line.x                     : NULL
 $ axis.line.x.top                 : NULL
 $ axis.line.x.bottom              : NULL
 $ axis.line.y                     : NULL
 $ axis.line.y.left                : NULL
 $ axis.line.y.right               : NULL
 $ axis.line.theta                 : NULL
 $ axis.line.r                     : NULL
 $ legend.background               : list()
  ..- attr(*, "class")= chr [1:2] "element_blank" "element"
 $ legend.margin                   : 'margin' num [1:4] 5.5points 5.5points 5.5points 5.5points
  ..- attr(*, "unit")= int 8
 $ legend.spacing                  : 'simpleUnit' num 11points
  ..- attr(*, "unit")= int 8
 $ legend.spacing.x                : NULL
 $ legend.spacing.y                : NULL
 $ legend.key                      : list()
  ..- attr(*, "class")= chr [1:2] "element_blank" "element"
 $ legend.key.size                 : 'simpleUnit' num 1.2lines
  ..- attr(*, "unit")= int 3
 $ legend.key.height               : NULL
 $ legend.key.width                : NULL
 $ legend.key.spacing              : 'simpleUnit' num 5.5points
  ..- attr(*, "unit")= int 8
 $ legend.key.spacing.x            : NULL
 $ legend.key.spacing.y            : NULL
 $ legend.frame                    : NULL
 $ legend.ticks                    : NULL
 $ legend.ticks.length             : 'rel' num 0.2
 $ legend.axis.line                : NULL
 $ legend.text                     :List of 11
  ..$ family       : NULL
  ..$ face         : NULL
  ..$ colour       : NULL
  ..$ size         : 'rel' num 0.8
  ..$ hjust        : NULL
  ..$ vjust        : NULL
  ..$ angle        : NULL
  ..$ lineheight   : NULL
  ..$ margin       : NULL
  ..$ debug        : NULL
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_text" "element"
 $ legend.text.position            : NULL
 $ legend.title                    :List of 11
  ..$ family       : NULL
  ..$ face         : NULL
  ..$ colour       : NULL
  ..$ size         : NULL
  ..$ hjust        : num 0
  ..$ vjust        : NULL
  ..$ angle        : NULL
  ..$ lineheight   : NULL
  ..$ margin       : NULL
  ..$ debug        : NULL
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_text" "element"
 $ legend.title.position           : NULL
 $ legend.position                 : chr "none"
 $ legend.position.inside          : NULL
 $ legend.direction                : NULL
 $ legend.byrow                    : NULL
 $ legend.justification            : chr "center"
 $ legend.justification.top        : NULL
 $ legend.justification.bottom     : NULL
 $ legend.justification.left       : NULL
 $ legend.justification.right      : NULL
 $ legend.justification.inside     : NULL
 $ legend.location                 : NULL
 $ legend.box                      : NULL
 $ legend.box.just                 : NULL
 $ legend.box.margin               : 'margin' num [1:4] 0cm 0cm 0cm 0cm
  ..- attr(*, "unit")= int 1
 $ legend.box.background           : list()
  ..- attr(*, "class")= chr [1:2] "element_blank" "element"
 $ legend.box.spacing              : 'simpleUnit' num 11points
  ..- attr(*, "unit")= int 8
  [list output truncated]
 - attr(*, "class")= chr [1:2] "theme" "gg"
 - attr(*, "complete")= logi TRUE
 - attr(*, "validate")= logi TRUE</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-85-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Insights from this visualisation
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>For the City of Himark, there is a hike in visit frequency till the time</li>
</ul>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>vessel_movement_long <span class="ot">&lt;-</span> vessel_movement <span class="sc">%&gt;%</span> </span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(loc_type <span class="sc">==</span> <span class="st">"buoy"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"FishingVessel"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">month =</span> <span class="fu">month</span>(time)) <span class="sc">%&gt;%</span> </span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(loc, vessel, month) <span class="sc">%&gt;%</span> </span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(loc, month) <span class="sc">%&gt;%</span> </span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n =</span> <span class="fu">n</span>()) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> vessel_movement_long <span class="sc">%&gt;%</span> </span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">month =</span> <span class="fu">as.factor</span>(month)) <span class="sc">%&gt;%</span> </span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">newggslopegraph</span>(month,n, loc,</span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">Title =</span> <span class="st">"Changes in Visit Frequency of Fishing Vessels"</span>,</span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">SubTitle =</span> <span class="st">"Navigation Points"</span>,</span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">Caption =</span> <span class="st">"Feb-Nov.Before and After SSEC caught in May"</span>) </span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> b <span class="sc">+</span> </span>
<span id="cb104-10"><a href="#cb104-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">4</span>, </span>
<span id="cb104-11"><a href="#cb104-11" aria-hidden="true" tabindex="-1"></a>                    <span class="at">linetype =</span> <span class="dv">2</span>, </span>
<span id="cb104-12"><a href="#cb104-12" aria-hidden="true" tabindex="-1"></a>                    <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb104-13"><a href="#cb104-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">4</span>, <span class="at">y =</span> <span class="dv">150</span>, <span class="at">label =</span> <span class="st">"SouthSeafood caught"</span>),</span>
<span id="cb104-14"><a href="#cb104-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"red"</span>,</span>
<span id="cb104-15"><a href="#cb104-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">hjust =</span> <span class="fl">1.1</span>,</span>
<span id="cb104-16"><a href="#cb104-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">8</span>,</span>
<span id="cb104-17"><a href="#cb104-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">3</span>)</span>
<span id="cb104-18"><a href="#cb104-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb104-19"><a href="#cb104-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>List of 136
 $ line                            :List of 6
  ..$ colour       : chr "black"
  ..$ linewidth    : num 0.5
  ..$ linetype     : num 1
  ..$ lineend      : chr "butt"
  ..$ arrow        : logi FALSE
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_line" "element"
 $ rect                            :List of 5
  ..$ fill         : chr "white"
  ..$ colour       : chr "black"
  ..$ linewidth    : num 0.5
  ..$ linetype     : num 1
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_rect" "element"
 $ text                            :List of 11
  ..$ family       : chr ""
  ..$ face         : chr "plain"
  ..$ colour       : chr "black"
  ..$ size         : num 11
  ..$ hjust        : num 0.5
  ..$ vjust        : num 0.5
  ..$ angle        : num 0
  ..$ lineheight   : num 0.9
  ..$ margin       : 'margin' num [1:4] 0points 0points 0points 0points
  .. ..- attr(*, "unit")= int 8
  ..$ debug        : logi FALSE
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_text" "element"
 $ title                           : NULL
 $ aspect.ratio                    : NULL
 $ axis.title                      : NULL
 $ axis.title.x                    :List of 11
  ..$ family       : NULL
  ..$ face         : NULL
  ..$ colour       : NULL
  ..$ size         : NULL
  ..$ hjust        : NULL
  ..$ vjust        : num 1
  ..$ angle        : NULL
  ..$ lineheight   : NULL
  ..$ margin       : 'margin' num [1:4] 2.75points 0points 0points 0points
  .. ..- attr(*, "unit")= int 8
  ..$ debug        : NULL
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_text" "element"
 $ axis.title.x.top                :List of 11
  ..$ family       : NULL
  ..$ face         : NULL
  ..$ colour       : NULL
  ..$ size         : NULL
  ..$ hjust        : NULL
  ..$ vjust        : num 0
  ..$ angle        : NULL
  ..$ lineheight   : NULL
  ..$ margin       : 'margin' num [1:4] 0points 0points 2.75points 0points
  .. ..- attr(*, "unit")= int 8
  ..$ debug        : NULL
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_text" "element"
 $ axis.title.x.bottom             : NULL
 $ axis.title.y                    :List of 11
  ..$ family       : NULL
  ..$ face         : NULL
  ..$ colour       : NULL
  ..$ size         : NULL
  ..$ hjust        : NULL
  ..$ vjust        : num 1
  ..$ angle        : num 90
  ..$ lineheight   : NULL
  ..$ margin       : 'margin' num [1:4] 0points 2.75points 0points 0points
  .. ..- attr(*, "unit")= int 8
  ..$ debug        : NULL
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_text" "element"
 $ axis.title.y.left               : NULL
 $ axis.title.y.right              :List of 11
  ..$ family       : NULL
  ..$ face         : NULL
  ..$ colour       : NULL
  ..$ size         : NULL
  ..$ hjust        : NULL
  ..$ vjust        : num 1
  ..$ angle        : num -90
  ..$ lineheight   : NULL
  ..$ margin       : 'margin' num [1:4] 0points 0points 0points 2.75points
  .. ..- attr(*, "unit")= int 8
  ..$ debug        : NULL
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_text" "element"
 $ axis.text                       :List of 11
  ..$ family       : NULL
  ..$ face         : NULL
  ..$ colour       : chr "grey30"
  ..$ size         : 'rel' num 0.8
  ..$ hjust        : NULL
  ..$ vjust        : NULL
  ..$ angle        : NULL
  ..$ lineheight   : NULL
  ..$ margin       : NULL
  ..$ debug        : NULL
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_text" "element"
 $ axis.text.x                     :List of 11
  ..$ family       : NULL
  ..$ face         : NULL
  ..$ colour       : NULL
  ..$ size         : NULL
  ..$ hjust        : NULL
  ..$ vjust        : num 1
  ..$ angle        : NULL
  ..$ lineheight   : NULL
  ..$ margin       : 'margin' num [1:4] 2.2points 0points 0points 0points
  .. ..- attr(*, "unit")= int 8
  ..$ debug        : NULL
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_text" "element"
 $ axis.text.x.top                 :List of 11
  ..$ family       : NULL
  ..$ face         : NULL
  ..$ colour       : NULL
  ..$ size         : NULL
  ..$ hjust        : NULL
  ..$ vjust        : num 0
  ..$ angle        : NULL
  ..$ lineheight   : NULL
  ..$ margin       : 'margin' num [1:4] 0points 0points 2.2points 0points
  .. ..- attr(*, "unit")= int 8
  ..$ debug        : NULL
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_text" "element"
 $ axis.text.x.bottom              : NULL
 $ axis.text.y                     :List of 11
  ..$ family       : NULL
  ..$ face         : NULL
  ..$ colour       : NULL
  ..$ size         : NULL
  ..$ hjust        : num 1
  ..$ vjust        : NULL
  ..$ angle        : NULL
  ..$ lineheight   : NULL
  ..$ margin       : 'margin' num [1:4] 0points 2.2points 0points 0points
  .. ..- attr(*, "unit")= int 8
  ..$ debug        : NULL
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_text" "element"
 $ axis.text.y.left                : NULL
 $ axis.text.y.right               :List of 11
  ..$ family       : NULL
  ..$ face         : NULL
  ..$ colour       : NULL
  ..$ size         : NULL
  ..$ hjust        : num 0
  ..$ vjust        : NULL
  ..$ angle        : NULL
  ..$ lineheight   : NULL
  ..$ margin       : 'margin' num [1:4] 0points 0points 0points 2.2points
  .. ..- attr(*, "unit")= int 8
  ..$ debug        : NULL
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_text" "element"
 $ axis.text.theta                 : NULL
 $ axis.text.r                     :List of 11
  ..$ family       : NULL
  ..$ face         : NULL
  ..$ colour       : NULL
  ..$ size         : NULL
  ..$ hjust        : num 0.5
  ..$ vjust        : NULL
  ..$ angle        : NULL
  ..$ lineheight   : NULL
  ..$ margin       : 'margin' num [1:4] 0points 2.2points 0points 2.2points
  .. ..- attr(*, "unit")= int 8
  ..$ debug        : NULL
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_text" "element"
 $ axis.ticks                      : list()
  ..- attr(*, "class")= chr [1:2] "element_blank" "element"
 $ axis.ticks.x                    : NULL
 $ axis.ticks.x.top                : NULL
 $ axis.ticks.x.bottom             : NULL
 $ axis.ticks.y                    : NULL
 $ axis.ticks.y.left               : NULL
 $ axis.ticks.y.right              : NULL
 $ axis.ticks.theta                : NULL
 $ axis.ticks.r                    : NULL
 $ axis.minor.ticks.x.top          : NULL
 $ axis.minor.ticks.x.bottom       : NULL
 $ axis.minor.ticks.y.left         : NULL
 $ axis.minor.ticks.y.right        : NULL
 $ axis.minor.ticks.theta          : NULL
 $ axis.minor.ticks.r              : NULL
 $ axis.ticks.length               : 'simpleUnit' num 2.75points
  ..- attr(*, "unit")= int 8
 $ axis.ticks.length.x             : NULL
 $ axis.ticks.length.x.top         : NULL
 $ axis.ticks.length.x.bottom      : NULL
 $ axis.ticks.length.y             : NULL
 $ axis.ticks.length.y.left        : NULL
 $ axis.ticks.length.y.right       : NULL
 $ axis.ticks.length.theta         : NULL
 $ axis.ticks.length.r             : NULL
 $ axis.minor.ticks.length         : 'rel' num 0.75
 $ axis.minor.ticks.length.x       : NULL
 $ axis.minor.ticks.length.x.top   : NULL
 $ axis.minor.ticks.length.x.bottom: NULL
 $ axis.minor.ticks.length.y       : NULL
 $ axis.minor.ticks.length.y.left  : NULL
 $ axis.minor.ticks.length.y.right : NULL
 $ axis.minor.ticks.length.theta   : NULL
 $ axis.minor.ticks.length.r       : NULL
 $ axis.line                       : list()
  ..- attr(*, "class")= chr [1:2] "element_blank" "element"
 $ axis.line.x                     : NULL
 $ axis.line.x.top                 : NULL
 $ axis.line.x.bottom              : NULL
 $ axis.line.y                     : NULL
 $ axis.line.y.left                : NULL
 $ axis.line.y.right               : NULL
 $ axis.line.theta                 : NULL
 $ axis.line.r                     : NULL
 $ legend.background               : list()
  ..- attr(*, "class")= chr [1:2] "element_blank" "element"
 $ legend.margin                   : 'margin' num [1:4] 5.5points 5.5points 5.5points 5.5points
  ..- attr(*, "unit")= int 8
 $ legend.spacing                  : 'simpleUnit' num 11points
  ..- attr(*, "unit")= int 8
 $ legend.spacing.x                : NULL
 $ legend.spacing.y                : NULL
 $ legend.key                      : list()
  ..- attr(*, "class")= chr [1:2] "element_blank" "element"
 $ legend.key.size                 : 'simpleUnit' num 1.2lines
  ..- attr(*, "unit")= int 3
 $ legend.key.height               : NULL
 $ legend.key.width                : NULL
 $ legend.key.spacing              : 'simpleUnit' num 5.5points
  ..- attr(*, "unit")= int 8
 $ legend.key.spacing.x            : NULL
 $ legend.key.spacing.y            : NULL
 $ legend.frame                    : NULL
 $ legend.ticks                    : NULL
 $ legend.ticks.length             : 'rel' num 0.2
 $ legend.axis.line                : NULL
 $ legend.text                     :List of 11
  ..$ family       : NULL
  ..$ face         : NULL
  ..$ colour       : NULL
  ..$ size         : 'rel' num 0.8
  ..$ hjust        : NULL
  ..$ vjust        : NULL
  ..$ angle        : NULL
  ..$ lineheight   : NULL
  ..$ margin       : NULL
  ..$ debug        : NULL
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_text" "element"
 $ legend.text.position            : NULL
 $ legend.title                    :List of 11
  ..$ family       : NULL
  ..$ face         : NULL
  ..$ colour       : NULL
  ..$ size         : NULL
  ..$ hjust        : num 0
  ..$ vjust        : NULL
  ..$ angle        : NULL
  ..$ lineheight   : NULL
  ..$ margin       : NULL
  ..$ debug        : NULL
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_text" "element"
 $ legend.title.position           : NULL
 $ legend.position                 : chr "none"
 $ legend.position.inside          : NULL
 $ legend.direction                : NULL
 $ legend.byrow                    : NULL
 $ legend.justification            : chr "center"
 $ legend.justification.top        : NULL
 $ legend.justification.bottom     : NULL
 $ legend.justification.left       : NULL
 $ legend.justification.right      : NULL
 $ legend.justification.inside     : NULL
 $ legend.location                 : NULL
 $ legend.box                      : NULL
 $ legend.box.just                 : NULL
 $ legend.box.margin               : 'margin' num [1:4] 0cm 0cm 0cm 0cm
  ..- attr(*, "unit")= int 1
 $ legend.box.background           : list()
  ..- attr(*, "class")= chr [1:2] "element_blank" "element"
 $ legend.box.spacing              : 'simpleUnit' num 11points
  ..- attr(*, "unit")= int 8
  [list output truncated]
 - attr(*, "class")= chr [1:2] "theme" "gg"
 - attr(*, "complete")= logi TRUE
 - attr(*, "validate")= logi TRUE</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>b</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-87-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>vessel_movement_long <span class="ot">&lt;-</span> vessel_movement <span class="sc">%&gt;%</span> </span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(loc_type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Fishing Ground"</span>, <span class="st">"Ecological Preserve"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"FishingVessel"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">month =</span> <span class="fu">month</span>(time)) <span class="sc">%&gt;%</span> </span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(loc, vessel, month) <span class="sc">%&gt;%</span> </span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(loc, month) <span class="sc">%&gt;%</span> </span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n =</span> <span class="fu">n</span>()) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> vessel_movement_long <span class="sc">%&gt;%</span> </span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">month =</span> <span class="fu">as.factor</span>(month)) <span class="sc">%&gt;%</span> </span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">newggslopegraph</span>(month,n, loc,</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">Title =</span> <span class="st">"Changes in Visit Frequency of Fishing Vessels"</span>,</span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">SubTitle =</span> <span class="st">"Fishing Grounds and Ecological Preserves"</span>,</span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">Caption =</span> <span class="st">"Feb-Nov.Before and After SSEC caught in May"</span>) </span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> c <span class="sc">+</span> </span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">4</span>, </span>
<span id="cb108-10"><a href="#cb108-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">linetype =</span> <span class="dv">2</span>, </span>
<span id="cb108-11"><a href="#cb108-11" aria-hidden="true" tabindex="-1"></a>                    <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb108-12"><a href="#cb108-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">4</span>, <span class="at">y =</span> <span class="dv">150</span>, <span class="at">label =</span> <span class="st">"SouthSeafood caught"</span>),</span>
<span id="cb108-13"><a href="#cb108-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"red"</span>,</span>
<span id="cb108-14"><a href="#cb108-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">hjust =</span> <span class="fl">1.1</span>,</span>
<span id="cb108-15"><a href="#cb108-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">8</span>,</span>
<span id="cb108-16"><a href="#cb108-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">3</span>)</span>
<span id="cb108-17"><a href="#cb108-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb108-18"><a href="#cb108-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>List of 136
 $ line                            :List of 6
  ..$ colour       : chr "black"
  ..$ linewidth    : num 0.5
  ..$ linetype     : num 1
  ..$ lineend      : chr "butt"
  ..$ arrow        : logi FALSE
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_line" "element"
 $ rect                            :List of 5
  ..$ fill         : chr "white"
  ..$ colour       : chr "black"
  ..$ linewidth    : num 0.5
  ..$ linetype     : num 1
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_rect" "element"
 $ text                            :List of 11
  ..$ family       : chr ""
  ..$ face         : chr "plain"
  ..$ colour       : chr "black"
  ..$ size         : num 11
  ..$ hjust        : num 0.5
  ..$ vjust        : num 0.5
  ..$ angle        : num 0
  ..$ lineheight   : num 0.9
  ..$ margin       : 'margin' num [1:4] 0points 0points 0points 0points
  .. ..- attr(*, "unit")= int 8
  ..$ debug        : logi FALSE
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_text" "element"
 $ title                           : NULL
 $ aspect.ratio                    : NULL
 $ axis.title                      : NULL
 $ axis.title.x                    :List of 11
  ..$ family       : NULL
  ..$ face         : NULL
  ..$ colour       : NULL
  ..$ size         : NULL
  ..$ hjust        : NULL
  ..$ vjust        : num 1
  ..$ angle        : NULL
  ..$ lineheight   : NULL
  ..$ margin       : 'margin' num [1:4] 2.75points 0points 0points 0points
  .. ..- attr(*, "unit")= int 8
  ..$ debug        : NULL
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_text" "element"
 $ axis.title.x.top                :List of 11
  ..$ family       : NULL
  ..$ face         : NULL
  ..$ colour       : NULL
  ..$ size         : NULL
  ..$ hjust        : NULL
  ..$ vjust        : num 0
  ..$ angle        : NULL
  ..$ lineheight   : NULL
  ..$ margin       : 'margin' num [1:4] 0points 0points 2.75points 0points
  .. ..- attr(*, "unit")= int 8
  ..$ debug        : NULL
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_text" "element"
 $ axis.title.x.bottom             : NULL
 $ axis.title.y                    :List of 11
  ..$ family       : NULL
  ..$ face         : NULL
  ..$ colour       : NULL
  ..$ size         : NULL
  ..$ hjust        : NULL
  ..$ vjust        : num 1
  ..$ angle        : num 90
  ..$ lineheight   : NULL
  ..$ margin       : 'margin' num [1:4] 0points 2.75points 0points 0points
  .. ..- attr(*, "unit")= int 8
  ..$ debug        : NULL
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_text" "element"
 $ axis.title.y.left               : NULL
 $ axis.title.y.right              :List of 11
  ..$ family       : NULL
  ..$ face         : NULL
  ..$ colour       : NULL
  ..$ size         : NULL
  ..$ hjust        : NULL
  ..$ vjust        : num 1
  ..$ angle        : num -90
  ..$ lineheight   : NULL
  ..$ margin       : 'margin' num [1:4] 0points 0points 0points 2.75points
  .. ..- attr(*, "unit")= int 8
  ..$ debug        : NULL
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_text" "element"
 $ axis.text                       :List of 11
  ..$ family       : NULL
  ..$ face         : NULL
  ..$ colour       : chr "grey30"
  ..$ size         : 'rel' num 0.8
  ..$ hjust        : NULL
  ..$ vjust        : NULL
  ..$ angle        : NULL
  ..$ lineheight   : NULL
  ..$ margin       : NULL
  ..$ debug        : NULL
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_text" "element"
 $ axis.text.x                     :List of 11
  ..$ family       : NULL
  ..$ face         : NULL
  ..$ colour       : NULL
  ..$ size         : NULL
  ..$ hjust        : NULL
  ..$ vjust        : num 1
  ..$ angle        : NULL
  ..$ lineheight   : NULL
  ..$ margin       : 'margin' num [1:4] 2.2points 0points 0points 0points
  .. ..- attr(*, "unit")= int 8
  ..$ debug        : NULL
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_text" "element"
 $ axis.text.x.top                 :List of 11
  ..$ family       : NULL
  ..$ face         : NULL
  ..$ colour       : NULL
  ..$ size         : NULL
  ..$ hjust        : NULL
  ..$ vjust        : num 0
  ..$ angle        : NULL
  ..$ lineheight   : NULL
  ..$ margin       : 'margin' num [1:4] 0points 0points 2.2points 0points
  .. ..- attr(*, "unit")= int 8
  ..$ debug        : NULL
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_text" "element"
 $ axis.text.x.bottom              : NULL
 $ axis.text.y                     :List of 11
  ..$ family       : NULL
  ..$ face         : NULL
  ..$ colour       : NULL
  ..$ size         : NULL
  ..$ hjust        : num 1
  ..$ vjust        : NULL
  ..$ angle        : NULL
  ..$ lineheight   : NULL
  ..$ margin       : 'margin' num [1:4] 0points 2.2points 0points 0points
  .. ..- attr(*, "unit")= int 8
  ..$ debug        : NULL
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_text" "element"
 $ axis.text.y.left                : NULL
 $ axis.text.y.right               :List of 11
  ..$ family       : NULL
  ..$ face         : NULL
  ..$ colour       : NULL
  ..$ size         : NULL
  ..$ hjust        : num 0
  ..$ vjust        : NULL
  ..$ angle        : NULL
  ..$ lineheight   : NULL
  ..$ margin       : 'margin' num [1:4] 0points 0points 0points 2.2points
  .. ..- attr(*, "unit")= int 8
  ..$ debug        : NULL
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_text" "element"
 $ axis.text.theta                 : NULL
 $ axis.text.r                     :List of 11
  ..$ family       : NULL
  ..$ face         : NULL
  ..$ colour       : NULL
  ..$ size         : NULL
  ..$ hjust        : num 0.5
  ..$ vjust        : NULL
  ..$ angle        : NULL
  ..$ lineheight   : NULL
  ..$ margin       : 'margin' num [1:4] 0points 2.2points 0points 2.2points
  .. ..- attr(*, "unit")= int 8
  ..$ debug        : NULL
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_text" "element"
 $ axis.ticks                      : list()
  ..- attr(*, "class")= chr [1:2] "element_blank" "element"
 $ axis.ticks.x                    : NULL
 $ axis.ticks.x.top                : NULL
 $ axis.ticks.x.bottom             : NULL
 $ axis.ticks.y                    : NULL
 $ axis.ticks.y.left               : NULL
 $ axis.ticks.y.right              : NULL
 $ axis.ticks.theta                : NULL
 $ axis.ticks.r                    : NULL
 $ axis.minor.ticks.x.top          : NULL
 $ axis.minor.ticks.x.bottom       : NULL
 $ axis.minor.ticks.y.left         : NULL
 $ axis.minor.ticks.y.right        : NULL
 $ axis.minor.ticks.theta          : NULL
 $ axis.minor.ticks.r              : NULL
 $ axis.ticks.length               : 'simpleUnit' num 2.75points
  ..- attr(*, "unit")= int 8
 $ axis.ticks.length.x             : NULL
 $ axis.ticks.length.x.top         : NULL
 $ axis.ticks.length.x.bottom      : NULL
 $ axis.ticks.length.y             : NULL
 $ axis.ticks.length.y.left        : NULL
 $ axis.ticks.length.y.right       : NULL
 $ axis.ticks.length.theta         : NULL
 $ axis.ticks.length.r             : NULL
 $ axis.minor.ticks.length         : 'rel' num 0.75
 $ axis.minor.ticks.length.x       : NULL
 $ axis.minor.ticks.length.x.top   : NULL
 $ axis.minor.ticks.length.x.bottom: NULL
 $ axis.minor.ticks.length.y       : NULL
 $ axis.minor.ticks.length.y.left  : NULL
 $ axis.minor.ticks.length.y.right : NULL
 $ axis.minor.ticks.length.theta   : NULL
 $ axis.minor.ticks.length.r       : NULL
 $ axis.line                       : list()
  ..- attr(*, "class")= chr [1:2] "element_blank" "element"
 $ axis.line.x                     : NULL
 $ axis.line.x.top                 : NULL
 $ axis.line.x.bottom              : NULL
 $ axis.line.y                     : NULL
 $ axis.line.y.left                : NULL
 $ axis.line.y.right               : NULL
 $ axis.line.theta                 : NULL
 $ axis.line.r                     : NULL
 $ legend.background               : list()
  ..- attr(*, "class")= chr [1:2] "element_blank" "element"
 $ legend.margin                   : 'margin' num [1:4] 5.5points 5.5points 5.5points 5.5points
  ..- attr(*, "unit")= int 8
 $ legend.spacing                  : 'simpleUnit' num 11points
  ..- attr(*, "unit")= int 8
 $ legend.spacing.x                : NULL
 $ legend.spacing.y                : NULL
 $ legend.key                      : list()
  ..- attr(*, "class")= chr [1:2] "element_blank" "element"
 $ legend.key.size                 : 'simpleUnit' num 1.2lines
  ..- attr(*, "unit")= int 3
 $ legend.key.height               : NULL
 $ legend.key.width                : NULL
 $ legend.key.spacing              : 'simpleUnit' num 5.5points
  ..- attr(*, "unit")= int 8
 $ legend.key.spacing.x            : NULL
 $ legend.key.spacing.y            : NULL
 $ legend.frame                    : NULL
 $ legend.ticks                    : NULL
 $ legend.ticks.length             : 'rel' num 0.2
 $ legend.axis.line                : NULL
 $ legend.text                     :List of 11
  ..$ family       : NULL
  ..$ face         : NULL
  ..$ colour       : NULL
  ..$ size         : 'rel' num 0.8
  ..$ hjust        : NULL
  ..$ vjust        : NULL
  ..$ angle        : NULL
  ..$ lineheight   : NULL
  ..$ margin       : NULL
  ..$ debug        : NULL
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_text" "element"
 $ legend.text.position            : NULL
 $ legend.title                    :List of 11
  ..$ family       : NULL
  ..$ face         : NULL
  ..$ colour       : NULL
  ..$ size         : NULL
  ..$ hjust        : num 0
  ..$ vjust        : NULL
  ..$ angle        : NULL
  ..$ lineheight   : NULL
  ..$ margin       : NULL
  ..$ debug        : NULL
  ..$ inherit.blank: logi TRUE
  ..- attr(*, "class")= chr [1:2] "element_text" "element"
 $ legend.title.position           : NULL
 $ legend.position                 : chr "none"
 $ legend.position.inside          : NULL
 $ legend.direction                : NULL
 $ legend.byrow                    : NULL
 $ legend.justification            : chr "center"
 $ legend.justification.top        : NULL
 $ legend.justification.bottom     : NULL
 $ legend.justification.left       : NULL
 $ legend.justification.right      : NULL
 $ legend.justification.inside     : NULL
 $ legend.location                 : NULL
 $ legend.box                      : NULL
 $ legend.box.just                 : NULL
 $ legend.box.margin               : 'margin' num [1:4] 0cm 0cm 0cm 0cm
  ..- attr(*, "unit")= int 1
 $ legend.box.background           : list()
  ..- attr(*, "class")= chr [1:2] "element_blank" "element"
 $ legend.box.spacing              : 'simpleUnit' num 11points
  ..- attr(*, "unit")= int 8
  [list output truncated]
 - attr(*, "class")= chr [1:2] "theme" "gg"
 - attr(*, "complete")= logi TRUE
 - attr(*, "validate")= logi TRUE</code></pre>
</div>
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>c</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-89-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<pre><code></code></pre>
<p>In the line graph below, we observe that the overall fishing vessels activities in the fishing ground and preserves dropped.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>average <span class="ot">&lt;-</span> vessel_movement <span class="sc">%&gt;%</span> </span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"FishingVessel"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(loc <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Ghoti Preserve"</span>, </span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"Nemo Reef"</span>, </span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"Don Limpet Preserve"</span>,</span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"Cod Table"</span>, </span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"Wrasse Beds"</span>,</span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"Tuna Shelf"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb112-9"><a href="#cb112-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">month =</span> <span class="fu">month</span>(time)) <span class="sc">%&gt;%</span> </span>
<span id="cb112-10"><a href="#cb112-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">average =</span> (<span class="fu">n</span>()<span class="sc">/</span><span class="dv">10</span>))</span>
<span id="cb112-11"><a href="#cb112-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-12"><a href="#cb112-12" aria-hidden="true" tabindex="-1"></a>vessel_movement <span class="sc">%&gt;%</span> </span>
<span id="cb112-13"><a href="#cb112-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(loc <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Ghoti Preserve"</span>, </span>
<span id="cb112-14"><a href="#cb112-14" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"Nemo Reef"</span>, </span>
<span id="cb112-15"><a href="#cb112-15" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"Don Limpet Preserve"</span>,</span>
<span id="cb112-16"><a href="#cb112-16" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"Cod Table"</span>, </span>
<span id="cb112-17"><a href="#cb112-17" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"Wrasse Beds"</span>,</span>
<span id="cb112-18"><a href="#cb112-18" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"Tuna Shelf"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb112-19"><a href="#cb112-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"FishingVessel"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb112-20"><a href="#cb112-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">month =</span> <span class="fu">month</span>(time)) <span class="sc">%&gt;%</span> </span>
<span id="cb112-21"><a href="#cb112-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(month) <span class="sc">%&gt;%</span> </span>
<span id="cb112-22"><a href="#cb112-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">as.numeric</span>(<span class="fu">n</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb112-23"><a href="#cb112-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> month, <span class="at">y =</span> n)) <span class="sc">+</span> </span>
<span id="cb112-24"><a href="#cb112-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span>  </span>
<span id="cb112-25"><a href="#cb112-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">"blue"</span>) <span class="sc">+</span></span>
<span id="cb112-26"><a href="#cb112-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> n), </span>
<span id="cb112-27"><a href="#cb112-27" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>,</span>
<span id="cb112-28"><a href="#cb112-28" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb112-29"><a href="#cb112-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Visit Frequency to All Fishing Grounds and Preserves by Month"</span>,</span>
<span id="cb112-30"><a href="#cb112-30" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Month"</span>,</span>
<span id="cb112-31"><a href="#cb112-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb112-32"><a href="#cb112-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(average, </span>
<span id="cb112-33"><a href="#cb112-33" aria-hidden="true" tabindex="-1"></a>             <span class="at">yintercept =</span> <span class="fu">as.numeric</span>(average), </span>
<span id="cb112-34"><a href="#cb112-34" aria-hidden="true" tabindex="-1"></a>             <span class="at">color=</span><span class="st">"black"</span>,</span>
<span id="cb112-35"><a href="#cb112-35" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb112-36"><a href="#cb112-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">x =</span> <span class="dv">5</span>, <span class="at">y =</span> <span class="dv">13366</span>,</span>
<span id="cb112-37"><a href="#cb112-37" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb112-38"><a href="#cb112-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">5</span>, <span class="at">y =</span> <span class="dv">13366</span>, <span class="at">label =</span> <span class="st">"SouthSeafood caught"</span>),</span>
<span id="cb112-39"><a href="#cb112-39" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"red"</span>,</span>
<span id="cb112-40"><a href="#cb112-40" aria-hidden="true" tabindex="-1"></a>            <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.2</span>,</span>
<span id="cb112-41"><a href="#cb112-41" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb112-42"><a href="#cb112-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">4.5</span>, <span class="at">y =</span> <span class="dv">12000</span>, <span class="at">label =</span> <span class="st">"Monthly Average = 11854"</span>),</span>
<span id="cb112-43"><a href="#cb112-43" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb112-44"><a href="#cb112-44" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb112-45"><a href="#cb112-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-90-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Derive monthly transponder ping:</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>monthly_vessel_movement <span class="ot">&lt;-</span> vessel_movement <span class="sc">%&gt;%</span> </span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"FishingVessel"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">month =</span> <span class="fu">month</span>(time)) <span class="sc">%&gt;%</span> </span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(loc, vessel, month) <span class="sc">%&gt;%</span> </span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(loc, month) <span class="sc">%&gt;%</span> </span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n =</span> <span class="fu">n</span>()) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>monthly_vessel_movement<span class="sc">$</span>month <span class="ot">&lt;-</span> <span class="fu">factor</span>(monthly_vessel_movement<span class="sc">$</span>month)</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>monthly_vessel_movement<span class="sc">$</span>loc <span class="ot">&lt;-</span> <span class="fu">factor</span>(monthly_vessel_movement<span class="sc">$</span>loc,</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>                                             <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"City of Himark"</span>,</span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"City of Lomark"</span>,</span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"City of Haacklee"</span>,</span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"City of Paackland"</span>,</span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"City of South Paackland"</span>,</span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"City of Port Grove"</span>,</span>
<span id="cb114-9"><a href="#cb114-9" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"Ghoti Preserve"</span>, </span>
<span id="cb114-10"><a href="#cb114-10" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"Nemo Reef"</span>, </span>
<span id="cb114-11"><a href="#cb114-11" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"Don Limpet Preserve"</span>,</span>
<span id="cb114-12"><a href="#cb114-12" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"Cod Table"</span>, </span>
<span id="cb114-13"><a href="#cb114-13" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"Wrasse Beds"</span>,</span>
<span id="cb114-14"><a href="#cb114-14" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"Tuna Shelf"</span>,</span>
<span id="cb114-15"><a href="#cb114-15" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"Exit North"</span>,</span>
<span id="cb114-16"><a href="#cb114-16" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"Exit South"</span>,</span>
<span id="cb114-17"><a href="#cb114-17" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"Exit East"</span>,</span>
<span id="cb114-18"><a href="#cb114-18" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"Exit West"</span>,</span>
<span id="cb114-19"><a href="#cb114-19" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"Nav 1"</span>,<span class="st">"Nav 2"</span>, <span class="st">"Nav 3"</span>, </span>
<span id="cb114-20"><a href="#cb114-20" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"Nav A"</span>, <span class="st">"Nav B"</span>, <span class="st">"Nav C"</span>, <span class="st">"Nav D"</span>, <span class="st">"Nav E"</span>))</span>
<span id="cb114-21"><a href="#cb114-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-22"><a href="#cb114-22" aria-hidden="true" tabindex="-1"></a>hline.data <span class="ot">&lt;-</span> monthly_vessel_movement <span class="sc">%&gt;%</span> </span>
<span id="cb114-23"><a href="#cb114-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(loc) <span class="sc">%&gt;%</span></span>
<span id="cb114-24"><a href="#cb114-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">avgvalue =</span> <span class="fu">mean</span>(n))</span>
<span id="cb114-25"><a href="#cb114-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-26"><a href="#cb114-26" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(monthly_vessel_movement, </span>
<span id="cb114-27"><a href="#cb114-27" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> month, </span>
<span id="cb114-28"><a href="#cb114-28" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> n, </span>
<span id="cb114-29"><a href="#cb114-29" aria-hidden="true" tabindex="-1"></a>           <span class="at">group =</span> loc, </span>
<span id="cb114-30"><a href="#cb114-30" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> loc)) <span class="sc">+</span></span>
<span id="cb114-31"><a href="#cb114-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb114-32"><a href="#cb114-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb114-33"><a href="#cb114-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> loc, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span>  </span>
<span id="cb114-34"><a href="#cb114-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb114-35"><a href="#cb114-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Changes in Visit Frequency by Month by Fishing Vessels"</span>,</span>
<span id="cb114-36"><a href="#cb114-36" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Month"</span>,</span>
<span id="cb114-37"><a href="#cb114-37" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"No. of Visits"</span>,</span>
<span id="cb114-38"><a href="#cb114-38" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Source"</span>) <span class="sc">+</span></span>
<span id="cb114-39"><a href="#cb114-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">data =</span> hline.data,</span>
<span id="cb114-40"><a href="#cb114-40" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">yintercept =</span> avgvalue),</span>
<span id="cb114-41"><a href="#cb114-41" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="dv">6</span>,</span>
<span id="cb114-42"><a href="#cb114-42" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb114-43"><a href="#cb114-43" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb114-44"><a href="#cb114-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> hline.data, </span>
<span id="cb114-45"><a href="#cb114-45" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">"4"</span>, <span class="at">y =</span> avgvalue, <span class="at">label =</span> <span class="st">"Average"</span>), </span>
<span id="cb114-46"><a href="#cb114-46" aria-hidden="true" tabindex="-1"></a>            <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>, </span>
<span id="cb114-47"><a href="#cb114-47" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb114-48"><a href="#cb114-48" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb114-49"><a href="#cb114-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> <span class="dv">4</span>),</span>
<span id="cb114-50"><a href="#cb114-50" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="dv">6</span>,</span>
<span id="cb114-51"><a href="#cb114-51" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"red"</span>,</span>
<span id="cb114-52"><a href="#cb114-52" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb114-53"><a href="#cb114-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> hline.data, </span>
<span id="cb114-54"><a href="#cb114-54" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">"4"</span>, </span>
<span id="cb114-55"><a href="#cb114-55" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> avgvalue, </span>
<span id="cb114-56"><a href="#cb114-56" aria-hidden="true" tabindex="-1"></a>                <span class="at">label =</span> <span class="st">"SouthSeafood caught"</span>), </span>
<span id="cb114-57"><a href="#cb114-57" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="fl">1.5</span>,</span>
<span id="cb114-58"><a href="#cb114-58" aria-hidden="true" tabindex="-1"></a>            <span class="at">angle =</span> <span class="dv">90</span>,</span>
<span id="cb114-59"><a href="#cb114-59" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"red"</span>,</span>
<span id="cb114-60"><a href="#cb114-60" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb114-61"><a href="#cb114-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-92-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<section id="what-new-behaviors-in-the-oceanus-commercial-fishing-community-are-most-suspicious-and-why" class="level3">
<h3 class="anchored" data-anchor-id="what-new-behaviors-in-the-oceanus-commercial-fishing-community-are-most-suspicious-and-why">4.2 What new behaviors in the Oceanus commercial fishing community are most suspicious and why?</h3>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>monthly_vessel_movement<span class="sc">$</span>month <span class="ot">&lt;-</span> <span class="fu">factor</span>(monthly_vessel_movement<span class="sc">$</span>month)</span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>monthly_vessel_movement<span class="sc">$</span>loc <span class="ot">&lt;-</span> <span class="fu">factor</span>(monthly_vessel_movement<span class="sc">$</span>loc,</span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>                                             <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"City of Himark"</span>,</span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"City of Lomark"</span>,</span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"City of Haacklee"</span>,</span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"City of Paackland"</span>,</span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"City of South Paackland"</span>,</span>
<span id="cb115-8"><a href="#cb115-8" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"City of Port Grove"</span>,</span>
<span id="cb115-9"><a href="#cb115-9" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"Ghoti Preserve"</span>, </span>
<span id="cb115-10"><a href="#cb115-10" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"Nemo Reef"</span>, </span>
<span id="cb115-11"><a href="#cb115-11" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"Don Limpet Preserve"</span>,</span>
<span id="cb115-12"><a href="#cb115-12" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"Cod Table"</span>, </span>
<span id="cb115-13"><a href="#cb115-13" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"Wrasse Beds"</span>,</span>
<span id="cb115-14"><a href="#cb115-14" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"Tuna Shelf"</span>,</span>
<span id="cb115-15"><a href="#cb115-15" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"Exit North"</span>,</span>
<span id="cb115-16"><a href="#cb115-16" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"Exit South"</span>,</span>
<span id="cb115-17"><a href="#cb115-17" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"Exit East"</span>,</span>
<span id="cb115-18"><a href="#cb115-18" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"Exit West"</span>,</span>
<span id="cb115-19"><a href="#cb115-19" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"Nav 1"</span>,<span class="st">"Nav 2"</span>, <span class="st">"Nav 3"</span>, </span>
<span id="cb115-20"><a href="#cb115-20" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"Nav A"</span>, <span class="st">"Nav B"</span>, <span class="st">"Nav C"</span>, <span class="st">"Nav D"</span>, <span class="st">"Nav E"</span>))</span>
<span id="cb115-21"><a href="#cb115-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-22"><a href="#cb115-22" aria-hidden="true" tabindex="-1"></a>hline.data <span class="ot">&lt;-</span> monthly_vessel_movement <span class="sc">%&gt;%</span> </span>
<span id="cb115-23"><a href="#cb115-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(loc) <span class="sc">%&gt;%</span></span>
<span id="cb115-24"><a href="#cb115-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">avgvalue =</span> <span class="fu">mean</span>(n))</span>
<span id="cb115-25"><a href="#cb115-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-26"><a href="#cb115-26" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(monthly_vessel_movement, </span>
<span id="cb115-27"><a href="#cb115-27" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> month, </span>
<span id="cb115-28"><a href="#cb115-28" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> n, </span>
<span id="cb115-29"><a href="#cb115-29" aria-hidden="true" tabindex="-1"></a>           <span class="at">group =</span> loc, </span>
<span id="cb115-30"><a href="#cb115-30" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> loc)) <span class="sc">+</span></span>
<span id="cb115-31"><a href="#cb115-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb115-32"><a href="#cb115-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb115-33"><a href="#cb115-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> loc, <span class="at">scales =</span> <span class="st">"free_y"</span>) <span class="sc">+</span>  </span>
<span id="cb115-34"><a href="#cb115-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb115-35"><a href="#cb115-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Changes in Visit Frequency by Month by Fishing Vessels"</span>,</span>
<span id="cb115-36"><a href="#cb115-36" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Month"</span>,</span>
<span id="cb115-37"><a href="#cb115-37" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"No. of Visits"</span>,</span>
<span id="cb115-38"><a href="#cb115-38" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Source"</span>) <span class="sc">+</span></span>
<span id="cb115-39"><a href="#cb115-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">data =</span> hline.data,</span>
<span id="cb115-40"><a href="#cb115-40" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">yintercept =</span> avgvalue),</span>
<span id="cb115-41"><a href="#cb115-41" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="dv">6</span>,</span>
<span id="cb115-42"><a href="#cb115-42" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb115-43"><a href="#cb115-43" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb115-44"><a href="#cb115-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> hline.data, </span>
<span id="cb115-45"><a href="#cb115-45" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">"4"</span>, <span class="at">y =</span> avgvalue, <span class="at">label =</span> <span class="st">"Average"</span>), </span>
<span id="cb115-46"><a href="#cb115-46" aria-hidden="true" tabindex="-1"></a>            <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="dv">1</span>, </span>
<span id="cb115-47"><a href="#cb115-47" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb115-48"><a href="#cb115-48" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb115-49"><a href="#cb115-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> <span class="dv">4</span>),</span>
<span id="cb115-50"><a href="#cb115-50" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="dv">6</span>,</span>
<span id="cb115-51"><a href="#cb115-51" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"red"</span>,</span>
<span id="cb115-52"><a href="#cb115-52" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb115-53"><a href="#cb115-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> hline.data, </span>
<span id="cb115-54"><a href="#cb115-54" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">"4"</span>, </span>
<span id="cb115-55"><a href="#cb115-55" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> avgvalue, </span>
<span id="cb115-56"><a href="#cb115-56" aria-hidden="true" tabindex="-1"></a>                <span class="at">label =</span> <span class="st">"SouthSeafood caught"</span>), </span>
<span id="cb115-57"><a href="#cb115-57" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="fl">1.5</span>,</span>
<span id="cb115-58"><a href="#cb115-58" aria-hidden="true" tabindex="-1"></a>            <span class="at">angle =</span> <span class="dv">90</span>,</span>
<span id="cb115-59"><a href="#cb115-59" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"red"</span>,</span>
<span id="cb115-60"><a href="#cb115-60" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb115-61"><a href="#cb115-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-93-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Conclusion from the visualisation
</div>
</div>
<div class="callout-body-container callout-body">
<p>After SSFEC arrest:</p>
<ul>
<li><p>Abnormally high frequency of visit to Exit East. Upward trend of frequency of visit from Feb to Nov.&nbsp;Exit East offers deep sea fishing.</p></li>
<li><p>Drastic drop in frequency of visit to the City of Haacklee. Investigate into changes in fish species in the cargoes through the months going to the City of Haacklee.</p></li>
<li><p>Drop in frequency if visit in both Ghoti Preserve and Nemo Reef. However, the drop in Nemo Reef in actual value is greater. Nemo reef is a good area for violation of IUU as vessels have access to fish species in Nemo Reef that are common to the three fishing grounds, except for Helenaa species. Also, Nemo Reef sits between the two fishing grounds, maske good excuse for vessels to cut across it rather than using Nav D as safe navigation around Nemo Reef.</p></li>
</ul>
</div>
</div>
<p><strong>Changes in fish species delivered to the City of Haacklee through the month</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">create_heatmap</span>(fish_by_port_agg, <span class="st">"City of Haacklee"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-94-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>vessel_movement<span class="sc">$</span>loc <span class="ot">&lt;-</span> <span class="fu">factor</span>(vessel_movement<span class="sc">$</span>loc,</span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>                              <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"City of Himark"</span>,</span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"City of Lomark"</span>,</span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"City of Haacklee"</span>,</span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"City of Paackland"</span>,</span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"City of South Paackland"</span>,</span>
<span id="cb117-7"><a href="#cb117-7" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"City of Port Grove"</span>,</span>
<span id="cb117-8"><a href="#cb117-8" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"Ghoti Preserve"</span>, </span>
<span id="cb117-9"><a href="#cb117-9" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"Nemo Reef"</span>, </span>
<span id="cb117-10"><a href="#cb117-10" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"Don Limpet Preserve"</span>,</span>
<span id="cb117-11"><a href="#cb117-11" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"Cod Table"</span>, </span>
<span id="cb117-12"><a href="#cb117-12" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"Wrasse Beds"</span>,</span>
<span id="cb117-13"><a href="#cb117-13" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"Tuna Shelf"</span>,</span>
<span id="cb117-14"><a href="#cb117-14" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"Exit North"</span>,</span>
<span id="cb117-15"><a href="#cb117-15" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"Exit South"</span>,</span>
<span id="cb117-16"><a href="#cb117-16" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"Exit East"</span>,</span>
<span id="cb117-17"><a href="#cb117-17" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"Exit West"</span>,</span>
<span id="cb117-18"><a href="#cb117-18" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"Nav 1"</span>,<span class="st">"Nav 2"</span>, <span class="st">"Nav 3"</span>, </span>
<span id="cb117-19"><a href="#cb117-19" aria-hidden="true" tabindex="-1"></a>                                      <span class="st">"Nav A"</span>, <span class="st">"Nav B"</span>, <span class="st">"Nav C"</span>, <span class="st">"Nav D"</span>, <span class="st">"Nav E"</span>))</span>
<span id="cb117-20"><a href="#cb117-20" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(vessel_movement, <span class="fu">aes</span>(<span class="at">x =</span> loc, </span>
<span id="cb117-21"><a href="#cb117-21" aria-hidden="true" tabindex="-1"></a>                            <span class="at">y =</span> dwell,</span>
<span id="cb117-22"><a href="#cb117-22" aria-hidden="true" tabindex="-1"></a>                            <span class="at">fill =</span> loc_type)) <span class="sc">+</span></span>
<span id="cb117-23"><a href="#cb117-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb117-24"><a href="#cb117-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb117-25"><a href="#cb117-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Median Dwell Time by Location"</span>, </span>
<span id="cb117-26"><a href="#cb117-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Location"</span>, </span>
<span id="cb117-27"><a href="#cb117-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Median Dwell Time"</span>) <span class="sc">+</span></span>
<span id="cb117-28"><a href="#cb117-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb117-29"><a href="#cb117-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>( <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">500000</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-95-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>vessel_movement <span class="sc">%&gt;%</span> </span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span><span class="st">"FishingVessel"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(loc <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Exit North"</span>,</span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"Exit South"</span>,</span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"Exit East"</span>,</span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"Exit West"</span>,</span>
<span id="cb118-7"><a href="#cb118-7" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"Nav 1"</span>,<span class="st">"Nav 2"</span>, <span class="st">"Nav 3"</span>, </span>
<span id="cb118-8"><a href="#cb118-8" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"Nav A"</span>, <span class="st">"Nav B"</span>, <span class="st">"Nav C"</span>, <span class="st">"Nav D"</span>, <span class="st">"Nav E"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb118-9"><a href="#cb118-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> loc, </span>
<span id="cb118-10"><a href="#cb118-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> dwell,</span>
<span id="cb118-11"><a href="#cb118-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> loc_type)) <span class="sc">+</span>                            </span>
<span id="cb118-12"><a href="#cb118-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb118-13"><a href="#cb118-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb118-14"><a href="#cb118-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Median Dwell Time by Location"</span>, </span>
<span id="cb118-15"><a href="#cb118-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Location"</span>, </span>
<span id="cb118-16"><a href="#cb118-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Median Dwell Time"</span>) <span class="sc">+</span></span>
<span id="cb118-17"><a href="#cb118-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, </span>
<span id="cb118-18"><a href="#cb118-18" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">hjust =</span> <span class="dv">1</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-96-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>